{"version":3,"sources":["plugin.js"],"names":[],"mappings":"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","file":"plugin-compiled.js","sourcesContent":["/**\n * @license Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n /**\n * @fileOverview A set of utilities to find and create horizontal spaces in edited content.\n */\n\n'use strict';\n\n( function() {\n\n\tCKEDITOR.plugins.add( 'lineutils' );\n\n\t/**\n\t * Determines a position relative to an element in DOM (before).\n\t *\n\t * @readonly\n\t * @property {Number} [=0]\n\t * @member CKEDITOR\n\t */\n\tCKEDITOR.LINEUTILS_BEFORE = 1;\n\n\t/**\n\t * Determines a position relative to an element in DOM (after).\n\t *\n\t * @readonly\n\t * @property {Number} [=2]\n\t * @member CKEDITOR\n\t */\n\tCKEDITOR.LINEUTILS_AFTER = 2;\n\n\t/**\n\t * Determines a position relative to an element in DOM (inside).\n\t *\n\t * @readonly\n\t * @property {Number} [=4]\n\t * @member CKEDITOR\n\t */\n\tCKEDITOR.LINEUTILS_INSIDE = 4;\n\n\t/**\n\t * A utility that traverses the DOM tree and discovers elements\n\t * (relations) matching user-defined lookups.\n\t *\n\t * @private\n\t * @class CKEDITOR.plugins.lineutils.finder\n\t * @constructor Creates a Finder class instance.\n\t * @param {CKEDITOR.editor} editor Editor instance that the Finder belongs to.\n\t * @param {Object} def Finder's definition.\n\t * @since 4.3\n\t */\n\tfunction Finder( editor, def ) {\n\t\tCKEDITOR.tools.extend( this, {\n\t\t\teditor: editor,\n\t\t\teditable: editor.editable(),\n\t\t\tdoc: editor.document,\n\t\t\twin: editor.window\n\t\t}, def, true );\n\n\t\tthis.inline = this.editable.isInline();\n\n\t\tif ( !this.inline ) {\n\t\t\tthis.frame = this.win.getFrame();\n\t\t}\n\n\t\tthis.target = this[ this.inline ? 'editable' : 'doc' ];\n\t}\n\n\tFinder.prototype = {\n\t\t/**\n\t\t * Initializes searching for elements with every mousemove event fired.\n\t\t * To stop searching use {@link #stop}.\n\t\t *\n\t\t * @param {Function} [callback] Function executed on every iteration.\n\t\t */\n\t\tstart: function( callback ) {\n\t\t\tvar that = this,\n\t\t\t\teditor = this.editor,\n\t\t\t\tdoc = this.doc,\n\t\t\t\tel, elfp, x, y;\n\n\t\t\tvar moveBuffer = CKEDITOR.tools.eventsBuffer( 50, function() {\n\t\t\t\t\tif ( editor.readOnly || editor.mode != 'wysiwyg' )\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tthat.relations = {};\n\n\t\t\t\t\t// Sometimes it happens that elementFromPoint returns null (especially on IE).\n\t\t\t\t\t// Any further traversal makes no sense if there's no start point. Abort.\n\t\t\t\t\t// Note: In IE8 elementFromPoint may return zombie nodes of undefined nodeType,\n\t\t\t\t\t// so rejecting those as well.\n\t\t\t\t\tif ( !( elfp = doc.$.elementFromPoint( x, y ) ) || !elfp.nodeType ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tel = new CKEDITOR.dom.element( elfp );\n\n\t\t\t\t\tthat.traverseSearch( el );\n\n\t\t\t\t\tif ( !isNaN( x + y ) ) {\n\t\t\t\t\t\tthat.pixelSearch( el, x, y );\n\t\t\t\t\t}\n\n\t\t\t\t\tcallback && callback( that.relations, x, y );\n\t\t\t\t} );\n\n\t\t\t// Searching starting from element from point on mousemove.\n\t\t\tthis.listener = this.editable.attachListener( this.target, 'mousemove', function( evt ) {\n\t\t\t\tx = evt.data.$.clientX;\n\t\t\t\ty = evt.data.$.clientY;\n\n\t\t\t\tmoveBuffer.input();\n\t\t\t} );\n\n\t\t\tthis.editable.attachListener( this.inline ? this.editable : this.frame, 'mouseout', function() {\n\t\t\t\tmoveBuffer.reset();\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Stops observing mouse events attached by {@link #start}.\n\t\t */\n\t\tstop: function() {\n\t\t\tif ( this.listener ) {\n\t\t\t\tthis.listener.removeListener();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Returns a range representing the relation, according to its element\n\t\t * and type.\n\t\t *\n\t\t * @param {Object} location Location containing a unique identifier and type.\n\t\t * @returns {CKEDITOR.dom.range} Range representing the relation.\n\t\t */\n\t\tgetRange: ( function() {\n\t\t\tvar where = {};\n\n\t\t\twhere[ CKEDITOR.LINEUTILS_BEFORE ] = CKEDITOR.POSITION_BEFORE_START;\n\t\t\twhere[ CKEDITOR.LINEUTILS_AFTER ] = CKEDITOR.POSITION_AFTER_END;\n\t\t\twhere[ CKEDITOR.LINEUTILS_INSIDE ] = CKEDITOR.POSITION_AFTER_START;\n\n\t\t\treturn function( location ) {\n\t\t\t\tvar range = this.editor.createRange();\n\n\t\t\t\trange.moveToPosition( this.relations[ location.uid ].element, where[ location.type ] );\n\n\t\t\t\treturn range;\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Stores given relation in a {@link #relations} object. Processes the relation\n\t\t * to normalize and avoid duplicates.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} el Element of the relation.\n\t\t * @param {Number} type Relation, one of `CKEDITOR.LINEUTILS_AFTER`, `CKEDITOR.LINEUTILS_BEFORE`, `CKEDITOR.LINEUTILS_INSIDE`.\n\t\t */\n\t\tstore: ( function() {\n\t\t\tfunction merge( el, type, relations ) {\n\t\t\t\tvar uid = el.getUniqueId();\n\n\t\t\t\tif ( uid in relations ) {\n\t\t\t\t\trelations[ uid ].type |= type;\n\t\t\t\t} else {\n\t\t\t\t\trelations[ uid ] = { element: el, type: type };\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn function( el, type ) {\n\t\t\t\tvar alt;\n\n\t\t\t\t// Normalization to avoid duplicates:\n\t\t\t\t// CKEDITOR.LINEUTILS_AFTER becomes CKEDITOR.LINEUTILS_BEFORE of el.getNext().\n\t\t\t\tif ( is( type, CKEDITOR.LINEUTILS_AFTER ) && isStatic( alt = el.getNext() ) && alt.isVisible() ) {\n\t\t\t\t\tmerge( alt, CKEDITOR.LINEUTILS_BEFORE, this.relations );\n\t\t\t\t\ttype ^= CKEDITOR.LINEUTILS_AFTER;\n\t\t\t\t}\n\n\t\t\t\t// Normalization to avoid duplicates:\n\t\t\t\t// CKEDITOR.LINEUTILS_INSIDE becomes CKEDITOR.LINEUTILS_BEFORE of el.getFirst().\n\t\t\t\tif ( is( type, CKEDITOR.LINEUTILS_INSIDE ) && isStatic( alt = el.getFirst() ) && alt.isVisible() ) {\n\t\t\t\t\tmerge( alt, CKEDITOR.LINEUTILS_BEFORE, this.relations );\n\t\t\t\t\ttype ^= CKEDITOR.LINEUTILS_INSIDE;\n\t\t\t\t}\n\n\t\t\t\tmerge( el, type, this.relations );\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Traverses the DOM tree towards root, checking all ancestors\n\t\t * with lookup rules, avoiding duplicates. Stores positive relations\n\t\t * in the {@link #relations} object.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} el Element which is the starting point.\n\t\t */\n\t\ttraverseSearch: function( el ) {\n\t\t\tvar l, type, uid;\n\n\t\t\t// Go down DOM towards root (or limit).\n\t\t\tdo {\n\t\t\t\tuid = el.$[ 'data-cke-expando' ];\n\n\t\t\t\t// This element was already visited and checked.\n\t\t\t\tif ( uid && uid in this.relations ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ( el.equals( this.editable ) ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif ( isStatic( el ) ) {\n\t\t\t\t\t// Collect all addresses yielded by lookups for that element.\n\t\t\t\t\tfor ( l in this.lookups ) {\n\n\t\t\t\t\t\tif ( ( type = this.lookups[ l ]( el ) ) ) {\n\t\t\t\t\t\t\tthis.store( el, type );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} while ( !isLimit( el ) && ( el = el.getParent() ) );\n\t\t},\n\n\t\t/**\n\t\t * Iterates vertically pixel-by-pixel within a given element starting\n\t\t * from given coordinates, searching for elements in the neighborhood.\n\t\t * Once an element is found it is processed by {@link #traverseSearch}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} el Element which is the starting point.\n\t\t * @param {Number} [x] Horizontal mouse coordinate relative to the viewport.\n\t\t * @param {Number} [y] Vertical mouse coordinate relative to the viewport.\n\t\t */\n\t\tpixelSearch: ( function() {\n\t\t\tvar contains = CKEDITOR.env.ie || CKEDITOR.env.webkit ?\n\t\t\t\tfunction( el, found ) {\n\t\t\t\t\treturn el.contains( found );\n\t\t\t\t} : function( el, found ) {\n\t\t\t\t\treturn !!( el.compareDocumentPosition( found ) & 16 );\n\t\t\t\t};\n\n\t\t\t// Iterates pixel-by-pixel from starting coordinates, moving by defined\n\t\t\t// step and getting elementFromPoint in every iteration. Iteration stops when:\n\t\t\t//  * A valid element is found.\n\t\t\t//  * Condition function returns `false` (i.e. reached boundaries of viewport).\n\t\t\t//  * No element is found (i.e. coordinates out of viewport).\n\t\t\t//  * Element found is ascendant of starting element.\n\t\t\t//\n\t\t\t// @param {Object} doc Native DOM document.\n\t\t\t// @param {Object} el Native DOM element.\n\t\t\t// @param {Number} xStart Horizontal starting coordinate to use.\n\t\t\t// @param {Number} yStart Vertical starting coordinate to use.\n\t\t\t// @param {Number} step Step of the algorithm.\n\t\t\t// @param {Function} condition A condition relative to current vertical coordinate.\n\t\t\tfunction iterate( el, xStart, yStart, step, condition ) {\n\t\t\t\tvar y = yStart,\n\t\t\t\t\ttryouts = 0,\n\t\t\t\t\tfound;\n\n\t\t\t\twhile ( condition( y ) ) {\n\t\t\t\t\ty += step;\n\n\t\t\t\t\t// If we try and we try, and still nothing's found, let's end\n\t\t\t\t\t// that party.\n\t\t\t\t\tif ( ++tryouts == 25 ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tfound = this.doc.$.elementFromPoint( xStart, y );\n\n\t\t\t\t\t// Nothing found. This is crazy... but...\n\t\t\t\t\t// It might be that a line, which is in different document,\n\t\t\t\t\t// covers that pixel (elementFromPoint is doc-sensitive).\n\t\t\t\t\t// Better let's have another try.\n\t\t\t\t\tif ( !found ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Still in the same element.\n\t\t\t\t\telse if ( found == el ) {\n\t\t\t\t\t\ttryouts = 0;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reached the edge of an element and found an ancestor or...\n\t\t\t\t\t// A line, that covers that pixel. Better let's have another try.\n\t\t\t\t\telse if ( !contains( el, found ) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\ttryouts = 0;\n\n\t\t\t\t\t// Found a valid element. Stop iterating.\n\t\t\t\t\tif ( isStatic( ( found = new CKEDITOR.dom.element( found ) ) ) ) {\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn function( el, x, y ) {\n\t\t\t\tvar paneHeight = this.win.getViewPaneSize().height,\n\n\t\t\t\t\t// Try to find an element iterating *up* from the starting point.\n\t\t\t\t\tneg = iterate.call( this, el.$, x, y, -1, function( y ) {\n\t\t\t\t\t\treturn y > 0;\n\t\t\t\t\t} ),\n\n\t\t\t\t\t// Try to find an element iterating *down* from the starting point.\n\t\t\t\t\tpos = iterate.call( this, el.$, x, y, 1, function( y ) {\n\t\t\t\t\t\treturn y < paneHeight;\n\t\t\t\t\t} );\n\n\t\t\t\tif ( neg ) {\n\t\t\t\t\tthis.traverseSearch( neg );\n\n\t\t\t\t\t// Iterate towards DOM root until neg is a direct child of el.\n\t\t\t\t\twhile ( !neg.getParent().equals( el ) ) {\n\t\t\t\t\t\tneg = neg.getParent();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( pos ) {\n\t\t\t\t\tthis.traverseSearch( pos );\n\n\t\t\t\t\t// Iterate towards DOM root until pos is a direct child of el.\n\t\t\t\t\twhile ( !pos.getParent().equals( el ) ) {\n\t\t\t\t\t\tpos = pos.getParent();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Iterate forwards starting from neg and backwards from\n\t\t\t\t// pos to harvest all children of el between those elements.\n\t\t\t\t// Stop when neg and pos meet each other or there's none of them.\n\t\t\t\t// TODO (?) reduce number of hops forwards/backwards.\n\t\t\t\twhile ( neg || pos ) {\n\t\t\t\t\tif ( neg ) {\n\t\t\t\t\t\tneg = neg.getNext( isStatic );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !neg || neg.equals( pos ) ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.traverseSearch( neg );\n\n\t\t\t\t\tif ( pos ) {\n\t\t\t\t\t\tpos = pos.getPrevious( isStatic );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !pos || pos.equals( neg ) ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.traverseSearch( pos );\n\t\t\t\t}\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Unlike {@link #traverseSearch}, it collects **all** elements from editable's DOM tree\n\t\t * and runs lookups for every one of them, collecting relations.\n\t\t *\n\t\t * @returns {Object} {@link #relations}.\n\t\t */\n\t\tgreedySearch: function() {\n\t\t\tthis.relations = {};\n\n\t\t\tvar all = this.editable.getElementsByTag( '*' ),\n\t\t\t\ti = 0,\n\t\t\t\tel, type, l;\n\n\t\t\twhile ( ( el = all.getItem( i++ ) ) ) {\n\t\t\t\t// Don't consider editable, as it might be inline,\n\t\t\t\t// and i.e. checking it's siblings is pointless.\n\t\t\t\tif ( el.equals( this.editable ) ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// On IE8 element.getElementsByTagName returns comments... sic! (#13176)\n\t\t\t\tif ( el.type != CKEDITOR.NODE_ELEMENT ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Don't visit non-editable internals, for example widget's\n\t\t\t\t// guts (above wrapper, below nested). Still check editable limits,\n\t\t\t\t// as they are siblings with editable contents.\n\t\t\t\tif ( !el.hasAttribute( 'contenteditable' ) && el.isReadOnly() ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ( isStatic( el ) && el.isVisible() ) {\n\t\t\t\t\t// Collect all addresses yielded by lookups for that element.\n\t\t\t\t\tfor ( l in this.lookups ) {\n\t\t\t\t\t\tif ( ( type = this.lookups[ l ]( el ) ) ) {\n\t\t\t\t\t\t\tthis.store( el, type );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.relations;\n\t\t}\n\n\t\t/**\n\t\t * Relations express elements in DOM that match user-defined {@link #lookups}.\n\t\t * Every relation has its own `type` that determines whether\n\t\t * it refers to the space before, after or inside the `element`.\n\t\t * This object stores relations found by {@link #traverseSearch} or {@link #greedySearch}, structured\n\t\t * in the following way:\n\t\t *\n\t\t *\t\trelations: {\n\t\t *\t\t\t// Unique identifier of the element.\n\t\t *\t\t\tNumber: {\n\t\t *\t\t\t\t// Element of this relation.\n\t\t *\t\t\t\telement: {@link CKEDITOR.dom.element}\n\t\t *\t\t\t\t// Conjunction of CKEDITOR.LINEUTILS_BEFORE, CKEDITOR.LINEUTILS_AFTER and CKEDITOR.LINEUTILS_INSIDE.\n\t\t *\t\t\t\ttype: Number\n\t\t *\t\t\t},\n\t\t *\t\t\t...\n\t\t *\t\t}\n\t\t *\n\t\t * @property {Object} relations\n\t\t * @readonly\n\t\t */\n\n\t\t/**\n\t\t * A set of user-defined functions used by Finder to check if an element\n\t\t * is a valid relation, belonging to {@link #relations}.\n\t\t * When the criterion is met, lookup returns a logical conjunction of `CKEDITOR.LINEUTILS_BEFORE`,\n\t\t * `CKEDITOR.LINEUTILS_AFTER` or `CKEDITOR.LINEUTILS_INSIDE`.\n\t\t *\n\t\t * Lookups are passed along with Finder's definition.\n\t\t *\n\t\t *\t\tlookups: {\n\t\t *\t\t\t'some lookup': function( el ) {\n\t\t *\t\t\t\tif ( someCondition )\n\t\t *\t\t\t\t\treturn CKEDITOR.LINEUTILS_BEFORE;\n\t\t *\t\t\t},\n\t\t *\t\t\t...\n\t\t *\t\t}\n\t\t *\n\t\t * @property {Object} lookups\n\t\t */\n\t};\n\n\n\t/**\n\t * A utility that analyses relations found by\n\t * CKEDITOR.plugins.lineutils.finder and locates them\n\t * in the viewport as horizontal lines of specific coordinates.\n\t *\n\t * @private\n\t * @class CKEDITOR.plugins.lineutils.locator\n\t * @constructor Creates a Locator class instance.\n\t * @param {CKEDITOR.editor} editor Editor instance that Locator belongs to.\n\t * @since 4.3\n\t */\n\tfunction Locator( editor, def ) {\n\t\tCKEDITOR.tools.extend( this, def, {\n\t\t\teditor: editor\n\t\t}, true );\n\t}\n\n\tLocator.prototype = {\n\t\t/**\n\t\t * Locates the Y coordinate for all types of every single relation and stores\n\t\t * them in an object.\n\t\t *\n\t\t * @param {Object} relations {@link CKEDITOR.plugins.lineutils.finder#relations}.\n\t\t * @returns {Object} {@link #locations}.\n\t\t */\n\t\tlocate: ( function() {\n\t\t\tfunction locateSibling( rel, type ) {\n\t\t\t\tvar sib = rel.element[ type === CKEDITOR.LINEUTILS_BEFORE ? 'getPrevious' : 'getNext' ]();\n\n\t\t\t\t// Return the middle point between siblings.\n\t\t\t\tif ( sib && isStatic( sib ) ) {\n\t\t\t\t\trel.siblingRect = sib.getClientRect();\n\n\t\t\t\t\tif ( type == CKEDITOR.LINEUTILS_BEFORE ) {\n\t\t\t\t\t\treturn ( rel.siblingRect.bottom + rel.elementRect.top ) / 2;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn ( rel.elementRect.bottom + rel.siblingRect.top ) / 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// If there's no sibling, use the edge of an element.\n\t\t\t\telse {\n\t\t\t\t\tif ( type == CKEDITOR.LINEUTILS_BEFORE ) {\n\t\t\t\t\t\treturn rel.elementRect.top;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn rel.elementRect.bottom;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn function( relations ) {\n\t\t\t\tvar rel;\n\n\t\t\t\tthis.locations = {};\n\n\t\t\t\tfor ( var uid in relations ) {\n\t\t\t\t\trel = relations[ uid ];\n\t\t\t\t\trel.elementRect = rel.element.getClientRect();\n\n\t\t\t\t\tif ( is( rel.type, CKEDITOR.LINEUTILS_BEFORE ) ) {\n\t\t\t\t\t\tthis.store( uid, CKEDITOR.LINEUTILS_BEFORE, locateSibling( rel, CKEDITOR.LINEUTILS_BEFORE ) );\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( is( rel.type, CKEDITOR.LINEUTILS_AFTER ) ) {\n\t\t\t\t\t\tthis.store( uid, CKEDITOR.LINEUTILS_AFTER, locateSibling( rel, CKEDITOR.LINEUTILS_AFTER ) );\n\t\t\t\t\t}\n\n\t\t\t\t\t// The middle point of the element.\n\t\t\t\t\tif ( is( rel.type, CKEDITOR.LINEUTILS_INSIDE ) ) {\n\t\t\t\t\t\tthis.store( uid, CKEDITOR.LINEUTILS_INSIDE, ( rel.elementRect.top + rel.elementRect.bottom ) / 2 );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn this.locations;\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Calculates distances from every location to given vertical coordinate\n\t\t * and sorts locations according to that distance.\n\t\t *\n\t\t * @param {Number} y The vertical coordinate used for sorting, used as a reference.\n\t\t * @param {Number} [howMany] Determines the number of \"closest locations\" to be returned.\n\t\t * @returns {Array} Sorted, array representation of {@link #locations}.\n\t\t */\n\t\tsort: ( function() {\n\t\t\tvar locations, sorted,\n\t\t\t\tdist, i;\n\n\t\t\tfunction distance( y, uid, type ) {\n\t\t\t\treturn Math.abs( y - locations[ uid ][ type ] );\n\t\t\t}\n\n\t\t\treturn function( y, howMany ) {\n\t\t\t\tlocations = this.locations;\n\t\t\t\tsorted = [];\n\n\t\t\t\tfor ( var uid in locations ) {\n\t\t\t\t\tfor ( var type in locations[ uid ] ) {\n\t\t\t\t\t\tdist = distance( y, uid, type );\n\n\t\t\t\t\t\t// An array is empty.\n\t\t\t\t\t\tif ( !sorted.length ) {\n\t\t\t\t\t\t\tsorted.push( { uid: +uid, type: type, dist: dist } );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Sort the array on fly when it's populated.\n\t\t\t\t\t\t\tfor ( i = 0; i < sorted.length; i++ ) {\n\t\t\t\t\t\t\t\tif ( dist < sorted[ i ].dist ) {\n\t\t\t\t\t\t\t\t\tsorted.splice( i, 0, { uid: +uid, type: type, dist: dist } );\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Nothing was inserted, so the distance is bigger than\n\t\t\t\t\t\t\t// any of already calculated: push to the end.\n\t\t\t\t\t\t\tif ( i == sorted.length ) {\n\t\t\t\t\t\t\t\tsorted.push( { uid: +uid, type: type, dist: dist } );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( typeof howMany != 'undefined' ) {\n\t\t\t\t\treturn sorted.slice( 0, howMany );\n\t\t\t\t} else {\n\t\t\t\t\treturn sorted;\n\t\t\t\t}\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Stores the location in a collection.\n\t\t *\n\t\t * @param {Number} uid Unique identifier of the relation.\n\t\t * @param {Number} type One of `CKEDITOR.LINEUTILS_BEFORE`, `CKEDITOR.LINEUTILS_AFTER` and `CKEDITOR.LINEUTILS_INSIDE`.\n\t\t * @param {Number} y Vertical position of the relation.\n\t\t */\n\t\tstore: function( uid, type, y ) {\n\t\t\tif ( !this.locations[ uid ] ) {\n\t\t\t\tthis.locations[ uid ] = {};\n\t\t\t}\n\n\t\t\tthis.locations[ uid ][ type ] = y;\n\t\t}\n\n\t\t/**\n\t\t * @readonly\n\t\t * @property {Object} locations\n\t\t */\n\t};\n\n\tvar tipCss = {\n\t\t\tdisplay: 'block',\n\t\t\twidth: '0px',\n\t\t\theight: '0px',\n\t\t\t'border-color': 'transparent',\n\t\t\t'border-style': 'solid',\n\t\t\tposition: 'absolute',\n\t\t\ttop: '-6px'\n\t\t},\n\n\t\tlineStyle = {\n\t\t\theight: '0px',\n\t\t\t'border-top': '1px dashed red',\n\t\t\tposition: 'absolute',\n\t\t\t'z-index': 9999\n\t\t},\n\n\t\tlineTpl =\n\t\t\t'<div data-cke-lineutils-line=\"1\" class=\"cke_reset_all\" style=\"{lineStyle}\">' +\n\t\t\t\t'<span style=\"{tipLeftStyle}\">&nbsp;</span>' +\n\t\t\t\t'<span style=\"{tipRightStyle}\">&nbsp;</span>' +\n\t\t\t'</div>';\n\n\t/**\n\t * A utility that draws horizontal lines in DOM according to locations\n\t * returned by CKEDITOR.plugins.lineutils.locator.\n\t *\n\t * @private\n\t * @class CKEDITOR.plugins.lineutils.liner\n\t * @constructor Creates a Liner class instance.\n\t * @param {CKEDITOR.editor} editor Editor instance that Liner belongs to.\n\t * @param {Object} def Liner's definition.\n\t * @since 4.3\n\t */\n\tfunction Liner( editor, def ) {\n\t\tvar editable = editor.editable();\n\n\t\tCKEDITOR.tools.extend( this, {\n\t\t\teditor: editor,\n\t\t\teditable: editable,\n\t\t\tinline: editable.isInline(),\n\t\t\tdoc: editor.document,\n\t\t\twin: editor.window,\n\t\t\tcontainer: CKEDITOR.document.getBody(),\n\t\t\twinTop: CKEDITOR.document.getWindow()\n\t\t}, def, true );\n\n\t\tthis.hidden = {};\n\t\tthis.visible = {};\n\n\t\tif ( !this.inline ) {\n\t\t\tthis.frame = this.win.getFrame();\n\t\t}\n\n\t\tthis.queryViewport();\n\n\t\t// Callbacks must be wrapped. Otherwise they're not attached\n\t\t// to global DOM objects (i.e. topmost window) for every editor\n\t\t// because they're treated as duplicates. They belong to the\n\t\t// same prototype shared among Liner instances.\n\t\tvar queryViewport = CKEDITOR.tools.bind( this.queryViewport, this ),\n\t\t\thideVisible = CKEDITOR.tools.bind( this.hideVisible, this ),\n\t\t\tremoveAll = CKEDITOR.tools.bind( this.removeAll, this );\n\n\t\teditable.attachListener( this.winTop, 'resize', queryViewport );\n\t\teditable.attachListener( this.winTop, 'scroll', queryViewport );\n\n\t\teditable.attachListener( this.winTop, 'resize', hideVisible );\n\t\teditable.attachListener( this.win, 'scroll', hideVisible );\n\n\t\teditable.attachListener( this.inline ? editable : this.frame, 'mouseout', function( evt ) {\n\t\t\tvar x = evt.data.$.clientX,\n\t\t\t\ty = evt.data.$.clientY;\n\n\t\t\tthis.queryViewport();\n\n\t\t\t// Check if mouse is out of the element (iframe/editable).\n\t\t\tif ( x <= this.rect.left || x >= this.rect.right || y <= this.rect.top || y >= this.rect.bottom ) {\n\t\t\t\tthis.hideVisible();\n\t\t\t}\n\n\t\t\t// Check if mouse is out of the top-window vieport.\n\t\t\tif ( x <= 0 || x >= this.winTopPane.width || y <= 0 || y >= this.winTopPane.height ) {\n\t\t\t\tthis.hideVisible();\n\t\t\t}\n\t\t}, this );\n\n\t\teditable.attachListener( editor, 'resize', queryViewport );\n\t\teditable.attachListener( editor, 'mode', removeAll );\n\t\teditor.on( 'destroy', removeAll );\n\n\t\tthis.lineTpl = new CKEDITOR.template( lineTpl ).output( {\n\t\t\tlineStyle: CKEDITOR.tools.writeCssText(\n\t\t\t\tCKEDITOR.tools.extend( {}, lineStyle, this.lineStyle, true )\n\t\t\t),\n\t\t\ttipLeftStyle: CKEDITOR.tools.writeCssText(\n\t\t\t\tCKEDITOR.tools.extend( {}, tipCss, {\n\t\t\t\t\tleft: '0px',\n\t\t\t\t\t'border-left-color': 'red',\n\t\t\t\t\t'border-width': '6px 0 6px 6px'\n\t\t\t\t}, this.tipCss, this.tipLeftStyle, true )\n\t\t\t),\n\t\t\ttipRightStyle: CKEDITOR.tools.writeCssText(\n\t\t\t\tCKEDITOR.tools.extend( {}, tipCss, {\n\t\t\t\t\tright: '0px',\n\t\t\t\t\t'border-right-color': 'red',\n\t\t\t\t\t'border-width': '6px 6px 6px 0'\n\t\t\t\t}, this.tipCss, this.tipRightStyle, true )\n\t\t\t)\n\t\t} );\n\t}\n\n\tLiner.prototype = {\n\t\t/**\n\t\t * Permanently removes all lines (both hidden and visible) from DOM.\n\t\t */\n\t\tremoveAll: function() {\n\t\t\tvar l;\n\n\t\t\tfor ( l in this.hidden ) {\n\t\t\t\tthis.hidden[ l ].remove();\n\t\t\t\tdelete this.hidden[ l ];\n\t\t\t}\n\n\t\t\tfor ( l in this.visible ) {\n\t\t\t\tthis.visible[ l ].remove();\n\t\t\t\tdelete this.visible[ l ];\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Hides a given line.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} line The line to be hidden.\n\t\t */\n\t\thideLine: function( line ) {\n\t\t\tvar uid = line.getUniqueId();\n\n\t\t\tline.hide();\n\n\t\t\tthis.hidden[ uid ] = line;\n\t\t\tdelete this.visible[ uid ];\n\t\t},\n\n\t\t/**\n\t\t * Shows a given line.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} line The line to be shown.\n\t\t */\n\t\tshowLine: function( line ) {\n\t\t\tvar uid = line.getUniqueId();\n\n\t\t\tline.show();\n\n\t\t\tthis.visible[ uid ] = line;\n\t\t\tdelete this.hidden[ uid ];\n\t\t},\n\n\t\t/**\n\t\t * Hides all visible lines.\n\t\t */\n\t\thideVisible: function() {\n\t\t\tfor ( var l in this.visible ) {\n\t\t\t\tthis.hideLine( this.visible[ l ] );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Shows a line at given location.\n\t\t *\n\t\t * @param {Object} location Location object containing the unique identifier of the relation\n\t\t * and its type. Usually returned by {@link CKEDITOR.plugins.lineutils.locator#sort}.\n\t\t * @param {Function} [callback] A callback to be called once the line is shown.\n\t\t */\n\t\tplaceLine: function( location, callback ) {\n\t\t\tvar styles, line, l;\n\n\t\t\t// No style means that line would be out of viewport.\n\t\t\tif ( !( styles = this.getStyle( location.uid, location.type ) ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Search for any visible line of a different hash first.\n\t\t\t// It's faster to re-position visible line than to show it.\n\t\t\tfor ( l in this.visible ) {\n\t\t\t\tif ( this.visible[ l ].getCustomData( 'hash' ) !== this.hash ) {\n\t\t\t\t\tline = this.visible[ l ];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Search for any hidden line of a different hash.\n\t\t\tif ( !line ) {\n\t\t\t\tfor ( l in this.hidden ) {\n\t\t\t\t\tif ( this.hidden[ l ].getCustomData( 'hash' ) !== this.hash ) {\n\t\t\t\t\t\tthis.showLine( ( line = this.hidden[ l ] ) );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If no line available, add the new one.\n\t\t\tif ( !line ) {\n\t\t\t\tthis.showLine( ( line = this.addLine() ) );\n\t\t\t}\n\n\t\t\t// Mark the line with current hash.\n\t\t\tline.setCustomData( 'hash', this.hash );\n\n\t\t\t// Mark the line as visible.\n\t\t\tthis.visible[ line.getUniqueId() ] = line;\n\n\t\t\tline.setStyles( styles );\n\n\t\t\tcallback && callback( line );\n\t\t},\n\n\t\t/**\n\t\t * Creates a style set to be used by the line, representing a particular\n\t\t * relation (location).\n\t\t *\n\t\t * @param {Number} uid Unique identifier of the relation.\n\t\t * @param {Number} type Type of the relation.\n\t\t * @returns {Object} An object containing styles.\n\t\t */\n\t\tgetStyle: function( uid, type ) {\n\t\t\tvar rel = this.relations[ uid ],\n\t\t\t\tloc = this.locations[ uid ][ type ],\n\t\t\t\tstyles = {},\n\t\t\t\thdiff;\n\n\t\t\t// Line should be between two elements.\n\t\t\tif ( rel.siblingRect ) {\n\t\t\t\tstyles.width = Math.max( rel.siblingRect.width, rel.elementRect.width );\n\t\t\t}\n\t\t\t// Line is relative to a single element.\n\t\t\telse {\n\t\t\t\tstyles.width = rel.elementRect.width;\n\t\t\t}\n\n\t\t\t// Let's calculate the vertical position of the line.\n\t\t\tif ( this.inline ) {\n\t\t\t\t// (#13155)\n\t\t\t\tstyles.top = loc + this.winTopScroll.y - this.rect.relativeY;\n\t\t\t} else {\n\t\t\t\tstyles.top = this.rect.top + this.winTopScroll.y + loc;\n\t\t\t}\n\n\t\t\t// Check if line would be vertically out of the viewport.\n\t\t\tif ( styles.top - this.winTopScroll.y < this.rect.top || styles.top - this.winTopScroll.y > this.rect.bottom ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Now let's calculate the horizontal alignment (left and width).\n\t\t\tif ( this.inline ) {\n\t\t\t\t// (#13155)\n\t\t\t\tstyles.left = rel.elementRect.left - this.rect.relativeX;\n\t\t\t} else {\n\t\t\t\tif ( rel.elementRect.left > 0 )\n\t\t\t\t\tstyles.left = this.rect.left + rel.elementRect.left;\n\n\t\t\t\t// H-scroll case. Left edge of element may be out of viewport.\n\t\t\t\telse {\n\t\t\t\t\tstyles.width += rel.elementRect.left;\n\t\t\t\t\tstyles.left = this.rect.left;\n\t\t\t\t}\n\n\t\t\t\t// H-scroll case. Right edge of element may be out of viewport.\n\t\t\t\tif ( ( hdiff = styles.left + styles.width - ( this.rect.left + this.winPane.width ) ) > 0 ) {\n\t\t\t\t\tstyles.width -= hdiff;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Finally include horizontal scroll of the global window.\n\t\t\tstyles.left += this.winTopScroll.x;\n\n\t\t\t// Append 'px' to style values.\n\t\t\tfor ( var style in styles ) {\n\t\t\t\tstyles[ style ] = CKEDITOR.tools.cssLength( styles[ style ] );\n\t\t\t}\n\n\t\t\treturn styles;\n\t\t},\n\n\t\t/**\n\t\t * Adds a new line to DOM.\n\t\t *\n\t\t * @returns {CKEDITOR.dom.element} A brand-new line.\n\t\t */\n\t\taddLine: function() {\n\t\t\tvar line = CKEDITOR.dom.element.createFromHtml( this.lineTpl );\n\n\t\t\tline.appendTo( this.container );\n\n\t\t\treturn line;\n\t\t},\n\n\t\t/**\n\t\t * Assigns a unique hash to the instance that is later used\n\t\t * to tell unwanted lines from new ones. This method **must** be called\n\t\t * before a new set of relations is to be visualized so {@link #cleanup}\n\t\t * eventually hides obsolete lines. This is because lines\n\t\t * are re-used between {@link #placeLine} calls and the number of\n\t\t * necessary ones may vary depending on the number of relations.\n\t\t *\n\t\t * @param {Object} relations {@link CKEDITOR.plugins.lineutils.finder#relations}.\n\t\t * @param {Object} locations {@link CKEDITOR.plugins.lineutils.locator#locations}.\n\t\t */\n\t\tprepare: function( relations, locations ) {\n\t\t\tthis.relations = relations;\n\t\t\tthis.locations = locations;\n\t\t\tthis.hash = Math.random();\n\t\t},\n\n\t\t/**\n\t\t * Hides all visible lines that do not belong to current hash\n\t\t * and no longer represent relations (locations).\n\t\t *\n\t\t * See also: {@link #prepare}.\n\t\t */\n\t\tcleanup: function() {\n\t\t\tvar line;\n\n\t\t\tfor ( var l in this.visible ) {\n\t\t\t\tline = this.visible[ l ];\n\n\t\t\t\tif ( line.getCustomData( 'hash' ) !== this.hash ) {\n\t\t\t\t\tthis.hideLine( line );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Queries dimensions of the viewport, editable, frame etc.\n\t\t * that are used for correct positioning of the line.\n\t\t */\n\t\tqueryViewport: function() {\n\t\t\tthis.winPane = this.win.getViewPaneSize();\n\t\t\tthis.winTopScroll = this.winTop.getScrollPosition();\n\t\t\tthis.winTopPane = this.winTop.getViewPaneSize();\n\n\t\t\t// (#13155)\n\t\t\tthis.rect = this.getClientRect( this.inline ? this.editable : this.frame );\n\t\t},\n\n\t\t/**\n\t\t * Returns `boundingClientRect` of an element, shifted by the position\n\t\t * of `container` when the container is not `static` (#13155).\n\t\t *\n\t\t * See also: {@link CKEDITOR.dom.element#getClientRect}.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} el A DOM element.\n\t\t * @returns {Object} A shifted rect, extended by `relativeY` and `relativeX` properties.\n\t\t */\n\t\tgetClientRect: function( el ) {\n\t\t\tvar rect = el.getClientRect(),\n\t\t\t\trelativeContainerDocPosition = this.container.getDocumentPosition(),\n\t\t\t\trelativeContainerComputedPosition = this.container.getComputedStyle( 'position' );\n\n\t\t\t// Static or not, those values are used to offset the position of the line so they cannot be undefined.\n\t\t\trect.relativeX = rect.relativeY = 0;\n\n\t\t\tif ( relativeContainerComputedPosition != 'static' ) {\n\t\t\t\t// Remember the offset used to shift the clientRect.\n\t\t\t\trect.relativeY = relativeContainerDocPosition.y;\n\t\t\t\trect.relativeX = relativeContainerDocPosition.x;\n\n\t\t\t\trect.top -= rect.relativeY;\n\t\t\t\trect.bottom -= rect.relativeY;\n\t\t\t\trect.left -= rect.relativeX;\n\t\t\t\trect.right -= rect.relativeX;\n\t\t\t}\n\n\t\t\treturn rect;\n\t\t}\n\t};\n\n\tfunction is( type, flag ) {\n\t\treturn type & flag;\n\t}\n\n\tvar floats = { left: 1, right: 1, center: 1 },\n\t\tpositions = { absolute: 1, fixed: 1 };\n\n\tfunction isElement( node ) {\n\t\treturn node && node.type == CKEDITOR.NODE_ELEMENT;\n\t}\n\n\tfunction isFloated( el ) {\n\t\treturn !!( floats[ el.getComputedStyle( 'float' ) ] || floats[ el.getAttribute( 'align' ) ] );\n\t}\n\n\tfunction isPositioned( el ) {\n\t\treturn !!positions[ el.getComputedStyle( 'position' ) ];\n\t}\n\n\tfunction isLimit( node ) {\n\t\treturn isElement( node ) && node.getAttribute( 'contenteditable' ) == 'true';\n\t}\n\n\tfunction isStatic( node ) {\n\t\treturn isElement( node ) && !isFloated( node ) && !isPositioned( node );\n\t}\n\n\t/**\n\t * Global namespace storing definitions and global helpers for the Line Utilities plugin.\n\t *\n\t * @private\n\t * @class\n\t * @singleton\n\t * @since 4.3\n\t */\n\tCKEDITOR.plugins.lineutils = {\n\t\tfinder: Finder,\n\t\tlocator: Locator,\n\t\tliner: Liner\n\t};\n} )();\n"]}