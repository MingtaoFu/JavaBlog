{"version":3,"sources":["plugin.js"],"names":[],"mappings":"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","file":"plugin-compiled.js","sourcesContent":["﻿/**\n * @license Copyright (c) 2003-2015, CKSource - Frederico Knabben. All rights reserved.\n * For licensing, see LICENSE.md or http://ckeditor.com/license\n */\n\n/**\n * @fileOverview [Widget](http://ckeditor.com/addon/widget) plugin.\n */\n\n'use strict';\n\n( function() {\n\tvar DRAG_HANDLER_SIZE = 15;\n\n\tCKEDITOR.plugins.add( 'widget', {\n\t\t// jscs:disable maximumLineLength\n\t\tlang: 'af,ar,bg,ca,cs,cy,da,de,el,en,en-gb,eo,es,eu,fa,fi,fr,gl,he,hr,hu,id,it,ja,km,ko,ku,lv,nb,nl,no,pl,pt,pt-br,ru,sk,sl,sq,sv,tr,tt,ug,uk,vi,zh,zh-cn', // %REMOVE_LINE_CORE%\n\t\t// jscs:enable maximumLineLength\n\t\trequires: 'lineutils,clipboard',\n\t\tonLoad: function() {\n\t\t\tCKEDITOR.addCss(\n\t\t\t\t'.cke_widget_wrapper{' +\n\t\t\t\t\t'position:relative;' +\n\t\t\t\t\t'outline:none' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_inline{' +\n\t\t\t\t\t'display:inline-block' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_wrapper:hover>.cke_widget_element{' +\n\t\t\t\t\t'outline:2px solid yellow;' +\n\t\t\t\t\t'cursor:default' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_wrapper:hover .cke_widget_editable{' +\n\t\t\t\t\t'outline:2px solid yellow' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_wrapper.cke_widget_focused>.cke_widget_element,' +\n\t\t\t\t// We need higher specificity than hover style.\n\t\t\t\t'.cke_widget_wrapper .cke_widget_editable.cke_widget_editable_focused{' +\n\t\t\t\t\t'outline:2px solid #ace' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_editable{' +\n\t\t\t\t\t'cursor:text' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_drag_handler_container{' +\n\t\t\t\t\t'position:absolute;' +\n\t\t\t\t\t'width:' + DRAG_HANDLER_SIZE + 'px;' +\n\t\t\t\t\t'height:0;' +\n\t\t\t\t\t// Initially drag handler should not be visible, until its position will be\n\t\t\t\t\t// calculated (#11177).\n\t\t\t\t\t// We need to hide unpositined handlers, so they don't extend\n\t\t\t\t\t// widget's outline far to the left (#12024).\n\t\t\t\t\t'display:none;' +\n\t\t\t\t\t'opacity:0.75;' +\n\t\t\t\t\t'transition:height 0s 0.2s;' + // Delay hiding drag handler.\n\t\t\t\t\t// Prevent drag handler from being misplaced (#11198).\n\t\t\t\t\t'line-height:0' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_wrapper:hover>.cke_widget_drag_handler_container{' +\n\t\t\t\t\t'height:' + DRAG_HANDLER_SIZE + 'px;' +\n\t\t\t\t\t'transition:none' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_drag_handler_container:hover{' +\n\t\t\t\t\t'opacity:1' +\n\t\t\t\t'}' +\n\t\t\t\t'img.cke_widget_drag_handler{' +\n\t\t\t\t\t'cursor:move;' +\n\t\t\t\t\t'width:' + DRAG_HANDLER_SIZE + 'px;' +\n\t\t\t\t\t'height:' + DRAG_HANDLER_SIZE + 'px;' +\n\t\t\t\t\t'display:inline-block' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_widget_mask{' +\n\t\t\t\t\t'position:absolute;' +\n\t\t\t\t\t'top:0;' +\n\t\t\t\t\t'left:0;' +\n\t\t\t\t\t'width:100%;' +\n\t\t\t\t\t'height:100%;' +\n\t\t\t\t\t'display:block' +\n\t\t\t\t'}' +\n\t\t\t\t'.cke_editable.cke_widget_dragging, .cke_editable.cke_widget_dragging *{' +\n\t\t\t\t\t'cursor:move !important' +\n\t\t\t\t'}'\n\t\t\t);\n\t\t},\n\n\t\tbeforeInit: function( editor ) {\n\t\t\t/**\n\t\t\t * An instance of widget repository. It contains all\n\t\t\t * {@link CKEDITOR.plugins.widget.repository#registered registered widget definitions} and\n\t\t\t * {@link CKEDITOR.plugins.widget.repository#instances initialized instances}.\n\t\t\t *\n\t\t\t *\t\teditor.widgets.add( 'someName', {\n\t\t\t *\t\t\t// Widget definition...\n\t\t\t *\t\t} );\n\t\t\t *\n\t\t\t *\t\teditor.widgets.registered.someName; // -> Widget definition\n\t\t\t *\n\t\t\t * @since 4.3\n\t\t\t * @readonly\n\t\t\t * @property {CKEDITOR.plugins.widget.repository} widgets\n\t\t\t * @member CKEDITOR.editor\n\t\t\t */\n\t\t\teditor.widgets = new Repository( editor );\n\t\t},\n\n\t\tafterInit: function( editor ) {\n\t\t\taddWidgetButtons( editor );\n\t\t\tsetupContextMenu( editor );\n\t\t}\n\t} );\n\n\t/**\n\t * Widget repository. It keeps track of all {@link #registered registered widget definitions} and\n\t * {@link #instances initialized instances}. An instance of the repository is available under\n\t * the {@link CKEDITOR.editor#widgets} property.\n\t *\n\t * @class CKEDITOR.plugins.widget.repository\n\t * @mixins CKEDITOR.event\n\t * @constructor Creates a widget repository instance. Note that the widget plugin automatically\n\t * creates a repository instance which is available under the {@link CKEDITOR.editor#widgets} property.\n\t * @param {CKEDITOR.editor} editor The editor instance for which the repository will be created.\n\t */\n\tfunction Repository( editor ) {\n\t\t/**\n\t\t * The editor instance for which this repository was created.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.editor} editor\n\t\t */\n\t\tthis.editor = editor;\n\n\t\t/**\n\t\t * A hash of registered widget definitions (definition name => {@link CKEDITOR.plugins.widget.definition}).\n\t\t *\n\t\t * To register a definition use the {@link #add} method.\n\t\t *\n\t\t * @readonly\n\t\t */\n\t\tthis.registered = {};\n\n\t\t/**\n\t\t * An object containing initialized widget instances (widget id => {@link CKEDITOR.plugins.widget}).\n\t\t *\n\t\t * @readonly\n\t\t */\n\t\tthis.instances = {};\n\n\t\t/**\n\t\t * An array of selected widget instances.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.plugins.widget[]} selected\n\t\t */\n\t\tthis.selected = [];\n\n\t\t/**\n\t\t * The focused widget instance. See also {@link CKEDITOR.plugins.widget#event-focus}\n\t\t * and {@link CKEDITOR.plugins.widget#event-blur} events.\n\t\t *\n\t\t *\t\teditor.on( 'selectionChange', function() {\n\t\t *\t\t\tif ( editor.widgets.focused ) {\n\t\t *\t\t\t\t// Do something when a widget is focused...\n\t\t *\t\t\t}\n\t\t *\t\t} );\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.plugins.widget} focused\n\t\t */\n\t\tthis.focused = null;\n\n\t\t/**\n\t\t * The widget instance that contains the nested editable which is currently focused.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.plugins.widget} widgetHoldingFocusedEditable\n\t\t */\n\t\tthis.widgetHoldingFocusedEditable = null;\n\n\t\tthis._ = {\n\t\t\tnextId: 0,\n\t\t\tupcasts: [],\n\t\t\tupcastCallbacks: [],\n\t\t\tfilters: {}\n\t\t};\n\n\t\tsetupWidgetsLifecycle( this );\n\t\tsetupSelectionObserver( this );\n\t\tsetupMouseObserver( this );\n\t\tsetupKeyboardObserver( this );\n\t\tsetupDragAndDrop( this );\n\t\tsetupNativeCutAndCopy( this );\n\t}\n\n\tRepository.prototype = {\n\t\t/**\n\t\t * Minimum interval between selection checks.\n\t\t *\n\t\t * @private\n\t\t */\n\t\tMIN_SELECTION_CHECK_INTERVAL: 500,\n\n\t\t/**\n\t\t * Adds a widget definition to the repository. Fires the {@link CKEDITOR.editor#widgetDefinition} event\n\t\t * which allows to modify the widget definition which is going to be registered.\n\t\t *\n\t\t * @param {String} name The name of the widget definition.\n\t\t * @param {CKEDITOR.plugins.widget.definition} widgetDef Widget definition.\n\t\t * @returns {CKEDITOR.plugins.widget.definition}\n\t\t */\n\t\tadd: function( name, widgetDef ) {\n\t\t\t// Create prototyped copy of original widget definition, so we won't modify it.\n\t\t\twidgetDef = CKEDITOR.tools.prototypedCopy( widgetDef );\n\t\t\twidgetDef.name = name;\n\n\t\t\twidgetDef._ = widgetDef._ || {};\n\n\t\t\tthis.editor.fire( 'widgetDefinition', widgetDef );\n\n\t\t\tif ( widgetDef.template )\n\t\t\t\twidgetDef.template = new CKEDITOR.template( widgetDef.template );\n\n\t\t\taddWidgetCommand( this.editor, widgetDef );\n\t\t\taddWidgetProcessors( this, widgetDef );\n\n\t\t\tthis.registered[ name ] = widgetDef;\n\n\t\t\treturn widgetDef;\n\t\t},\n\n\t\t/**\n\t\t * Adds a callback for element upcasting. Each callback will be executed\n\t\t * for every element which is later tested by upcast methods. If a callback\n\t\t * returns `false`, the element will not be upcasted.\n\t\t *\n\t\t *\t\t// Images with the \"banner\" class will not be upcasted (e.g. to the image widget).\n\t\t *\t\teditor.widgets.addUpcastCallback( function( element ) {\n\t\t *\t\t\tif ( element.name == 'img' && element.hasClass( 'banner' ) )\n\t\t *\t\t\t\treturn false;\n\t\t *\t\t} );\n\t\t *\n\t\t * @param {Function} callback\n\t\t * @param {CKEDITOR.htmlParser.element} callback.element\n\t\t */\n\t\taddUpcastCallback: function( callback ) {\n\t\t\tthis._.upcastCallbacks.push( callback );\n\t\t},\n\n\t\t/**\n\t\t * Checks the selection to update widget states (selection and focus).\n\t\t *\n\t\t * This method is triggered by the {@link #event-checkSelection} event.\n\t\t */\n\t\tcheckSelection: function() {\n\t\t\tvar sel = this.editor.getSelection(),\n\t\t\t\tselectedElement = sel.getSelectedElement(),\n\t\t\t\tupdater = stateUpdater( this ),\n\t\t\t\twidget;\n\n\t\t\t// Widget is focused so commit and finish checking.\n\t\t\tif ( selectedElement && ( widget = this.getByElement( selectedElement, true ) ) )\n\t\t\t\treturn updater.focus( widget ).select( widget ).commit();\n\n\t\t\tvar range = sel.getRanges()[ 0 ];\n\n\t\t\t// No ranges or collapsed range mean that nothing is selected, so commit and finish checking.\n\t\t\tif ( !range || range.collapsed )\n\t\t\t\treturn updater.commit();\n\n\t\t\t// Range is not empty, so create walker checking for wrappers.\n\t\t\tvar walker = new CKEDITOR.dom.walker( range ),\n\t\t\t\twrapper;\n\n\t\t\twalker.evaluator = Widget.isDomWidgetWrapper;\n\n\t\t\twhile ( ( wrapper = walker.next() ) )\n\t\t\t\tupdater.select( this.getByElement( wrapper ) );\n\n\t\t\tupdater.commit();\n\t\t},\n\n\t\t/**\n\t\t * Checks if all widget instances are still present in the DOM.\n\t\t * Destroys those instances that are not present.\n\t\t * Reinitializes widgets on widget wrappers for which widget instances\n\t\t * cannot be found. Takes nested widgets into account, too.\n\t\t *\n\t\t * This method triggers the {@link #event-checkWidgets} event whose listeners\n\t\t * can cancel the method's execution or modify its options.\n\t\t *\n\t\t * @param [options] The options object.\n\t\t * @param {Boolean} [options.initOnlyNew] Initializes widgets only on newly wrapped\n\t\t * widget elements (those which still have the `cke_widget_new` class). When this option is\n\t\t * set to `true`, widgets which were invalidated (e.g. by replacing with a cloned DOM structure)\n\t\t * will not be reinitialized. This makes the check faster.\n\t\t * @param {Boolean} [options.focusInited] If only one widget is initialized by\n\t\t * the method, it will be focused.\n\t\t */\n\t\tcheckWidgets: function( options ) {\n\t\t\tthis.fire( 'checkWidgets', CKEDITOR.tools.copy( options || {} ) );\n\t\t},\n\n\t\t/**\n\t\t * Removes the widget from the editor and moves the selection to the closest\n\t\t * editable position if the widget was focused before.\n\t\t *\n\t\t * @param {CKEDITOR.plugins.widget} widget The widget instance to be deleted.\n\t\t */\n\t\tdel: function( widget ) {\n\t\t\tif ( this.focused === widget ) {\n\t\t\t\tvar editor = widget.editor,\n\t\t\t\t\trange = editor.createRange(),\n\t\t\t\t\tfound;\n\n\t\t\t\t// If haven't found place for caret on the default side,\n\t\t\t\t// try to find it on the other side.\n\t\t\t\tif ( !( found = range.moveToClosestEditablePosition( widget.wrapper, true ) ) )\n\t\t\t\t\tfound = range.moveToClosestEditablePosition( widget.wrapper, false );\n\n\t\t\t\tif ( found )\n\t\t\t\t\teditor.getSelection().selectRanges( [ range ] );\n\t\t\t}\n\n\t\t\twidget.wrapper.remove();\n\t\t\tthis.destroy( widget, true );\n\t\t},\n\n\t\t/**\n\t\t * Destroys the widget instance and all its nested widgets (widgets inside its nested editables).\n\t\t *\n\t\t * @param {CKEDITOR.plugins.widget} widget The widget instance to be destroyed.\n\t\t * @param {Boolean} [offline] Whether the widget is offline (detached from the DOM tree) &mdash;\n\t\t * in this case the DOM (attributes, classes, etc.) will not be cleaned up.\n\t\t */\n\t\tdestroy: function( widget, offline ) {\n\t\t\tif ( this.widgetHoldingFocusedEditable === widget )\n\t\t\t\tsetFocusedEditable( this, widget, null, offline );\n\n\t\t\twidget.destroy( offline );\n\t\t\tdelete this.instances[ widget.id ];\n\t\t\tthis.fire( 'instanceDestroyed', widget );\n\t\t},\n\n\t\t/**\n\t\t * Destroys all widget instances.\n\t\t *\n\t\t * @param {Boolean} [offline] Whether the widgets are offline (detached from the DOM tree) &mdash;\n\t\t * in this case the DOM (attributes, classes, etc.) will not be cleaned up.\n\t\t * @param {CKEDITOR.dom.element} [container] The container within widgets will be destroyed.\n\t\t * This option will be ignored if the `offline` flag was set to `true`, because in such case\n\t\t * it is not possible to find widgets within the passed block.\n\t\t */\n\t\tdestroyAll: function( offline, container ) {\n\t\t\tvar widget,\n\t\t\t\tid,\n\t\t\t\tinstances = this.instances;\n\n\t\t\tif ( container && !offline ) {\n\t\t\t\tvar wrappers = container.find( '.cke_widget_wrapper' ),\n\t\t\t\t\tl = wrappers.count(),\n\t\t\t\t\ti = 0;\n\n\t\t\t\t// Length is constant, because this is not a live node list.\n\t\t\t\t// Note: since querySelectorAll returns nodes in document order,\n\t\t\t\t// outer widgets are always placed before their nested widgets and therefore\n\t\t\t\t// are destroyed before them.\n\t\t\t\tfor ( ; i < l; ++i ) {\n\t\t\t\t\twidget = this.getByElement( wrappers.getItem( i ), true );\n\t\t\t\t\t// Widget might not be found, because it could be a nested widget,\n\t\t\t\t\t// which would be destroyed when destroying its parent.\n\t\t\t\t\tif ( widget )\n\t\t\t\t\t\tthis.destroy( widget );\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor ( id in instances ) {\n\t\t\t\twidget = instances[ id ];\n\t\t\t\tthis.destroy( widget, offline );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Finalizes a process of widget creation. This includes:\n\t\t *\n\t\t * * inserting widget element into editor,\n\t\t * * marking widget instance as ready (see {@link CKEDITOR.plugins.widget#event-ready}),\n\t\t * * focusing widget instance.\n\t\t *\n\t\t * This method is used by the default widget's command and is called\n\t\t * after widget's dialog (if set) is closed. It may also be used in a\n\t\t * customized process of widget creation and insertion.\n\t\t *\n\t\t *\t\twidget.once( 'edit', function() {\n\t\t *\t\t\t// Finalize creation only of not ready widgets.\n\t\t *\t\t\tif ( widget.isReady() )\n\t\t *\t\t\t\treturn;\n\t\t *\n\t\t *\t\t\t// Cancel edit event to prevent automatic widget insertion.\n\t\t *\t\t\tevt.cancel();\n\t\t *\n\t\t *\t\t\tCustomDialog.open( widget.data, function saveCallback( savedData ) {\n\t\t *\t\t\t\t// Cache the container, because widget may be destroyed while saving data,\n\t\t *\t\t\t\t// if this process will require some deep transformations.\n\t\t *\t\t\t\tvar container = widget.wrapper.getParent();\n\t\t *\n\t\t *\t\t\t\twidget.setData( savedData );\n\t\t *\n\t\t *\t\t\t\t// Widget will be retrieved from container and inserted into editor.\n\t\t *\t\t\t\teditor.widgets.finalizeCreation( container );\n\t\t *\t\t\t} );\n\t\t *\t\t} );\n\t\t *\n\t\t * @param {CKEDITOR.dom.element/CKEDITOR.dom.documentFragment} container The element\n\t\t * or document fragment which contains widget wrapper. The container is used, so before\n\t\t * finalizing creation the widget can be freely transformed (even destroyed and reinitialized).\n\t\t */\n\t\tfinalizeCreation: function( container ) {\n\t\t\tvar wrapper = container.getFirst();\n\t\t\tif ( wrapper && Widget.isDomWidgetWrapper( wrapper ) ) {\n\t\t\t\tthis.editor.insertElement( wrapper );\n\n\t\t\t\tvar widget = this.getByElement( wrapper );\n\t\t\t\t// Fire postponed #ready event.\n\t\t\t\twidget.ready = true;\n\t\t\t\twidget.fire( 'ready' );\n\t\t\t\twidget.focus();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Finds a widget instance which contains a given element. The element will be the {@link CKEDITOR.plugins.widget#wrapper wrapper}\n\t\t * of the returned widget or a descendant of this {@link CKEDITOR.plugins.widget#wrapper wrapper}.\n\t\t *\n\t\t *\t\teditor.widgets.getByElement( someWidget.wrapper ); // -> someWidget\n\t\t *\t\teditor.widgets.getByElement( someWidget.parts.caption ); // -> someWidget\n\t\t *\n\t\t *\t\t// Check wrapper only:\n\t\t *\t\teditor.widgets.getByElement( someWidget.wrapper, true ); // -> someWidget\n\t\t *\t\teditor.widgets.getByElement( someWidget.parts.caption, true ); // -> null\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element The element to be checked.\n\t\t * @param {Boolean} [checkWrapperOnly] If set to `true`, the method will not check wrappers' descendants.\n\t\t * @returns {CKEDITOR.plugins.widget} The widget instance or `null`.\n\t\t */\n\t\tgetByElement: ( function() {\n\t\t\tvar validWrapperElements = { div: 1, span: 1 };\n\t\t\tfunction getWidgetId( element ) {\n\t\t\t\treturn element.is( validWrapperElements ) && element.data( 'cke-widget-id' );\n\t\t\t}\n\n\t\t\treturn function( element, checkWrapperOnly ) {\n\t\t\t\tif ( !element )\n\t\t\t\t\treturn null;\n\n\t\t\t\tvar id = getWidgetId( element );\n\n\t\t\t\t// There's no need to check element parents if element is a wrapper.\n\t\t\t\tif ( !checkWrapperOnly && !id ) {\n\t\t\t\t\tvar limit = this.editor.editable();\n\n\t\t\t\t\t// Try to find a closest ascendant which is a widget wrapper.\n\t\t\t\t\tdo {\n\t\t\t\t\t\telement = element.getParent();\n\t\t\t\t\t} while ( element && !element.equals( limit ) && !( id = getWidgetId( element ) ) );\n\t\t\t\t}\n\n\t\t\t\treturn this.instances[ id ] || null;\n\t\t\t};\n\t\t} )(),\n\n\t\t/**\n\t\t * Initializes a widget on a given element if the widget has not been initialized on it yet.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} element The future widget element.\n\t\t * @param {String/CKEDITOR.plugins.widget.definition} [widgetDef] Name of a widget or a widget definition.\n\t\t * The widget definition should be previously registered by using the\n\t\t * {@link CKEDITOR.plugins.widget.repository#add} method.\n\t\t * @param [startupData] Widget startup data (has precedence over default one).\n\t\t * @returns {CKEDITOR.plugins.widget} The widget instance or `null` if a widget could not be initialized on\n\t\t * a given element.\n\t\t */\n\t\tinitOn: function( element, widgetDef, startupData ) {\n\t\t\tif ( !widgetDef )\n\t\t\t\twidgetDef = this.registered[ element.data( 'widget' ) ];\n\t\t\telse if ( typeof widgetDef == 'string' )\n\t\t\t\twidgetDef = this.registered[ widgetDef ];\n\n\t\t\tif ( !widgetDef )\n\t\t\t\treturn null;\n\n\t\t\t// Wrap element if still wasn't wrapped (was added during runtime by method that skips dataProcessor).\n\t\t\tvar wrapper = this.wrapElement( element, widgetDef.name );\n\n\t\t\tif ( wrapper ) {\n\t\t\t\t// Check if widget wrapper is new (widget hasn't been initialized on it yet).\n\t\t\t\t// This class will be removed by widget constructor to avoid locking snapshot twice.\n\t\t\t\tif ( wrapper.hasClass( 'cke_widget_new' ) ) {\n\t\t\t\t\tvar widget = new Widget( this, this._.nextId++, element, widgetDef, startupData );\n\n\t\t\t\t\t// Widget could be destroyed when initializing it.\n\t\t\t\t\tif ( widget.isInited() ) {\n\t\t\t\t\t\tthis.instances[ widget.id ] = widget;\n\n\t\t\t\t\t\treturn widget;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Widget already has been initialized, so try to get widget by element.\n\t\t\t\t// Note - it may happen that other instance will returned than the one created above,\n\t\t\t\t// if for example widget was destroyed and reinitialized.\n\t\t\t\treturn this.getByElement( element );\n\t\t\t}\n\n\t\t\t// No wrapper means that there's no widget for this element.\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Initializes widgets on all elements which were wrapped by {@link #wrapElement} and\n\t\t * have not been initialized yet.\n\t\t *\n\t\t * @param {CKEDITOR.dom.element} [container=editor.editable()] The container which will be checked for not\n\t\t * initialized widgets. Defaults to editor's {@link CKEDITOR.editor#editable editable} element.\n\t\t * @returns {CKEDITOR.plugins.widget[]} Array of widget instances which have been initialized.\n\t\t * Note: Only first-level widgets are returned &mdash; without nested widgets.\n\t\t */\n\t\tinitOnAll: function( container ) {\n\t\t\tvar newWidgets = ( container || this.editor.editable() ).find( '.cke_widget_new' ),\n\t\t\t\tnewInstances = [],\n\t\t\t\tinstance;\n\n\t\t\tfor ( var i = newWidgets.count(); i--; ) {\n\t\t\t\tinstance = this.initOn( newWidgets.getItem( i ).getFirst( Widget.isDomWidgetElement ) );\n\t\t\t\tif ( instance )\n\t\t\t\t\tnewInstances.push( instance );\n\t\t\t}\n\n\t\t\treturn newInstances;\n\t\t},\n\n\t\t/**\n\t\t * Allows to listen to events on specific types of widgets, even if they are not created yet.\n\t\t *\n\t\t * Please note that this method inherits parameters from the {@link CKEDITOR.event#method-on} method with one\n\t\t * extra parameter at the beginning which is the widget name.\n\t\t *\n\t\t *\t\teditor.widgets.onWidget( 'image', 'action', function( evt ) {\n\t\t *\t\t\t// Event `action` occurs on `image` widget.\n\t\t *\t\t} );\n\t\t *\n\t\t * @since 4.5\n\t\t * @param {String} widgetName\n\t\t * @param {String} eventName\n\t\t * @param {Function} listenerFunction\n\t\t * @param {Object} [scopeObj]\n\t\t * @param {Object} [listenerData]\n\t\t * @param {Number} [priority=10]\n\t\t */\n\t\tonWidget: function( widgetName ) {\n\t\t\tvar args = Array.prototype.slice.call( arguments );\n\n\t\t\targs.shift();\n\n\t\t\tfor ( var i in this.instances ) {\n\t\t\t\tvar instance = this.instances[ i ];\n\n\t\t\t\tif ( instance.name == widgetName ) {\n\t\t\t\t\tinstance.on.apply( instance, args );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.on( 'instanceCreated', function( evt ) {\n\t\t\t\tvar widget = evt.data;\n\n\t\t\t\tif ( widget.name == widgetName ) {\n\t\t\t\t\twidget.on.apply( widget, args );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Parses element classes string and returns an object\n\t\t * whose keys contain class names. Skips all `cke_*` classes.\n\t\t *\n\t\t * This method is used by the {@link CKEDITOR.plugins.widget#getClasses} method and\n\t\t * may be used when overriding that method.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {String} classes String (value of `class` attribute).\n\t\t * @returns {Object} Object containing classes or `null` if no classes found.\n\t\t */\n\t\tparseElementClasses: function( classes ) {\n\t\t\tif ( !classes )\n\t\t\t\treturn null;\n\n\t\t\tclasses = CKEDITOR.tools.trim( classes ).split( /\\s+/ );\n\n\t\t\tvar cl,\n\t\t\t\tobj = {},\n\t\t\t\thasClasses = 0;\n\n\t\t\twhile ( ( cl = classes.pop() ) ) {\n\t\t\t\tif ( cl.indexOf( 'cke_' ) == -1 )\n\t\t\t\t\tobj[ cl ] = hasClasses = 1;\n\t\t\t}\n\n\t\t\treturn hasClasses ? obj : null;\n\t\t},\n\n\t\t/**\n\t\t * Wraps an element with a widget's non-editable container.\n\t\t *\n\t\t * If this method is called on an {@link CKEDITOR.htmlParser.element}, then it will\n\t\t * also take care of fixing the DOM after wrapping (the wrapper may not be allowed in element's parent).\n\t\t *\n\t\t * @param {CKEDITOR.dom.element/CKEDITOR.htmlParser.element} element The widget element to be wrapped.\n\t\t * @param {String} [widgetName] The name of the widget definition. Defaults to element's `data-widget`\n\t\t * attribute value.\n\t\t * @returns {CKEDITOR.dom.element/CKEDITOR.htmlParser.element} The wrapper element or `null` if\n\t\t * the widget definition of this name is not registered.\n\t\t */\n\t\twrapElement: function( element, widgetName ) {\n\t\t\tvar wrapper = null,\n\t\t\t\twidgetDef,\n\t\t\t\tisInline;\n\n\t\t\tif ( element instanceof CKEDITOR.dom.element ) {\n\t\t\t\twidgetDef = this.registered[ widgetName || element.data( 'widget' ) ];\n\t\t\t\tif ( !widgetDef )\n\t\t\t\t\treturn null;\n\n\t\t\t\t// Do not wrap already wrapped element.\n\t\t\t\twrapper = element.getParent();\n\t\t\t\tif ( wrapper && wrapper.type == CKEDITOR.NODE_ELEMENT && wrapper.data( 'cke-widget-wrapper' ) )\n\t\t\t\t\treturn wrapper;\n\n\t\t\t\t// If attribute isn't already set (e.g. for pasted widget), set it.\n\t\t\t\tif ( !element.hasAttribute( 'data-cke-widget-keep-attr' ) )\n\t\t\t\t\telement.data( 'cke-widget-keep-attr', element.data( 'widget' ) ? 1 : 0 );\n\t\t\t\tif ( widgetName )\n\t\t\t\t\telement.data( 'widget', widgetName );\n\n\t\t\t\tisInline = isWidgetInline( widgetDef, element.getName() );\n\n\t\t\t\twrapper = new CKEDITOR.dom.element( isInline ? 'span' : 'div' );\n\t\t\t\twrapper.setAttributes( getWrapperAttributes( isInline ) );\n\n\t\t\t\twrapper.data( 'cke-display-name', widgetDef.pathName ? widgetDef.pathName : element.getName() );\n\n\t\t\t\t// Replace element unless it is a detached one.\n\t\t\t\tif ( element.getParent( true ) )\n\t\t\t\t\twrapper.replace( element );\n\t\t\t\telement.appendTo( wrapper );\n\t\t\t}\n\t\t\telse if ( element instanceof CKEDITOR.htmlParser.element ) {\n\t\t\t\twidgetDef = this.registered[ widgetName || element.attributes[ 'data-widget' ] ];\n\t\t\t\tif ( !widgetDef )\n\t\t\t\t\treturn null;\n\n\t\t\t\twrapper = element.parent;\n\t\t\t\tif ( wrapper && wrapper.type == CKEDITOR.NODE_ELEMENT && wrapper.attributes[ 'data-cke-widget-wrapper' ] )\n\t\t\t\t\treturn wrapper;\n\n\t\t\t\t// If attribute isn't already set (e.g. for pasted widget), set it.\n\t\t\t\tif ( !( 'data-cke-widget-keep-attr' in element.attributes ) )\n\t\t\t\t\telement.attributes[ 'data-cke-widget-keep-attr' ] = element.attributes[ 'data-widget' ] ? 1 : 0;\n\t\t\t\tif ( widgetName )\n\t\t\t\t\telement.attributes[ 'data-widget' ] = widgetName;\n\n\t\t\t\tisInline = isWidgetInline( widgetDef, element.name );\n\n\t\t\t\twrapper = new CKEDITOR.htmlParser.element( isInline ? 'span' : 'div', getWrapperAttributes( isInline ) );\n\n\t\t\t\twrapper.attributes[ 'data-cke-display-name' ] = widgetDef.pathName ? widgetDef.pathName : element.name;\n\n\t\t\t\tvar parent = element.parent,\n\t\t\t\t\tindex;\n\n\t\t\t\t// Don't detach already detached element.\n\t\t\t\tif ( parent ) {\n\t\t\t\t\tindex = element.getIndex();\n\t\t\t\t\telement.remove();\n\t\t\t\t}\n\n\t\t\t\twrapper.add( element );\n\n\t\t\t\t// Insert wrapper fixing DOM (splitting parents if wrapper is not allowed inside them).\n\t\t\t\tparent && insertElement( parent, index, wrapper );\n\t\t\t}\n\n\t\t\treturn wrapper;\n\t\t},\n\n\t\t// Expose for tests.\n\t\t_tests_createEditableFilter: createEditableFilter\n\t};\n\n\tCKEDITOR.event.implementOn( Repository.prototype );\n\n\t/**\n\t * An event fired when a widget instance is created, but before it is fully initialized.\n\t *\n\t * @event instanceCreated\n\t * @param {CKEDITOR.plugins.widget} data The widget instance.\n\t */\n\n\t/**\n\t * An event fired when a widget instance was destroyed.\n\t *\n\t * See also {@link CKEDITOR.plugins.widget#event-destroy}.\n\t *\n\t * @event instanceDestroyed\n\t * @param {CKEDITOR.plugins.widget} data The widget instance.\n\t */\n\n\t/**\n\t * An event fired to trigger the selection check.\n\t *\n\t * See the {@link #method-checkSelection} method.\n\t *\n\t * @event checkSelection\n\t */\n\n\t/**\n\t * An event fired by the the {@link #method-checkWidgets} method.\n\t *\n\t * It can be canceled in order to stop the {@link #method-checkWidgets}\n\t * method execution or the event listener can modify the method's options.\n\t *\n\t * @event checkWidgets\n\t * @param [data]\n\t * @param {Boolean} [data.initOnlyNew] Initialize widgets only on newly wrapped\n\t * widget elements (those which still have the `cke_widget_new` class). When this option is\n\t * set to `true`, widgets which were invalidated (e.g. by replacing with a cloned DOM structure)\n\t * will not be reinitialized. This makes the check faster.\n\t * @param {Boolean} [data.focusInited] If only one widget is initialized by\n\t * the method, it will be focused.\n\t */\n\n\n\t/**\n\t * An instance of a widget. Together with {@link CKEDITOR.plugins.widget.repository} these\n\t * two classes constitute the core of the Widget System.\n\t *\n\t * Note that neither the repository nor the widget instances can be created by using their constructors.\n\t * A repository instance is automatically set up by the Widget plugin and is accessible under\n\t * {@link CKEDITOR.editor#widgets}, while widget instances are created and destroyed by the repository.\n\t *\n\t * To create a widget, first you need to {@link CKEDITOR.plugins.widget.repository#add register} its\n\t * {@link CKEDITOR.plugins.widget.definition definition}:\n\t *\n\t *\t\teditor.widgets.add( 'simplebox', {\n\t *\t\t\tupcast: function( element ) {\n\t *\t\t\t\t// Defines which elements will become widgets.\n\t *\t\t\t\tif ( element.hasClass( 'simplebox' ) )\n\t *\t\t\t\t\treturn true;\n\t *\t\t\t},\n\t *\t\t\tinit: function() {\n\t *\t\t\t\t// ...\n\t *\t\t\t}\n\t *\t\t} );\n\t *\n\t * Once the widget definition is registered, widgets will be automatically\n\t * created when loading data:\n\t *\n\t *\t\teditor.setData( '<div class=\"simplebox\">foo</div>', function() {\n\t *\t\t\tconsole.log( editor.widgets.instances ); // -> An object containing one instance.\n\t *\t\t} );\n\t *\n\t * It is also possible to create instances during runtime by using a command\n\t * (if a {@link CKEDITOR.plugins.widget.definition#template} property was defined):\n\t *\n\t *\t\t// You can execute an automatically defined command to\n\t *\t\t// insert a new simplebox widget or edit the one currently focused.\n\t *\t\teditor.execCommand( 'simplebox' );\n\t *\n\t * Note: Since CKEditor 4.5 widget's `startupData` can be passed as the command argument:\n\t *\n\t *\t\teditor.execCommand( 'simplebox', {\n\t *\t\t\tstartupData: {\n\t *\t\t\t\talign: 'left'\n\t *\t\t\t}\n\t *\t\t} );\n\t *\n\t * A widget can also be created in a completely custom way:\n\t *\n\t *\t\tvar element = editor.document.createElement( 'div' );\n\t *\t\teditor.insertElement( element );\n\t *\t\tvar widget = editor.widgets.initOn( element, 'simplebox' );\n\t *\n\t * @since 4.3\n\t * @class CKEDITOR.plugins.widget\n\t * @mixins CKEDITOR.event\n\t * @extends CKEDITOR.plugins.widget.definition\n\t * @constructor Creates an instance of the widget class. Do not use it directly, but instead initialize widgets\n\t * by using the {@link CKEDITOR.plugins.widget.repository#initOn} method or by the upcasting system.\n\t * @param {CKEDITOR.plugins.widget.repository} widgetsRepo\n\t * @param {Number} id Unique ID of this widget instance.\n\t * @param {CKEDITOR.dom.element} element The widget element.\n\t * @param {CKEDITOR.plugins.widget.definition} widgetDef Widget's registered definition.\n\t * @param [startupData] Initial widget data. This data object will overwrite the default data and\n\t * the data loaded from the DOM.\n\t */\n\tfunction Widget( widgetsRepo, id, element, widgetDef, startupData ) {\n\t\tvar editor = widgetsRepo.editor;\n\n\t\t// Extend this widget with widgetDef-specific methods and properties.\n\t\tCKEDITOR.tools.extend( this, widgetDef, {\n\t\t\t/**\n\t\t\t * The editor instance.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {CKEDITOR.editor}\n\t\t\t */\n\t\t\teditor: editor,\n\n\t\t\t/**\n\t\t\t * This widget's unique (per editor instance) ID.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {Number}\n\t\t\t */\n\t\t\tid: id,\n\n\t\t\t/**\n\t\t\t * Whether this widget is an inline widget (based on an inline element unless\n\t\t\t * forced otherwise by {@link CKEDITOR.plugins.widget.definition#inline}).\n\t\t\t *\n\t\t\t * **Note:** This option does not allow to turn a block element into an inline widget.\n\t\t\t * However, it makes it possible to turn an inline element into a block widget or to\n\t\t\t * force a correct type in case when automatic recognition fails.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {Boolean}\n\t\t\t */\n\t\t\tinline: element.getParent().getName() == 'span',\n\n\t\t\t/**\n\t\t\t * The widget element &mdash; the element on which the widget was initialized.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {CKEDITOR.dom.element} element\n\t\t\t */\n\t\t\telement: element,\n\n\t\t\t/**\n\t\t\t * Widget's data object.\n\t\t\t *\n\t\t\t * The data can only be set by using the {@link #setData} method.\n\t\t\t * Changes made to the data fire the {@link #event-data} event.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tdata: CKEDITOR.tools.extend( {}, typeof widgetDef.defaults == 'function' ? widgetDef.defaults() : widgetDef.defaults ),\n\n\t\t\t/**\n\t\t\t * Indicates if a widget is data-ready. Set to `true` when data from all sources\n\t\t\t * ({@link CKEDITOR.plugins.widget.definition#defaults}, set in the\n\t\t\t * {@link #init} method, loaded from the widget's element and startup data coming from the constructor)\n\t\t\t * are finally loaded. This is immediately followed by the first {@link #event-data}.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tdataReady: false,\n\n\t\t\t/**\n\t\t\t * Whether a widget instance was initialized. This means that:\n\t\t\t *\n\t\t\t * * An instance was created,\n\t\t\t * * Its properties were set,\n\t\t\t * * The `init` method was executed.\n\t\t\t *\n\t\t\t * **Note**: The first {@link #event-data} event could not be fired yet which\n\t\t\t * means that the widget's DOM has not been set up yet. Wait for the {@link #event-ready}\n\t\t\t * event to be notified when a widget is fully initialized and ready.\n\t\t\t *\n\t\t\t * **Note**: Use the {@link #isInited} method to check whether a widget is initialized and\n\t\t\t * has not been destroyed.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tinited: false,\n\n\t\t\t/**\n\t\t\t * Whether a widget instance is ready. This means that the widget is {@link #inited} and\n\t\t\t * that its DOM was finally set up.\n\t\t\t *\n\t\t\t * **Note:** Use the {@link #isReady} method to check whether a widget is ready and\n\t\t\t * has not been destroyed.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t */\n\t\t\tready: false,\n\n\t\t\t// Revert what widgetDef could override (automatic #edit listener).\n\t\t\tedit: Widget.prototype.edit,\n\n\t\t\t/**\n\t\t\t * The nested editable element which is currently focused.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {CKEDITOR.plugins.widget.nestedEditable}\n\t\t\t */\n\t\t\tfocusedEditable: null,\n\n\t\t\t/**\n\t\t\t * The widget definition from which this instance was created.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {CKEDITOR.plugins.widget.definition} definition\n\t\t\t */\n\t\t\tdefinition: widgetDef,\n\n\t\t\t/**\n\t\t\t * Link to the widget repository which created this instance.\n\t\t\t *\n\t\t\t * @readonly\n\t\t\t * @property {CKEDITOR.plugins.widget.repository} repository\n\t\t\t */\n\t\t\trepository: widgetsRepo,\n\n\t\t\tdraggable: widgetDef.draggable !== false,\n\n\t\t\t// WAAARNING: Overwrite widgetDef's priv object, because otherwise violent unicorn's gonna visit you.\n\t\t\t_: {\n\t\t\t\tdowncastFn: ( widgetDef.downcast && typeof widgetDef.downcast == 'string' ) ?\n\t\t\t\t\twidgetDef.downcasts[ widgetDef.downcast ] : widgetDef.downcast\n\t\t\t}\n\t\t}, true );\n\n\t\t/**\n\t\t * An object of widget component elements.\n\t\t *\n\t\t * For every `partName => selector` pair in {@link CKEDITOR.plugins.widget.definition#parts},\n\t\t * one `partName => element` pair is added to this object during the widget initialization.\n\t\t *\n\t\t * @readonly\n\t\t * @property {Object} parts\n\t\t */\n\n\t\t/**\n\t\t * The template which will be used to create a new widget element (when the widget's command is executed).\n\t\t * It will be populated with {@link #defaults default values}.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.template} template\n\t\t */\n\n\t\t/**\n\t\t * The widget wrapper &mdash; a non-editable `div` or `span` element (depending on {@link #inline})\n\t\t * which is a parent of the {@link #element} and widget compontents like the drag handler and the {@link #mask}.\n\t\t * It is the outermost widget element.\n\t\t *\n\t\t * @readonly\n\t\t * @property {CKEDITOR.dom.element} wrapper\n\t\t */\n\n\t\twidgetsRepo.fire( 'instanceCreated', this );\n\n\t\tsetupWidget( this, widgetDef );\n\n\t\tthis.init && this.init();\n\n\t\t// Finally mark widget as inited.\n\t\tthis.inited = true;\n\n\t\tsetupWidgetData( this, startupData );\n\n\t\t// If at some point (e.g. in #data listener) widget hasn't been destroyed\n\t\t// and widget is already attached to document then fire #ready.\n\t\tif ( this.isInited() && editor.editable().contains( this.wrapper ) ) {\n\t\t\tthis.ready = true;\n\t\t\tthis.fire( 'ready' );\n\t\t}\n\t}\n\n\tWidget.prototype = {\n\t\t/**\n\t\t * Adds a class to the widget element. This method is used by\n\t\t * the {@link #applyStyle} method and should be overriden by widgets\n\t\t * which should handle classes differently (e.g. add them to other elements).\n\t\t *\n\t\t * **Note**: This method should not be used directly. Use the {@link #setData} method to\n\t\t * set the `classes` property. Read more in the {@link #setData} documentation.\n\t\t *\n\t\t * See also: {@link #removeClass}, {@link #hasClass}, {@link #getClasses}.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {String} className The class name to be added.\n\t\t */\n\t\taddClass: function( className ) {\n\t\t\tthis.element.addClass( className );\n\t\t},\n\n\t\t/**\n\t\t * Applies the specified style to the widget. It is highly recommended to use the\n\t\t * {@link CKEDITOR.editor#applyStyle} or {@link CKEDITOR.style#apply} methods instead of\n\t\t * using this method directly, because unlike editor's and style's methods, this one\n\t\t * does not perform any checks.\n\t\t *\n\t\t * By default this method handles only classes defined in the style. It clones existing\n\t\t * classes which are stored in the {@link #property-data widget data}'s `classes` property,\n\t\t * adds new classes, and calls the {@link #setData} method if at least one new class was added.\n\t\t * Then, using the {@link #event-data} event listener widget applies modifications passing\n\t\t * new classes to the {@link #addClass} method.\n\t\t *\n\t\t * If you need to handle classes differently than in the default way, you can override the\n\t\t * {@link #addClass} and related methods. You can also handle other style properties than `classes`\n\t\t * by overriding this method.\n\t\t *\n\t\t * See also: {@link #checkStyleActive}, {@link #removeStyle}.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {CKEDITOR.style} style The custom widget style to be applied.\n\t\t */\n\t\tapplyStyle: function( style ) {\n\t\t\tapplyRemoveStyle( this, style, 1 );\n\t\t},\n\n\t\t/**\n\t\t * Checks if the specified style is applied to this widget. It is highly recommended to use the\n\t\t * {@link CKEDITOR.style#checkActive} method instead of using this method directly,\n\t\t * because unlike style's method, this one does not perform any checks.\n\t\t *\n\t\t * By default this method handles only classes defined in the style and passes\n\t\t * them to the {@link #hasClass} method. You can override these methods to handle classes\n\t\t * differently or to handle more of the style properties.\n\t\t *\n\t\t * See also: {@link #applyStyle}, {@link #removeStyle}.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {CKEDITOR.style} style The custom widget style to be checked.\n\t\t * @returns {Boolean} Whether the style is applied to this widget.\n\t\t */\n\t\tcheckStyleActive: function( style ) {\n\t\t\tvar classes = getStyleClasses( style ),\n\t\t\t\tcl;\n\n\t\t\tif ( !classes )\n\t\t\t\treturn false;\n\n\t\t\twhile ( ( cl = classes.pop() ) ) {\n\t\t\t\tif ( !this.hasClass( cl ) )\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Destroys this widget instance.\n\t\t *\n\t\t * Use {@link CKEDITOR.plugins.widget.repository#destroy} when possible instead of this method.\n\t\t *\n\t\t * This method fires the {#event-destroy} event.\n\t\t *\n\t\t * @param {Boolean} [offline] Whether a widget is offline (detached from the DOM tree) &mdash;\n\t\t * in this case the DOM (attributes, classes, etc.) will not be cleaned up.\n\t\t */\n\t\tdestroy: function( offline ) {\n\t\t\tthis.fire( 'destroy' );\n\n\t\t\tif ( this.editables ) {\n\t\t\t\tfor ( var name in this.editables )\n\t\t\t\t\tthis.destroyEditable( name, offline );\n\t\t\t}\n\n\t\t\tif ( !offline ) {\n\t\t\t\tif ( this.element.data( 'cke-widget-keep-attr' ) == '0' )\n\t\t\t\t\tthis.element.removeAttribute( 'data-widget' );\n\t\t\t\tthis.element.removeAttributes( [ 'data-cke-widget-data', 'data-cke-widget-keep-attr' ] );\n\t\t\t\tthis.element.removeClass( 'cke_widget_element' );\n\t\t\t\tthis.element.replace( this.wrapper );\n\t\t\t}\n\n\t\t\tthis.wrapper = null;\n\t\t},\n\n\t\t/**\n\t\t * Destroys a nested editable and all nested widgets.\n\t\t *\n\t\t * @param {String} editableName Nested editable name.\n\t\t * @param {Boolean} [offline] See {@link #method-destroy} method.\n\t\t */\n\t\tdestroyEditable: function( editableName, offline ) {\n\t\t\tvar editable = this.editables[ editableName ];\n\n\t\t\teditable.removeListener( 'focus', onEditableFocus );\n\t\t\teditable.removeListener( 'blur', onEditableBlur );\n\t\t\tthis.editor.focusManager.remove( editable );\n\n\t\t\tif ( !offline ) {\n\t\t\t\tthis.repository.destroyAll( false, editable );\n\t\t\t\teditable.removeClass( 'cke_widget_editable' );\n\t\t\t\teditable.removeClass( 'cke_widget_editable_focused' );\n\t\t\t\teditable.removeAttributes( [ 'contenteditable', 'data-cke-widget-editable', 'data-cke-enter-mode' ] );\n\t\t\t}\n\n\t\t\tdelete this.editables[ editableName ];\n\t\t},\n\n\t\t/**\n\t\t * Starts widget editing.\n\t\t *\n\t\t * This method fires the {@link CKEDITOR.plugins.widget#event-edit} event\n\t\t * which may be canceled in order to prevent it from opening a dialog window.\n\t\t *\n\t\t * The dialog window name is obtained from the event's data `dialog` property or\n\t\t * from {@link CKEDITOR.plugins.widget.definition#dialog}.\n\t\t *\n\t\t * @returns {Boolean} Returns `true` if a dialog window was opened.\n\t\t */\n\t\tedit: function() {\n\t\t\tvar evtData = { dialog: this.dialog },\n\t\t\t\tthat = this;\n\n\t\t\t// Edit event was blocked or there's no dialog to be automatically opened.\n\t\t\tif ( this.fire( 'edit', evtData ) === false || !evtData.dialog )\n\t\t\t\treturn false;\n\n\t\t\tthis.editor.openDialog( evtData.dialog, function( dialog ) {\n\t\t\t\tvar showListener,\n\t\t\t\t\tokListener;\n\n\t\t\t\t// Allow to add a custom dialog handler.\n\t\t\t\tif ( that.fire( 'dialog', dialog ) === false )\n\t\t\t\t\treturn;\n\n\t\t\t\tshowListener = dialog.on( 'show', function() {\n\t\t\t\t\tdialog.setupContent( that );\n\t\t\t\t} );\n\n\t\t\t\tokListener = dialog.on( 'ok', function() {\n\t\t\t\t\t// Commit dialog's fields, but prevent from\n\t\t\t\t\t// firing data event for every field. Fire only one,\n\t\t\t\t\t// bulk event at the end.\n\t\t\t\t\tvar dataChanged,\n\t\t\t\t\t\tdataListener = that.on( 'data', function( evt ) {\n\t\t\t\t\t\t\tdataChanged = 1;\n\t\t\t\t\t\t\tevt.cancel();\n\t\t\t\t\t\t}, null, null, 0 );\n\n\t\t\t\t\t// Create snapshot preceeding snapshot with changed widget...\n\t\t\t\t\t// TODO it should not be required, but it is and I found similar\n\t\t\t\t\t// code in dialog#ok listener in dialog/plugin.js.\n\t\t\t\t\tthat.editor.fire( 'saveSnapshot' );\n\t\t\t\t\tdialog.commitContent( that );\n\n\t\t\t\t\tdataListener.removeListener();\n\t\t\t\t\tif ( dataChanged ) {\n\t\t\t\t\t\tthat.fire( 'data', that.data );\n\t\t\t\t\t\tthat.editor.fire( 'saveSnapshot' );\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tdialog.once( 'hide', function() {\n\t\t\t\t\tshowListener.removeListener();\n\t\t\t\t\tokListener.removeListener();\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * Returns widget element classes parsed to an object. This method\n\t\t * is used to populate the `classes` property of widget's {@link #property-data}.\n\t\t *\n\t\t * This method reuses {@link CKEDITOR.plugins.widget.repository#parseElementClasses}.\n\t\t * It should be overriden if a widget should handle classes differently (e.g. on other elements).\n\t\t *\n\t\t * See also: {@link #removeClass}, {@link #addClass}, {@link #hasClass}.\n\t\t *\n\t\t * @since 4.4\n\t\t * @returns {Object}\n\t\t */\n\t\tgetClasses: function() {\n\t\t\treturn this.repository.parseElementClasses( this.element.getAttribute( 'class' ) );\n\t\t},\n\n\t\t/**\n\t\t * Checks if the widget element has specified class. This method is used by\n\t\t * the {@link #checkStyleActive} method and should be overriden by widgets\n\t\t * which should handle classes differently (e.g. on other elements).\n\t\t *\n\t\t * See also: {@link #removeClass}, {@link #addClass}, {@link #getClasses}.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {String} className The class to be checked.\n\t\t * @param {Boolean} Whether a widget has specified class.\n\t\t */\n\t\thasClass: function( className ) {\n\t\t\treturn this.element.hasClass( className );\n\t\t},\n\n\t\t/**\n\t\t * Initializes a nested editable.\n\t\t *\n\t\t * **Note**: Only elements from {@link CKEDITOR.dtd#$editable} may become editables.\n\t\t *\n\t\t * @param {String} editableName The nested editable name.\n\t\t * @param {CKEDITOR.plugins.widget.nestedEditable.definition} definition The definition of the nested editable.\n\t\t * @returns {Boolean} Whether an editable was successfully initialized.\n\t\t */\n\t\tinitEditable: function( editableName, definition ) {\n\t\t\t// Don't fetch just first element which matched selector but look for a correct one. (#13334)\n\t\t\tvar editable = this._findOneNotNested( definition.selector );\n\n\t\t\tif ( editable && editable.is( CKEDITOR.dtd.$editable ) ) {\n\t\t\t\teditable = new NestedEditable( this.editor, editable, {\n\t\t\t\t\tfilter: createEditableFilter.call( this.repository, this.name, editableName, definition )\n\t\t\t\t} );\n\t\t\t\tthis.editables[ editableName ] = editable;\n\n\t\t\t\teditable.setAttributes( {\n\t\t\t\t\tcontenteditable: 'true',\n\t\t\t\t\t'data-cke-widget-editable': editableName,\n\t\t\t\t\t'data-cke-enter-mode': editable.enterMode\n\t\t\t\t} );\n\n\t\t\t\tif ( editable.filter )\n\t\t\t\t\teditable.data( 'cke-filter', editable.filter.id );\n\n\t\t\t\teditable.addClass( 'cke_widget_editable' );\n\t\t\t\t// This class may be left when d&ding widget which\n\t\t\t\t// had focused editable. Clean this class here, not in\n\t\t\t\t// cleanUpWidgetElement for performance and code size reasons.\n\t\t\t\teditable.removeClass( 'cke_widget_editable_focused' );\n\n\t\t\t\tif ( definition.pathName )\n\t\t\t\t\teditable.data( 'cke-display-name', definition.pathName );\n\n\t\t\t\tthis.editor.focusManager.add( editable );\n\t\t\t\teditable.on( 'focus', onEditableFocus, this );\n\t\t\t\tCKEDITOR.env.ie && editable.on( 'blur', onEditableBlur, this );\n\n\t\t\t\t// Finally, process editable's data. This data wasn't processed when loading\n\t\t\t\t// editor's data, becuase they need to be processed separately, with its own filters and settings.\n\t\t\t\teditable._.initialSetData = true;\n\t\t\t\teditable.setData( editable.getHtml() );\n\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\t/**\n\t\t * Looks inside wrapper element to find a node that\n\t\t * matches given selector and is not nested in other widget. (#13334)\n\t\t *\n\t\t * @since 4.5\n\t\t * @private\n\t\t * @param {String} selector Selector to match.\n\t\t * @returns {CKEDITOR.dom.element} Matched element or `null` if a node has not been found.\n\t\t */\n\t\t_findOneNotNested: function( selector ) {\n\t\t\tvar matchedElements = this.wrapper.find( selector ),\n\t\t\t\tmatch,\n\t\t\t\tclosestWrapper;\n\n\t\t\tfor ( var i = 0; i < matchedElements.count(); i++ ) {\n\t\t\t\tmatch = matchedElements.getItem( i );\n\t\t\t\tclosestWrapper = match.getAscendant( Widget.isDomWidgetWrapper );\n\n\t\t\t\t// The closest ascendant-wrapper of this match defines to which widget\n\t\t\t\t// this match belongs. If the ascendant is this widget's wrapper\n\t\t\t\t// it means that the match is not nested in other widget.\n\t\t\t\tif ( this.wrapper.equals( closestWrapper ) ) {\n\t\t\t\t\treturn match;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\t/**\n\t\t * Checks if a widget has already been initialized and has not been destroyed yet.\n\t\t *\n\t\t * See {@link #inited} for more details.\n\t\t *\n\t\t * @returns {Boolean}\n\t\t */\n\t\tisInited: function() {\n\t\t\treturn !!( this.wrapper && this.inited );\n\t\t},\n\n\t\t/**\n\t\t * Checks if a widget is ready and has not been destroyed yet.\n\t\t *\n\t\t * See {@link #property-ready} for more details.\n\t\t *\n\t\t * @returns {Boolean}\n\t\t */\n\t\tisReady: function() {\n\t\t\treturn this.isInited() && this.ready;\n\t\t},\n\n\t\t/**\n\t\t * Focuses a widget by selecting it.\n\t\t */\n\t\tfocus: function() {\n\t\t\tvar sel = this.editor.getSelection();\n\n\t\t\t// Fake the selection before focusing editor, to avoid unpreventable viewports scrolling\n\t\t\t// on Webkit/Blink/IE which is done because there's no selection or selection was somewhere else than widget.\n\t\t\tif ( sel ) {\n\t\t\t\tvar isDirty = this.editor.checkDirty();\n\n\t\t\t\tsel.fake( this.wrapper );\n\n\t\t\t\t!isDirty && this.editor.resetDirty();\n\t\t\t}\n\n\t\t\t// Always focus editor (not only when focusManger.hasFocus is false) (because of #10483).\n\t\t\tthis.editor.focus();\n\t\t},\n\n\t\t/**\n\t\t * Removes a class from the widget element. This method is used by\n\t\t * the {@link #removeStyle} method and should be overriden by widgets\n\t\t * which should handle classes differently (e.g. on other elements).\n\t\t *\n\t\t * **Note**: This method should not be used directly. Use the {@link #setData} method to\n\t\t * set the `classes` property. Read more in the {@link #setData} documentation.\n\t\t *\n\t\t * See also: {@link #hasClass}, {@link #addClass}.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {String} className The class to be removed.\n\t\t */\n\t\tremoveClass: function( className ) {\n\t\t\tthis.element.removeClass( className );\n\t\t},\n\n\t\t/**\n\t\t * Removes the specified style from the widget. It is highly recommended to use the\n\t\t * {@link CKEDITOR.editor#removeStyle} or {@link CKEDITOR.style#remove} methods instead of\n\t\t * using this method directly, because unlike editor's and style's methods, this one\n\t\t * does not perform any checks.\n\t\t *\n\t\t * Read more about how applying/removing styles works in the {@link #applyStyle} method documentation.\n\t\t *\n\t\t * See also {@link #checkStyleActive}, {@link #applyStyle}, {@link #getClasses}.\n\t\t *\n\t\t * @since 4.4\n\t\t * @param {CKEDITOR.style} style The custom widget style to be removed.\n\t\t */\n\t\tremoveStyle: function( style ) {\n\t\t\tapplyRemoveStyle( this, style, 0 );\n\t\t},\n\n\t\t/**\n\t\t * Sets widget value(s) in the {@link #property-data} object.\n\t\t * If the given value(s) modifies current ones, the {@link #event-data} event is fired.\n\t\t *\n\t\t *\t\tthis.setData( 'align', 'left' );\n\t\t *\t\tthis.data.align; // -> 'left'\n\t\t *\n\t\t *\t\tthis.setData( { align: 'right', opened: false } );\n\t\t *\t\tthis.data.align; // -> 'right'\n\t\t *\t\tthis.data.opened; // -> false\n\t\t *\n\t\t * Set values are stored in {@link #element}'s attribute (`data-cke-widget-data`),\n\t\t * in a JSON string, therefore {@link #property-data} should contain\n\t\t * only serializable data.\n\t\t *\n\t\t * **Note:** A special data property, `classes`, exists. It contains an object with\n\t\t * classes which were returned by the {@link #getClasses} method during the widget initialization.\n\t\t * This property is then used by the {@link #applyStyle} and {@link #removeStyle} methods.\n\t\t * When it is changed (the reference to object must be changed!), the widget updates its classes by\n\t\t * using the {@link #addClass} and {@link #removeClass} methods.\n\t\t *\n\t\t *\t\t// Adding a new class.\n\t\t *\t\tvar classes = CKEDITOR.tools.clone( widget.data.classes );\n\t\t *\t\tclasses.newClass = 1;\n\t\t *\t\twidget.setData( 'classes', classes );\n\t\t *\n\t\t *\t\t// Removing a class.\n\t\t *\t\tvar classes = CKEDITOR.tools.clone( widget.data.classes );\n\t\t *\t\tdelete classes.newClass;\n\t\t *\t\twidget.setData( 'classes', classes );\n\t\t *\n\t\t * @param {String/Object} keyOrData\n\t\t * @param {Object} value\n\t\t * @chainable\n\t\t */\n\t\tsetData: function( key, value ) {\n\t\t\tvar data = this.data,\n\t\t\t\tmodified = 0;\n\n\t\t\tif ( typeof key == 'string' ) {\n\t\t\t\tif ( data[ key ] !== value ) {\n\t\t\t\t\tdata[ key ] = value;\n\t\t\t\t\tmodified = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tvar newData = key;\n\n\t\t\t\tfor ( key in newData ) {\n\t\t\t\t\tif ( data[ key ] !== newData[ key ] ) {\n\t\t\t\t\t\tmodified = 1;\n\t\t\t\t\t\tdata[ key ] = newData[ key ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Block firing data event and overwriting data element before setupWidgetData is executed.\n\t\t\tif ( modified && this.dataReady ) {\n\t\t\t\twriteDataToElement( this );\n\t\t\t\tthis.fire( 'data', data );\n\t\t\t}\n\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Changes the widget's focus state. This method is executed automatically after\n\t\t * a widget was focused by the {@link #method-focus} method or the selection was moved\n\t\t * out of the widget.\n\t\t *\n\t\t * This is a low-level method which is not integrated with e.g. the undo manager.\n\t\t * Use the {@link #method-focus} method instead.\n\t\t *\n\t\t * @param {Boolean} selected Whether to select or deselect this widget.\n\t\t * @chainable\n\t\t */\n\t\tsetFocused: function( focused ) {\n\t\t\tthis.wrapper[ focused ? 'addClass' : 'removeClass' ]( 'cke_widget_focused' );\n\t\t\tthis.fire( focused ? 'focus' : 'blur' );\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Changes the widget's select state. This method is executed automatically after\n\t\t * a widget was selected by the {@link #method-focus} method or the selection\n\t\t * was moved out of the widget.\n\t\t *\n\t\t * This is a low-level method which is not integrated with e.g. the undo manager.\n\t\t * Use the {@link #method-focus} method instead or simply change the selection.\n\t\t *\n\t\t * @param {Boolean} selected Whether to select or deselect this widget.\n\t\t * @chainable\n\t\t */\n\t\tsetSelected: function( selected ) {\n\t\t\tthis.wrapper[ selected ? 'addClass' : 'removeClass' ]( 'cke_widget_selected' );\n\t\t\tthis.fire(  selected ? 'select' : 'deselect' );\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Repositions drag handler according to the widget's element position. Should be called from events, like mouseover.\n\t\t */\n\t\tupdateDragHandlerPosition: function() {\n\t\t\tvar editor = this.editor,\n\t\t\t\tdomElement = this.element.$,\n\t\t\t\toldPos = this._.dragHandlerOffset,\n\t\t\t\tnewPos = {\n\t\t\t\t\tx: domElement.offsetLeft,\n\t\t\t\t\ty: domElement.offsetTop - DRAG_HANDLER_SIZE\n\t\t\t\t};\n\n\t\t\tif ( oldPos && newPos.x == oldPos.x && newPos.y == oldPos.y )\n\t\t\t\treturn;\n\n\t\t\t// We need to make sure that dirty state is not changed (#11487).\n\t\t\tvar initialDirty = editor.checkDirty();\n\n\t\t\teditor.fire( 'lockSnapshot' );\n\t\t\tthis.dragHandlerContainer.setStyles( {\n\t\t\t\ttop: newPos.y + 'px',\n\t\t\t\tleft: newPos.x + 'px',\n\t\t\t\tdisplay: 'block'\n\t\t\t} );\n\t\t\teditor.fire( 'unlockSnapshot' );\n\t\t\t!initialDirty && editor.resetDirty();\n\n\t\t\tthis._.dragHandlerOffset = newPos;\n\t\t}\n\t};\n\n\tCKEDITOR.event.implementOn( Widget.prototype );\n\n\t/**\n\t * Gets the {@link #isDomNestedEditable nested editable}\n\t * (returned as a {@link CKEDITOR.dom.element}, not as a {@link CKEDITOR.plugins.widget.nestedEditable})\n\t * closest to the `node` or the `node` if it is a nested editable itself.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {CKEDITOR.dom.element} guard Stop ancestor search on this node (usually editor's editable).\n\t * @param {CKEDITOR.dom.node} node Start the search from this node.\n\t * @returns {CKEDITOR.dom.element/null} Element or `null` if not found.\n\t */\n\tWidget.getNestedEditable = function( guard, node ) {\n\t\tif ( !node || node.equals( guard ) )\n\t\t\treturn null;\n\n\t\tif ( Widget.isDomNestedEditable( node ) )\n\t\t\treturn node;\n\n\t\treturn Widget.getNestedEditable( guard, node.getParent() );\n\t};\n\n\t/**\n\t * Checks whether the `node` is a widget's drag handle element.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {CKEDITOR.dom.node} node\n\t * @returns {Boolean}\n\t */\n\tWidget.isDomDragHandler = function( node ) {\n\t\treturn node.type == CKEDITOR.NODE_ELEMENT && node.hasAttribute( 'data-cke-widget-drag-handler' );\n\t};\n\n\t/**\n\t * Checks whether the `node` is a container of the widget's drag handle element.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {CKEDITOR.dom.node} node\n\t * @returns {Boolean}\n\t */\n\tWidget.isDomDragHandlerContainer = function( node ) {\n\t\treturn node.type == CKEDITOR.NODE_ELEMENT && node.hasClass( 'cke_widget_drag_handler_container' );\n\t};\n\n\t/**\n\t * Checks whether the `node` is a {@link CKEDITOR.plugins.widget#editables nested editable}.\n\t * Note that this function only checks whether it is the right element, not whether\n\t * the passed `node` is an instance of {@link CKEDITOR.plugins.widget.nestedEditable}.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {CKEDITOR.dom.node} node\n\t * @returns {Boolean}\n\t */\n\tWidget.isDomNestedEditable = function( node ) {\n\t\treturn node.type == CKEDITOR.NODE_ELEMENT && node.hasAttribute( 'data-cke-widget-editable' );\n\t};\n\n\t/**\n\t * Checks whether the `node` is a {@link CKEDITOR.plugins.widget#element widget element}.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {CKEDITOR.dom.node} node\n\t * @returns {Boolean}\n\t */\n\tWidget.isDomWidgetElement = function( node ) {\n\t\treturn node.type == CKEDITOR.NODE_ELEMENT && node.hasAttribute( 'data-widget' );\n\t};\n\n\t/**\n\t * Checks whether the `node` is a {@link CKEDITOR.plugins.widget#wrapper widget wrapper}.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {CKEDITOR.dom.element} node\n\t * @returns {Boolean}\n\t */\n\tWidget.isDomWidgetWrapper = function( node ) {\n\t\treturn node.type == CKEDITOR.NODE_ELEMENT && node.hasAttribute( 'data-cke-widget-wrapper' );\n\t};\n\n\t/**\n\t * Checks whether the `node` is a {@link CKEDITOR.plugins.widget#element widget element}.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {CKEDITOR.htmlParser.node} node\n\t * @returns {Boolean}\n\t */\n\tWidget.isParserWidgetElement = function( node ) {\n\t\treturn node.type == CKEDITOR.NODE_ELEMENT && !!node.attributes[ 'data-widget' ];\n\t};\n\n\t/**\n\t * Checks whether the `node` is a {@link CKEDITOR.plugins.widget#wrapper widget wrapper}.\n\t *\n\t * @since 4.5\n\t * @static\n\t * @param {CKEDITOR.htmlParser.element} node\n\t * @returns {Boolean}\n\t */\n\tWidget.isParserWidgetWrapper = function( node ) {\n\t\treturn node.type == CKEDITOR.NODE_ELEMENT && !!node.attributes[ 'data-cke-widget-wrapper' ];\n\t};\n\n\t/**\n\t * An event fired when a widget is ready (fully initialized). This event is fired after:\n\t *\n\t * * {@link #init} is called,\n\t * * The first {@link #event-data} event is fired,\n\t * * A widget is attached to the document.\n\t *\n\t * Therefore, in case of widget creation with a command which opens a dialog window, this event\n\t * will be delayed after the dialog window is closed and the widget is finally inserted into the document.\n\t *\n\t * **Note**: If your widget does not use automatic dialog window binding (i.e. you open the dialog window manually)\n\t * or another situation in which the widget wrapper is not attached to document at the time when it is\n\t * initialized occurs, you need to take care of firing {@link #event-ready} yourself.\n\t *\n\t * See also {@link #property-ready} and {@link #property-inited} properties, and\n\t * {@link #isReady} and {@link #isInited} methods.\n\t *\n\t * @event ready\n\t */\n\n\t/**\n\t * An event fired when a widget is about to be destroyed, but before it is\n\t * fully torn down.\n\t *\n\t * @event destroy\n\t */\n\n\t/**\n\t * An event fired when a widget is focused.\n\t *\n\t * Widget can be focused by executing {@link #method-focus}.\n\t *\n\t * @event focus\n\t */\n\n\t/**\n\t * An event fired when a widget is blurred.\n\t *\n\t * @event blur\n\t */\n\n\t/**\n\t * An event fired when a widget is selected.\n\t *\n\t * @event select\n\t */\n\n\t/**\n\t * An event fired when a widget is deselected.\n\t *\n\t * @event deselect\n\t */\n\n\t/**\n\t * An event fired by the {@link #method-edit} method. It can be canceled\n\t * in order to stop the default action (opening a dialog window and/or\n\t * {@link CKEDITOR.plugins.widget.repository#finalizeCreation finalizing widget creation}).\n\t *\n\t * @event edit\n\t * @param data\n\t * @param {String} data.dialog Defaults to {@link CKEDITOR.plugins.widget.definition#dialog}\n\t * and can be changed or set by the listener.\n\t */\n\n\t/**\n\t * An event fired when a dialog window for widget editing is opened.\n\t * This event can be canceled in order to handle the editing dialog in a custom manner.\n\t *\n\t * @event dialog\n\t * @param {CKEDITOR.dialog} data The opened dialog window instance.\n\t */\n\n\t/**\n\t * An event fired when a key is pressed on a focused widget.\n\t * This event is forwarded from the {@link CKEDITOR.editor#key} event and\n\t * has the ability to block editor keystrokes if it is canceled.\n\t *\n\t * @event key\n\t * @param data\n\t * @param {Number} data.keyCode A number representing the key code (or combination).\n\t */\n\n\t/**\n\t * An event fired when a widget is double clicked.\n\t *\n\t * **Note:** If a default editing action is executed on double click (i.e. a widget has a\n\t * {@link CKEDITOR.plugins.widget.definition#dialog dialog} defined and the {@link #event-doubleclick} event was not\n\t * canceled), this event will be automatically canceled, so a listener added with the default priority (10)\n\t * will not be executed. Use a listener with low priority (e.g. 5) to be sure that it will be executed.\n\t *\n\t *\t\twidget.on( 'doubleclick', function( evt ) {\n\t *\t\t\tconsole.log( 'widget#doubleclick' );\n\t *\t\t}, null, null, 5 );\n\t *\n\t * If your widget handles double click in a special way (so the default editing action is not executed),\n\t * make sure you cancel this event, because otherwise it will be propagated to {@link CKEDITOR.editor#doubleclick}\n\t * and another feature may step in (e.g. a Link dialog window may be opened if your widget was inside a link).\n\t *\n\t * @event doubleclick\n\t * @param data\n\t * @param {CKEDITOR.dom.element} data.element The double-clicked element.\n\t */\n\n\t/**\n\t * An event fired when the context menu is opened for a widget.\n\t *\n\t * @event contextMenu\n\t * @param data The object containing context menu options to be added\n\t * for this widget. See {@link CKEDITOR.plugins.contextMenu#addListener}.\n\t */\n\n\t/**\n\t * An event fired when the widget data changed. See the {@link #setData} method and the {@link #property-data} property.\n\t *\n\t * @event data\n\t */\n\n\n\n\t/**\n\t * The wrapper class for editable elements inside widgets.\n\t *\n\t * Do not use directly. Use {@link CKEDITOR.plugins.widget.definition#editables} or\n\t * {@link CKEDITOR.plugins.widget#initEditable}.\n\t *\n\t * @class CKEDITOR.plugins.widget.nestedEditable\n\t * @extends CKEDITOR.dom.element\n\t * @constructor\n\t * @param {CKEDITOR.editor} editor\n\t * @param {CKEDITOR.dom.element} element\n\t * @param config\n\t * @param {CKEDITOR.filter} [config.filter]\n\t */\n\tfunction NestedEditable( editor, element, config ) {\n\t\t// Call the base constructor.\n\t\tCKEDITOR.dom.element.call( this, element.$ );\n\t\tthis.editor = editor;\n\t\tthis._ = {};\n\t\tvar filter = this.filter = config.filter;\n\n\t\t// If blockless editable - always use BR mode.\n\t\tif ( !CKEDITOR.dtd[ this.getName() ].p )\n\t\t\tthis.enterMode = this.shiftEnterMode = CKEDITOR.ENTER_BR;\n\t\telse {\n\t\t\tthis.enterMode = filter ? filter.getAllowedEnterMode( editor.enterMode ) : editor.enterMode;\n\t\t\tthis.shiftEnterMode = filter ? filter.getAllowedEnterMode( editor.shiftEnterMode, true ) : editor.shiftEnterMode;\n\t\t}\n\t}\n\n\tNestedEditable.prototype = CKEDITOR.tools.extend( CKEDITOR.tools.prototypedCopy( CKEDITOR.dom.element.prototype ), {\n\t\t/**\n\t\t * Sets the editable data. The data will be passed through the {@link CKEDITOR.editor#dataProcessor}\n\t\t * and the {@link CKEDITOR.editor#filter}. This ensures that the data was filtered and prepared to be\n\t\t * edited like the {@link CKEDITOR.editor#method-setData editor data}.\n\t\t *\n\t\t * Before content is changed, all nested widgets are destroyed. Afterwards, after new content is loaded,\n\t\t * all nested widgets are initialized.\n\t\t *\n\t\t * @param {String} data\n\t\t */\n\t\tsetData: function( data ) {\n\t\t\t// For performance reasons don't call destroyAll when initializing a nested editable,\n\t\t\t// because there are no widgets inside.\n\t\t\tif ( !this._.initialSetData ) {\n\t\t\t\t// Destroy all nested widgets before setting data.\n\t\t\t\tthis.editor.widgets.destroyAll( false, this );\n\t\t\t}\n\t\t\tthis._.initialSetData = false;\n\n\t\t\tdata = this.editor.dataProcessor.toHtml( data, {\n\t\t\t\tcontext: this.getName(),\n\t\t\t\tfilter: this.filter,\n\t\t\t\tenterMode: this.enterMode\n\t\t\t} );\n\t\t\tthis.setHtml( data );\n\n\t\t\tthis.editor.widgets.initOnAll( this );\n\t\t},\n\n\t\t/**\n\t\t * Gets the editable data. Like {@link #setData}, this method will process and filter the data.\n\t\t *\n\t\t * @returns {String}\n\t\t */\n\t\tgetData: function() {\n\t\t\treturn this.editor.dataProcessor.toDataFormat( this.getHtml(), {\n\t\t\t\tcontext: this.getName(),\n\t\t\t\tfilter: this.filter,\n\t\t\t\tenterMode: this.enterMode\n\t\t\t} );\n\t\t}\n\t} );\n\n\t/**\n\t * The editor instance.\n\t *\n\t * @readonly\n\t * @property {CKEDITOR.editor} editor\n\t */\n\n\t/**\n\t * The filter instance if allowed content rules were defined.\n\t *\n\t * @readonly\n\t * @property {CKEDITOR.filter} filter\n\t */\n\n\t/**\n\t * The enter mode active in this editable.\n\t * It is determined from editable's name (whether it is a blockless editable),\n\t * its allowed content rules (if defined) and the default editor's mode.\n\t *\n\t * @readonly\n\t * @property {Number} enterMode\n\t */\n\n\t/**\n\t * The shift enter move active in this editable.\n\t *\n\t * @readonly\n\t * @property {Number} shiftEnterMode\n\t */\n\n\n\t//\n\t// REPOSITORY helpers -----------------------------------------------------\n\t//\n\n\tfunction addWidgetButtons( editor ) {\n\t\tvar widgets = editor.widgets.registered,\n\t\t\twidget,\n\t\t\twidgetName,\n\t\t\twidgetButton;\n\n\t\tfor ( widgetName in widgets ) {\n\t\t\twidget = widgets[ widgetName ];\n\n\t\t\t// Create button if defined.\n\t\t\twidgetButton = widget.button;\n\t\t\tif ( widgetButton && editor.ui.addButton ) {\n\t\t\t\teditor.ui.addButton( CKEDITOR.tools.capitalize( widget.name, true ), {\n\t\t\t\t\tlabel: widgetButton,\n\t\t\t\t\tcommand: widget.name,\n\t\t\t\t\ttoolbar: 'insert,10'\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Create a command creating and editing widget.\n\t//\n\t// @param editor\n\t// @param {CKEDITOR.plugins.widget.definition} widgetDef\n\tfunction addWidgetCommand( editor, widgetDef ) {\n\t\teditor.addCommand( widgetDef.name, {\n\t\t\texec: function( editor, commandData ) {\n\t\t\t\tvar focused = editor.widgets.focused;\n\t\t\t\t// If a widget of the same type is focused, start editing.\n\t\t\t\tif ( focused && focused.name == widgetDef.name )\n\t\t\t\t\tfocused.edit();\n\t\t\t\t// Otherwise...\n\t\t\t\t// ... use insert method is was defined.\n\t\t\t\telse if ( widgetDef.insert )\n\t\t\t\t\twidgetDef.insert();\n\t\t\t\t// ... or create a brand-new widget from template.\n\t\t\t\telse if ( widgetDef.template ) {\n\t\t\t\t\tvar defaults = typeof widgetDef.defaults == 'function' ? widgetDef.defaults() : widgetDef.defaults,\n\t\t\t\t\t\telement = CKEDITOR.dom.element.createFromHtml( widgetDef.template.output( defaults ) ),\n\t\t\t\t\t\tinstance,\n\t\t\t\t\t\twrapper = editor.widgets.wrapElement( element, widgetDef.name ),\n\t\t\t\t\t\ttemp = new CKEDITOR.dom.documentFragment( wrapper.getDocument() );\n\n\t\t\t\t\t// Append wrapper to a temporary document. This will unify the environment\n\t\t\t\t\t// in which #data listeners work when creating and editing widget.\n\t\t\t\t\ttemp.append( wrapper );\n\t\t\t\t\tinstance = editor.widgets.initOn( element, widgetDef, commandData && commandData.startupData );\n\n\t\t\t\t\t// Instance could be destroyed during initialization.\n\t\t\t\t\t// In this case finalize creation if some new widget\n\t\t\t\t\t// was left in temporary document fragment.\n\t\t\t\t\tif ( !instance ) {\n\t\t\t\t\t\tfinalizeCreation();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Listen on edit to finalize widget insertion.\n\t\t\t\t\t//\n\t\t\t\t\t// * If dialog was set, then insert widget after dialog was successfully saved or destroy this\n\t\t\t\t\t// temporary instance.\n\t\t\t\t\t// * If dialog wasn't set and edit wasn't canceled, insert widget.\n\t\t\t\t\tvar editListener = instance.once( 'edit', function( evt ) {\n\t\t\t\t\t\tif ( evt.data.dialog ) {\n\t\t\t\t\t\t\tinstance.once( 'dialog', function( evt ) {\n\t\t\t\t\t\t\t\tvar dialog = evt.data,\n\t\t\t\t\t\t\t\t\tokListener,\n\t\t\t\t\t\t\t\t\tcancelListener;\n\n\t\t\t\t\t\t\t\t// Finalize creation AFTER (20) new data was set.\n\t\t\t\t\t\t\t\tokListener = dialog.once( 'ok', finalizeCreation, null, null, 20 );\n\n\t\t\t\t\t\t\t\tcancelListener = dialog.once( 'cancel', function( evt ) {\n\t\t\t\t\t\t\t\t\tif ( !( evt.data && evt.data.hide === false ) ) {\n\t\t\t\t\t\t\t\t\t\teditor.widgets.destroy( instance, true );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\tdialog.once( 'hide', function() {\n\t\t\t\t\t\t\t\t\tokListener.removeListener();\n\t\t\t\t\t\t\t\t\tcancelListener.removeListener();\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Dialog hasn't been set, so insert widget now.\n\t\t\t\t\t\t\tfinalizeCreation();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, null, null, 999 );\n\n\t\t\t\t\tinstance.edit();\n\n\t\t\t\t\t// Remove listener in case someone canceled it before this\n\t\t\t\t\t// listener was executed.\n\t\t\t\t\teditListener.removeListener();\n\t\t\t\t}\n\n\t\t\t\tfunction finalizeCreation() {\n\t\t\t\t\teditor.widgets.finalizeCreation( temp );\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tallowedContent: widgetDef.allowedContent,\n\t\t\trequiredContent: widgetDef.requiredContent,\n\t\t\tcontentForms: widgetDef.contentForms,\n\t\t\tcontentTransformations: widgetDef.contentTransformations\n\t\t} );\n\t}\n\n\tfunction addWidgetProcessors( widgetsRepo, widgetDef ) {\n\t\tvar upcast = widgetDef.upcast,\n\t\t\tupcasts,\n\t\t\tpriority = widgetDef.upcastPriority || 10;\n\n\t\tif ( !upcast )\n\t\t\treturn;\n\n\t\t// Multiple upcasts defined in string.\n\t\tif ( typeof upcast == 'string' ) {\n\t\t\tupcasts = upcast.split( ',' );\n\t\t\twhile ( upcasts.length ) {\n\t\t\t\taddUpcast( widgetDef.upcasts[ upcasts.pop() ], widgetDef.name, priority );\n\t\t\t}\n\t\t}\n\t\t// Single rule which is automatically activated.\n\t\telse {\n\t\t\taddUpcast( upcast, widgetDef.name, priority );\n\t\t}\n\n\t\tfunction addUpcast( upcast, name, priority ) {\n\t\t\t// Find index of the first higher (in terms of value) priority upcast.\n\t\t\tvar index = CKEDITOR.tools.getIndex( widgetsRepo._.upcasts, function( element ) {\n\t\t\t\treturn element[ 2 ] > priority;\n\t\t\t} );\n\t\t\t// Add at the end if it is the highest priority so far.\n\t\t\tif ( index < 0 ) {\n\t\t\t\tindex = widgetsRepo._.upcasts.length;\n\t\t\t}\n\n\t\t\twidgetsRepo._.upcasts.splice( index, 0, [ upcast, name, priority ] );\n\t\t}\n\t}\n\n\tfunction blurWidget( widgetsRepo, widget ) {\n\t\twidgetsRepo.focused = null;\n\n\t\tif ( widget.isInited() ) {\n\t\t\tvar isDirty = widget.editor.checkDirty();\n\n\t\t\t// Widget could be destroyed in the meantime - e.g. data could be set.\n\t\t\twidgetsRepo.fire( 'widgetBlurred', { widget: widget } );\n\t\t\twidget.setFocused( false );\n\n\t\t\t!isDirty && widget.editor.resetDirty();\n\t\t}\n\t}\n\n\tfunction checkWidgets( evt ) {\n\t\tvar options = evt.data;\n\n\t\tif ( this.editor.mode != 'wysiwyg' )\n\t\t\treturn;\n\n\t\tvar editable = this.editor.editable(),\n\t\t\tinstances = this.instances,\n\t\t\tnewInstances, i, count, wrapper, notYetInitialized;\n\n\t\tif ( !editable )\n\t\t\treturn;\n\n\t\t// Remove widgets which have no corresponding elements in DOM.\n\t\tfor ( i in instances ) {\n\t\t\t// #13410 Remove widgets that are ready. This prevents from destroying widgets that are during loading process.\n\t\t\tif ( instances[ i ].isReady() && !editable.contains( instances[ i ].wrapper ) )\n\t\t\t\tthis.destroy( instances[ i ], true );\n\t\t}\n\n\t\t// Init on all (new) if initOnlyNew option was passed.\n\t\tif ( options && options.initOnlyNew )\n\t\t\tnewInstances = this.initOnAll();\n\t\telse {\n\t\t\tvar wrappers = editable.find( '.cke_widget_wrapper' );\n\t\t\tnewInstances = [];\n\n\t\t\t// Create widgets on existing wrappers if they do not exists.\n\t\t\tfor ( i = 0, count = wrappers.count(); i < count; i++ ) {\n\t\t\t\twrapper = wrappers.getItem( i );\n\t\t\t\tnotYetInitialized = !this.getByElement( wrapper, true );\n\n\t\t\t\t// Check if:\n\t\t\t\t// * there's no instance for this widget\n\t\t\t\t// * wrapper is not inside some temporary element like copybin (#11088)\n\t\t\t\t// * it was a nested widget's wrapper which has been detached from DOM,\n\t\t\t\t// when nested editable has been initialized (it overwrites its innerHTML\n\t\t\t\t// and initializes nested widgets).\n\t\t\t\tif ( notYetInitialized && !findParent( wrapper, isDomTemp ) && editable.contains( wrapper ) ) {\n\t\t\t\t\t// Add cke_widget_new class because otherwise\n\t\t\t\t\t// widget will not be created on such wrapper.\n\t\t\t\t\twrapper.addClass( 'cke_widget_new' );\n\t\t\t\t\tnewInstances.push( this.initOn( wrapper.getFirst( Widget.isDomWidgetElement ) ) );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If only single widget was initialized and focusInited was passed, focus it.\n\t\tif ( options && options.focusInited && newInstances.length == 1 )\n\t\t\tnewInstances[ 0 ].focus();\n\t}\n\n\t// Unwraps widget element and clean up element.\n\t//\n\t// This function is used to clean up pasted widgets.\n\t// It should have similar result to widget#destroy plus\n\t// some additional adjustments, specific for pasting.\n\t//\n\t// @param {CKEDITOR.htmlParser.element} el\n\tfunction cleanUpWidgetElement( el ) {\n\t\tvar parent = el.parent;\n\t\tif ( parent.type == CKEDITOR.NODE_ELEMENT && parent.attributes[ 'data-cke-widget-wrapper' ] )\n\t\t\tparent.replaceWith( el );\n\t}\n\n\t// Similar to cleanUpWidgetElement, but works on DOM and finds\n\t// widget elements by its own.\n\t//\n\t// Unlike cleanUpWidgetElement it will wrap element back.\n\t//\n\t// @param {CKEDITOR.dom.element} container\n\tfunction cleanUpAllWidgetElements( widgetsRepo, container ) {\n\t\tvar wrappers = container.find( '.cke_widget_wrapper' ),\n\t\t\twrapper, element,\n\t\t\ti = 0,\n\t\t\tl = wrappers.count();\n\n\t\tfor ( ; i < l; ++i ) {\n\t\t\twrapper = wrappers.getItem( i );\n\t\t\telement = wrapper.getFirst( Widget.isDomWidgetElement );\n\t\t\t// If wrapper contains widget element - unwrap it and wrap again.\n\t\t\tif ( element.type == CKEDITOR.NODE_ELEMENT && element.data( 'widget' ) ) {\n\t\t\t\telement.replace( wrapper );\n\t\t\t\twidgetsRepo.wrapElement( element );\n\t\t\t} else {\n\t\t\t\t// Otherwise - something is wrong... clean this up.\n\t\t\t\twrapper.remove();\n\t\t\t}\n\t\t}\n\t}\n\n\t// Creates {@link CKEDITOR.filter} instance for given widget, editable and rules.\n\t//\n\t// Once filter for widget-editable pair is created it is cached, so the same instance\n\t// will be returned when method is executed again.\n\t//\n\t// @param {String} widgetName\n\t// @param {String} editableName\n\t// @param {CKEDITOR.plugins.widget.nestedEditableDefinition} editableDefinition The nested editable definition.\n\t// @returns {CKEDITOR.filter} Filter instance or `null` if rules are not defined.\n\t// @context CKEDITOR.plugins.widget.repository\n\tfunction createEditableFilter( widgetName, editableName, editableDefinition ) {\n\t\tif ( !editableDefinition.allowedContent )\n\t\t\treturn null;\n\n\t\tvar editables = this._.filters[ widgetName ];\n\n\t\tif ( !editables )\n\t\t\tthis._.filters[ widgetName ] = editables = {};\n\n\t\tvar filter = editables[ editableName ];\n\n\t\tif ( !filter )\n\t\t\teditables[ editableName ] = filter = new CKEDITOR.filter( editableDefinition.allowedContent );\n\n\t\treturn filter;\n\t}\n\n\t// Creates an iterator function which when executed on all\n\t// elements in DOM tree will gather elements that should be wrapped\n\t// and initialized as widgets.\n\tfunction createUpcastIterator( widgetsRepo ) {\n\t\tvar toBeWrapped = [],\n\t\t\tupcasts = widgetsRepo._.upcasts,\n\t\t\tupcastCallbacks = widgetsRepo._.upcastCallbacks;\n\n\t\treturn {\n\t\t\ttoBeWrapped: toBeWrapped,\n\n\t\t\titerator: function( element ) {\n\t\t\t\tvar upcast, upcasted,\n\t\t\t\t\tdata,\n\t\t\t\t\ti,\n\t\t\t\t\tupcastsLength,\n\t\t\t\t\tupcastCallbacksLength;\n\n\t\t\t\t// Wrapper found - find widget element, add it to be\n\t\t\t\t// cleaned up (unwrapped) and wrapped and stop iterating in this branch.\n\t\t\t\tif ( 'data-cke-widget-wrapper' in element.attributes ) {\n\t\t\t\t\telement = element.getFirst( Widget.isParserWidgetElement );\n\n\t\t\t\t\tif ( element )\n\t\t\t\t\t\ttoBeWrapped.push( [ element ] );\n\n\t\t\t\t\t// Do not iterate over descendants.\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Widget element found - add it to be cleaned up (just in case)\n\t\t\t\t// and wrapped and stop iterating in this branch.\n\t\t\t\telse if ( 'data-widget' in element.attributes ) {\n\t\t\t\t\ttoBeWrapped.push( [ element ] );\n\n\t\t\t\t\t// Do not iterate over descendants.\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse if ( ( upcastsLength = upcasts.length ) ) {\n\t\t\t\t\t// Ignore elements with data-cke-widget-upcasted to avoid multiple upcasts (#11533).\n\t\t\t\t\t// Do not iterate over descendants.\n\t\t\t\t\tif ( element.attributes[ 'data-cke-widget-upcasted' ] )\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t// Check element with upcast callbacks first.\n\t\t\t\t\t// If any of them return false abort upcasting.\n\t\t\t\t\tfor ( i = 0, upcastCallbacksLength = upcastCallbacks.length; i < upcastCallbacksLength; ++i ) {\n\t\t\t\t\t\tif ( upcastCallbacks[ i ]( element ) === false )\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t// Return nothing in order to continue iterating over ascendants.\n\t\t\t\t\t\t// See http://dev.ckeditor.com/ticket/11186#comment:6\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( i = 0; i < upcastsLength; ++i ) {\n\t\t\t\t\t\tupcast = upcasts[ i ];\n\t\t\t\t\t\tdata = {};\n\n\t\t\t\t\t\tif ( ( upcasted = upcast[ 0 ]( element, data ) ) ) {\n\t\t\t\t\t\t\t// If upcast function returned element, upcast this one.\n\t\t\t\t\t\t\t// It can be e.g. a new element wrapping the original one.\n\t\t\t\t\t\t\tif ( upcasted instanceof CKEDITOR.htmlParser.element )\n\t\t\t\t\t\t\t\telement = upcasted;\n\n\t\t\t\t\t\t\t// Set initial data attr with data from upcast method.\n\t\t\t\t\t\t\telement.attributes[ 'data-cke-widget-data' ] = encodeURIComponent( JSON.stringify( data ) );\n\t\t\t\t\t\t\telement.attributes[ 'data-cke-widget-upcasted' ] = 1;\n\n\t\t\t\t\t\t\ttoBeWrapped.push( [ element, upcast[ 1 ] ] );\n\n\t\t\t\t\t\t\t// Do not iterate over descendants.\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\t// Finds a first parent that matches query.\n\t//\n\t// @param {CKEDITOR.dom.element} element\n\t// @param {Function} query\n\tfunction findParent( element, query ) {\n\t\tvar parent = element;\n\n\t\twhile ( ( parent = parent.getParent() ) ) {\n\t\t\tif ( query( parent ) )\n\t\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction getWrapperAttributes( inlineWidget ) {\n\t\treturn {\n\t\t\t// tabindex=\"-1\" means that it can receive focus by code.\n\t\t\ttabindex: -1,\n\t\t\tcontenteditable: 'false',\n\t\t\t'data-cke-widget-wrapper': 1,\n\t\t\t'data-cke-filter': 'off',\n\t\t\t// Class cke_widget_new marks widgets which haven't been initialized yet.\n\t\t\t'class': 'cke_widget_wrapper cke_widget_new cke_widget_' +\n\t\t\t\t( inlineWidget ? 'inline' : 'block' )\n\t\t};\n\t}\n\n\t// Inserts element at given index.\n\t// It will check DTD and split ancestor elements up to the first\n\t// that can contain this element.\n\t//\n\t// @param {CKEDITOR.htmlParser.element} parent\n\t// @param {Number} index\n\t// @param {CKEDITOR.htmlParser.element} element\n\tfunction insertElement( parent, index, element ) {\n\t\t// Do not split doc fragment...\n\t\tif ( parent.type == CKEDITOR.NODE_ELEMENT ) {\n\t\t\tvar parentAllows = CKEDITOR.dtd[ parent.name ];\n\t\t\t// Parent element is known (included in DTD) and cannot contain\n\t\t\t// this element.\n\t\t\tif ( parentAllows && !parentAllows[ element.name ] ) {\n\t\t\t\tvar parent2 = parent.split( index ),\n\t\t\t\t\tparentParent = parent.parent;\n\n\t\t\t\t// Element will now be inserted at right parent's index.\n\t\t\t\tindex = parent2.getIndex();\n\n\t\t\t\t// If left part of split is empty - remove it.\n\t\t\t\tif ( !parent.children.length ) {\n\t\t\t\t\tindex -= 1;\n\t\t\t\t\tparent.remove();\n\t\t\t\t}\n\n\t\t\t\t// If right part of split is empty - remove it.\n\t\t\t\tif ( !parent2.children.length )\n\t\t\t\t\tparent2.remove();\n\n\t\t\t\t// Try inserting as grandpas' children.\n\t\t\t\treturn insertElement( parentParent, index, element );\n\t\t\t}\n\t\t}\n\n\t\t// Finally we can add this element.\n\t\tparent.add( element, index );\n\t}\n\n\t// Checks whether for the given widget definition and element widget should be created in inline or block mode.\n\t//\n\t// See also: {@link CKEDITOR.plugins.widget.definition#inline} and {@link CKEDITOR.plugins.widget#element}.\n\t//\n\t// @param {CKEDITOR.plugins.widget.definition} widgetDef The widget definition.\n\t// @param {String} elementName The name of the widget element.\n\t// @returns {Boolean}\n\tfunction isWidgetInline( widgetDef, elementName ) {\n\t\treturn typeof widgetDef.inline == 'boolean' ? widgetDef.inline : !!CKEDITOR.dtd.$inline[ elementName ];\n\t}\n\n\t// @param {CKEDITOR.dom.element}\n\t// @returns {Boolean}\n\tfunction isDomTemp( element ) {\n\t\treturn element.hasAttribute( 'data-cke-temp' );\n\t}\n\n\tfunction onEditableKey( widget, keyCode ) {\n\t\tvar focusedEditable = widget.focusedEditable,\n\t\t\trange;\n\n\t\t// CTRL+A.\n\t\tif ( keyCode == CKEDITOR.CTRL + 65 ) {\n\t\t\tvar bogus = focusedEditable.getBogus();\n\n\t\t\trange = widget.editor.createRange();\n\t\t\trange.selectNodeContents( focusedEditable );\n\t\t\t// Exclude bogus if exists.\n\t\t\tif ( bogus )\n\t\t\t\trange.setEndAt( bogus, CKEDITOR.POSITION_BEFORE_START );\n\n\t\t\trange.select();\n\t\t\t// Cancel event - block default.\n\t\t\treturn false;\n\t\t}\n\t\t// DEL or BACKSPACE.\n\t\telse if ( keyCode == 8 || keyCode == 46 ) {\n\t\t\tvar ranges = widget.editor.getSelection().getRanges();\n\n\t\t\trange = ranges[ 0 ];\n\n\t\t\t// Block del or backspace if at editable's boundary.\n\t\t\treturn !( ranges.length == 1 && range.collapsed &&\n\t\t\t\trange.checkBoundaryOfElement( focusedEditable, CKEDITOR[ keyCode == 8 ? 'START' : 'END' ] ) );\n\t\t}\n\t}\n\n\tfunction setFocusedEditable( widgetsRepo, widget, editableElement, offline ) {\n\t\tvar editor = widgetsRepo.editor;\n\n\t\teditor.fire( 'lockSnapshot' );\n\n\t\tif ( editableElement ) {\n\t\t\tvar editableName = editableElement.data( 'cke-widget-editable' ),\n\t\t\t\teditableInstance = widget.editables[ editableName ];\n\n\t\t\twidgetsRepo.widgetHoldingFocusedEditable = widget;\n\t\t\twidget.focusedEditable = editableInstance;\n\t\t\teditableElement.addClass( 'cke_widget_editable_focused' );\n\n\t\t\tif ( editableInstance.filter )\n\t\t\t\teditor.setActiveFilter( editableInstance.filter );\n\t\t\teditor.setActiveEnterMode( editableInstance.enterMode, editableInstance.shiftEnterMode );\n\t\t} else {\n\t\t\tif ( !offline )\n\t\t\t\twidget.focusedEditable.removeClass( 'cke_widget_editable_focused' );\n\n\t\t\twidget.focusedEditable = null;\n\t\t\twidgetsRepo.widgetHoldingFocusedEditable = null;\n\t\t\teditor.setActiveFilter( null );\n\t\t\teditor.setActiveEnterMode( null, null );\n\t\t}\n\n\t\teditor.fire( 'unlockSnapshot' );\n\t}\n\n\tfunction setupContextMenu( editor ) {\n\t\tif ( !editor.contextMenu )\n\t\t\treturn;\n\n\t\teditor.contextMenu.addListener( function( element ) {\n\t\t\tvar widget = editor.widgets.getByElement( element, true );\n\n\t\t\tif ( widget )\n\t\t\t\treturn widget.fire( 'contextMenu', {} );\n\t\t} );\n\t}\n\n\t// And now we've got two problems - original problem and RegExp.\n\t// Some softeners:\n\t// * FF tends to copy all blocks up to the copybin container.\n\t// * IE tends to copy only the copybin, without its container.\n\t// * We use spans on IE and blockless editors, but divs in other cases.\n\tvar pasteReplaceRegex = new RegExp(\n\t\t'^' +\n\t\t'(?:<(?:div|span)(?: data-cke-temp=\"1\")?(?: id=\"cke_copybin\")?(?: data-cke-temp=\"1\")?>)?' +\n\t\t\t'(?:<(?:div|span)(?: style=\"[^\"]+\")?>)?' +\n\t\t\t\t'<span [^>]*data-cke-copybin-start=\"1\"[^>]*>.?</span>([\\\\s\\\\S]+)<span [^>]*data-cke-copybin-end=\"1\"[^>]*>.?</span>' +\n\t\t\t'(?:</(?:div|span)>)?' +\n\t\t'(?:</(?:div|span)>)?' +\n\t\t'$',\n\t\t// IE8 prefers uppercase when browsers stick to lowercase HTML (#13460).\n\t\t'i'\n\t);\n\n\tfunction pasteReplaceFn( match, wrapperHtml ) {\n\t\t// Avoid polluting pasted data with any whitspaces,\n\t\t// what's going to break check whether only one widget was pasted.\n\t\treturn CKEDITOR.tools.trim( wrapperHtml );\n\t}\n\n\tfunction setupDragAndDrop( widgetsRepo ) {\n\t\tvar editor = widgetsRepo.editor,\n\t\t\tlineutils = CKEDITOR.plugins.lineutils;\n\n\t\t// These listeners handle inline and block widgets drag and drop.\n\t\t// The only thing we need to do to make block widgets custom drag and drop functionality\n\t\t// is to fire those events with the right properties (like the target which must be the drag handle).\n\t\teditor.on( 'dragstart', function( evt ) {\n\t\t\tvar target = evt.data.target;\n\n\t\t\tif ( Widget.isDomDragHandler( target ) ) {\n\t\t\t\tvar widget = widgetsRepo.getByElement( target );\n\n\t\t\t\tevt.data.dataTransfer.setData( 'cke/widget-id', widget.id );\n\n\t\t\t\t// IE needs focus.\n\t\t\t\teditor.focus();\n\n\t\t\t\t// and widget need to be focused on drag start (#12172#comment:10).\n\t\t\t\twidget.focus();\n\t\t\t}\n\t\t} );\n\n\t\teditor.on( 'drop', function( evt ) {\n\t\t\tvar dataTransfer = evt.data.dataTransfer,\n\t\t\t\tid = dataTransfer.getData( 'cke/widget-id' ),\n\t\t\t\ttransferType = dataTransfer.getTransferType( editor ),\n\t\t\t\tdragRange = editor.createRange(),\n\t\t\t\tsourceWidget;\n\n\t\t\t// Disable cross-editor drag & drop for widgets - #13599.\n\t\t\tif ( id !== '' && transferType === CKEDITOR.DATA_TRANSFER_CROSS_EDITORS ) {\n\t\t\t\tevt.cancel();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( id === '' || transferType != CKEDITOR.DATA_TRANSFER_INTERNAL ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsourceWidget = widgetsRepo.instances[ id ];\n\t\t\tif ( !sourceWidget ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdragRange.setStartBefore( sourceWidget.wrapper );\n\t\t\tdragRange.setEndAfter( sourceWidget.wrapper );\n\t\t\tevt.data.dragRange = dragRange;\n\n\t\t\t// [IE8-9] Reset state of the clipboard#fixSplitNodesAfterDrop fix because by setting evt.data.dragRange\n\t\t\t// (see above) after drop happened we do not need it. That fix is needed only if dragRange was created\n\t\t\t// before drop (before text node was split).\n\t\t\tdelete CKEDITOR.plugins.clipboard.dragStartContainerChildCount;\n\t\t\tdelete CKEDITOR.plugins.clipboard.dragEndContainerChildCount;\n\n\t\t\tevt.data.dataTransfer.setData( 'text/html', editor.editable().getHtmlFromRange( dragRange ).getHtml() );\n\t\t\teditor.widgets.destroy( sourceWidget, true );\n\t\t} );\n\n\t\teditor.on( 'contentDom', function() {\n\t\t\tvar editable = editor.editable();\n\n\t\t\t// Register Lineutils's utilities as properties of repo.\n\t\t\tCKEDITOR.tools.extend( widgetsRepo, {\n\t\t\t\tfinder: new lineutils.finder( editor, {\n\t\t\t\t\tlookups: {\n\t\t\t\t\t\t// Element is block but not list item and not in nested editable.\n\t\t\t\t\t\t'default': function( el ) {\n\t\t\t\t\t\t\tif ( el.is( CKEDITOR.dtd.$listItem ) )\n\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\tif ( !el.is( CKEDITOR.dtd.$block ) )\n\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t// Allow drop line inside, but never before or after nested editable (#12006).\n\t\t\t\t\t\t\tif ( Widget.isDomNestedEditable( el ) )\n\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t// Do not allow droping inside the widget being dragged (#13397).\n\t\t\t\t\t\t\tif ( widgetsRepo._.draggedWidget.wrapper.contains( el ) ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// If element is nested editable, make sure widget can be dropped there (#12006).\n\t\t\t\t\t\t\tvar nestedEditable = Widget.getNestedEditable( editable, el );\n\t\t\t\t\t\t\tif ( nestedEditable ) {\n\t\t\t\t\t\t\t\tvar draggedWidget = widgetsRepo._.draggedWidget;\n\n\t\t\t\t\t\t\t\t// Don't let the widget to be dropped into its own nested editable.\n\t\t\t\t\t\t\t\tif ( widgetsRepo.getByElement( nestedEditable ) == draggedWidget )\n\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\tvar filter = CKEDITOR.filter.instances[ nestedEditable.data( 'cke-filter' ) ],\n\t\t\t\t\t\t\t\t\tdraggedRequiredContent = draggedWidget.requiredContent;\n\n\t\t\t\t\t\t\t\t// There will be no relation if the filter of nested editable does not allow\n\t\t\t\t\t\t\t\t// requiredContent of dragged widget.\n\t\t\t\t\t\t\t\tif ( filter && draggedRequiredContent && !filter.check( draggedRequiredContent ) )\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn CKEDITOR.LINEUTILS_BEFORE | CKEDITOR.LINEUTILS_AFTER;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} ),\n\t\t\t\tlocator: new lineutils.locator( editor ),\n\t\t\t\tliner: new lineutils.liner( editor, {\n\t\t\t\t\tlineStyle: {\n\t\t\t\t\t\tcursor: 'move !important',\n\t\t\t\t\t\t'border-top-color': '#666'\n\t\t\t\t\t},\n\t\t\t\t\ttipLeftStyle: {\n\t\t\t\t\t\t'border-left-color': '#666'\n\t\t\t\t\t},\n\t\t\t\t\ttipRightStyle: {\n\t\t\t\t\t\t'border-right-color': '#666'\n\t\t\t\t\t}\n\t\t\t\t} )\n\t\t\t}, true );\n\t\t} );\n\t}\n\n\t// Setup mouse observer which will trigger:\n\t// * widget focus on widget click,\n\t// * widget#doubleclick forwarded from editor#doubleclick.\n\tfunction setupMouseObserver( widgetsRepo ) {\n\t\tvar editor = widgetsRepo.editor;\n\n\t\teditor.on( 'contentDom', function() {\n\t\t\tvar editable = editor.editable(),\n\t\t\t\tevtRoot = editable.isInline() ? editable : editor.document,\n\t\t\t\twidget,\n\t\t\t\tmouseDownOnDragHandler;\n\n\t\t\teditable.attachListener( evtRoot, 'mousedown', function( evt ) {\n\t\t\t\tvar target = evt.data.getTarget();\n\n\t\t\t\t// #10887 Clicking scrollbar in IE8 will invoke event with empty target object.\n\t\t\t\tif ( !target.type )\n\t\t\t\t\treturn false;\n\n\t\t\t\twidget = widgetsRepo.getByElement( target );\n\t\t\t\tmouseDownOnDragHandler = 0; // Reset.\n\n\t\t\t\t// Widget was clicked, but not editable nested in it.\n\t\t\t\tif ( widget ) {\n\t\t\t\t\t// Ignore mousedown on drag and drop handler if the widget is inline.\n\t\t\t\t\t// Block widgets are handled by Lineutils.\n\t\t\t\t\tif ( widget.inline && target.type == CKEDITOR.NODE_ELEMENT && target.hasAttribute( 'data-cke-widget-drag-handler' ) ) {\n\t\t\t\t\t\tmouseDownOnDragHandler = 1;\n\n\t\t\t\t\t\t// When drag handler is pressed we have to clear current selection if it wasn't already on this widget.\n\t\t\t\t\t\t// Otherwise, the selection may be in a fillingChar, which prevents dragging a widget. (#13284, see comment 8 and 9.)\n\t\t\t\t\t\tif ( widgetsRepo.focused != widget )\n\t\t\t\t\t\t\teditor.getSelection().removeAllRanges();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( !Widget.getNestedEditable( widget.wrapper, target ) ) {\n\t\t\t\t\t\tevt.data.preventDefault();\n\t\t\t\t\t\tif ( !CKEDITOR.env.ie )\n\t\t\t\t\t\t\twidget.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Reset widget so mouseup listener is not confused.\n\t\t\t\t\t\twidget = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// Focus widget on mouseup if mousedown was fired on drag handler.\n\t\t\t// Note: mouseup won't be fired at all if widget was dragged and dropped, so\n\t\t\t// this code will be executed only when drag handler was clicked.\n\t\t\teditable.attachListener( evtRoot, 'mouseup', function() {\n\t\t\t\t// Check if widget is not destroyed (if widget is destroyed the wrapper will be null).\n\t\t\t\tif ( mouseDownOnDragHandler && widget && widget.wrapper ) {\n\t\t\t\t\tmouseDownOnDragHandler = 0;\n\t\t\t\t\twidget.focus();\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t// On IE it is not enough to block mousedown. If widget wrapper (element with\n\t\t\t// contenteditable=false attribute) is clicked directly (it is a target),\n\t\t\t// then after mouseup/click IE will select that element.\n\t\t\t// It is not possible to prevent that default action,\n\t\t\t// so we force fake selection after everything happened.\n\t\t\tif ( CKEDITOR.env.ie ) {\n\t\t\t\teditable.attachListener( evtRoot, 'mouseup', function() {\n\t\t\t\t\tsetTimeout( function() {\n\t\t\t\t\t\t// Check if widget is not destroyed (if widget is destroyed the wrapper will be null) and\n\t\t\t\t\t\t// in editable contains widget (it could be dragged and removed).\n\t\t\t\t\t\tif ( widget && widget.wrapper && editable.contains( widget.wrapper ) ) {\n\t\t\t\t\t\t\twidget.focus();\n\t\t\t\t\t\t\twidget = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\n\t\teditor.on( 'doubleclick', function( evt ) {\n\t\t\tvar widget = widgetsRepo.getByElement( evt.data.element );\n\n\t\t\t// Not in widget or in nested editable.\n\t\t\tif ( !widget || Widget.getNestedEditable( widget.wrapper, evt.data.element ) )\n\t\t\t\treturn;\n\n\t\t\treturn widget.fire( 'doubleclick', { element: evt.data.element } );\n\t\t}, null, null, 1 );\n\t}\n\n\t// Setup editor#key observer which will forward it\n\t// to focused widget.\n\tfunction setupKeyboardObserver( widgetsRepo ) {\n\t\tvar editor = widgetsRepo.editor;\n\n\t\teditor.on( 'key', function( evt ) {\n\t\t\tvar focused = widgetsRepo.focused,\n\t\t\t\twidgetHoldingFocusedEditable = widgetsRepo.widgetHoldingFocusedEditable,\n\t\t\t\tret;\n\n\t\t\tif ( focused )\n\t\t\t\tret = focused.fire( 'key', { keyCode: evt.data.keyCode } );\n\t\t\telse if ( widgetHoldingFocusedEditable )\n\t\t\t\tret = onEditableKey( widgetHoldingFocusedEditable, evt.data.keyCode );\n\n\t\t\treturn ret;\n\t\t}, null, null, 1 );\n\t}\n\n\t// Setup copybin on native copy and cut events in order to handle copy and cut commands\n\t// if user accepted security alert on IEs.\n\t// Note: when copying or cutting using keystroke, copySingleWidget will be first executed\n\t// by the keydown listener. Conflict between two calls will be resolved by copy_bin existence check.\n\tfunction setupNativeCutAndCopy( widgetsRepo ) {\n\t\tvar editor = widgetsRepo.editor;\n\n\t\teditor.on( 'contentDom', function() {\n\t\t\tvar editable = editor.editable();\n\n\t\t\teditable.attachListener( editable, 'copy', eventListener );\n\t\t\teditable.attachListener( editable, 'cut', eventListener );\n\t\t} );\n\n\t\tfunction eventListener( evt ) {\n\t\t\tif ( widgetsRepo.focused )\n\t\t\t\tcopySingleWidget( widgetsRepo.focused, evt.name == 'cut' );\n\t\t}\n\t}\n\n\t// Setup selection observer which will trigger:\n\t// * widget select & focus on selection change,\n\t// * nested editable focus (related properites and classes) on selection change,\n\t// * deselecting and blurring all widgets on data,\n\t// * blurring widget on editor blur.\n\tfunction setupSelectionObserver( widgetsRepo ) {\n\t\tvar editor = widgetsRepo.editor;\n\n\t\teditor.on( 'selectionCheck', function() {\n\t\t\twidgetsRepo.fire( 'checkSelection' );\n\t\t} );\n\n\t\twidgetsRepo.on( 'checkSelection', widgetsRepo.checkSelection, widgetsRepo );\n\n\t\teditor.on( 'selectionChange', function( evt ) {\n\t\t\tvar nestedEditable = Widget.getNestedEditable( editor.editable(), evt.data.selection.getStartElement() ),\n\t\t\t\tnewWidget = nestedEditable && widgetsRepo.getByElement( nestedEditable ),\n\t\t\t\toldWidget = widgetsRepo.widgetHoldingFocusedEditable;\n\n\t\t\tif ( oldWidget ) {\n\t\t\t\tif ( oldWidget !== newWidget || !oldWidget.focusedEditable.equals( nestedEditable ) ) {\n\t\t\t\t\tsetFocusedEditable( widgetsRepo, oldWidget, null );\n\n\t\t\t\t\tif ( newWidget && nestedEditable )\n\t\t\t\t\t\tsetFocusedEditable( widgetsRepo, newWidget, nestedEditable );\n\t\t\t\t}\n\t\t\t}\n\t\t\t// It may happen that there's no widget even if editable was found -\n\t\t\t// e.g. if selection was automatically set in editable although widget wasn't initialized yet.\n\t\t\telse if ( newWidget && nestedEditable ) {\n\t\t\t\tsetFocusedEditable( widgetsRepo, newWidget, nestedEditable );\n\t\t\t}\n\t\t} );\n\n\t\t// Invalidate old widgets early - immediately on dataReady.\n\t\teditor.on( 'dataReady', function() {\n\t\t\t// Deselect and blur all widgets.\n\t\t\tstateUpdater( widgetsRepo ).commit();\n\t\t} );\n\n\t\teditor.on( 'blur', function() {\n\t\t\tvar widget;\n\n\t\t\tif ( ( widget = widgetsRepo.focused ) )\n\t\t\t\tblurWidget( widgetsRepo, widget );\n\n\t\t\tif ( ( widget = widgetsRepo.widgetHoldingFocusedEditable ) )\n\t\t\t\tsetFocusedEditable( widgetsRepo, widget, null );\n\t\t} );\n\t}\n\n\t// Set up actions like:\n\t// * processing in toHtml/toDataFormat,\n\t// * pasting handling,\n\t// * insertion handling,\n\t// * editable reload handling (setData, mode switch, undo/redo),\n\t// * DOM invalidation handling,\n\t// * widgets checks.\n\tfunction setupWidgetsLifecycle( widgetsRepo ) {\n\t\tsetupWidgetsLifecycleStart( widgetsRepo );\n\t\tsetupWidgetsLifecycleEnd( widgetsRepo );\n\n\t\twidgetsRepo.on( 'checkWidgets', checkWidgets );\n\t\twidgetsRepo.editor.on( 'contentDomInvalidated', widgetsRepo.checkWidgets, widgetsRepo );\n\t}\n\n\tfunction setupWidgetsLifecycleEnd( widgetsRepo ) {\n\t\tvar editor = widgetsRepo.editor,\n\t\t\tdowncastingSessions = {};\n\n\t\t// Listen before htmlDP#htmlFilter is applied to cache all widgets, because we'll\n\t\t// loose data-cke-* attributes.\n\t\teditor.on( 'toDataFormat', function( evt ) {\n\t\t\t// To avoid conflicts between htmlDP#toDF calls done at the same time\n\t\t\t// (e.g. nestedEditable#getData called during downcasting some widget)\n\t\t\t// mark every toDataFormat event chain with the downcasting session id.\n\t\t\tvar id = CKEDITOR.tools.getNextNumber(),\n\t\t\t\ttoBeDowncasted = [];\n\t\t\tevt.data.downcastingSessionId = id;\n\t\t\tdowncastingSessions[ id ] = toBeDowncasted;\n\n\t\t\tevt.data.dataValue.forEach( function( element ) {\n\t\t\t\tvar attrs = element.attributes,\n\t\t\t\t\twidget, widgetElement;\n\n\t\t\t\t// Wrapper.\n\t\t\t\t// Perform first part of downcasting (cleanup) and cache widgets,\n\t\t\t\t// because after applying DP's filter all data-cke-* attributes will be gone.\n\t\t\t\tif ( 'data-cke-widget-id' in attrs ) {\n\t\t\t\t\twidget = widgetsRepo.instances[ attrs[ 'data-cke-widget-id' ] ];\n\t\t\t\t\tif ( widget ) {\n\t\t\t\t\t\twidgetElement = element.getFirst( Widget.isParserWidgetElement );\n\t\t\t\t\t\ttoBeDowncasted.push( {\n\t\t\t\t\t\t\twrapper: element,\n\t\t\t\t\t\t\telement: widgetElement,\n\t\t\t\t\t\t\twidget: widget,\n\t\t\t\t\t\t\teditables: {}\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t// If widget did not have data-cke-widget attribute before upcasting remove it.\n\t\t\t\t\t\tif ( widgetElement.attributes[ 'data-cke-widget-keep-attr' ] != '1' )\n\t\t\t\t\t\t\tdelete widgetElement.attributes[ 'data-widget' ];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Nested editable.\n\t\t\t\telse if ( 'data-cke-widget-editable' in attrs ) {\n\t\t\t\t\t// Save the reference to this nested editable in the closest widget to be downcasted.\n\t\t\t\t\t// Nested editables are downcasted in the successive toDataFormat to create an opportunity\n\t\t\t\t\t// for dataFilter's \"excludeNestedEditable\" option to do its job (that option relies on\n\t\t\t\t\t// contenteditable=\"true\" attribute) (#11372).\n\t\t\t\t\ttoBeDowncasted[ toBeDowncasted.length - 1 ].editables[ attrs[ 'data-cke-widget-editable' ] ] = element;\n\n\t\t\t\t\t// Don't check children - there won't be next wrapper or nested editable which we\n\t\t\t\t\t// should process in this session.\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}, CKEDITOR.NODE_ELEMENT, true );\n\t\t}, null, null, 8 );\n\n\t\t// Listen after dataProcessor.htmlFilter and ACF were applied\n\t\t// so wrappers securing widgets' contents are removed after all filtering was done.\n\t\teditor.on( 'toDataFormat', function( evt ) {\n\t\t\t// Ignore some unmarked sessions.\n\t\t\tif ( !evt.data.downcastingSessionId )\n\t\t\t\treturn;\n\n\t\t\tvar toBeDowncasted = downcastingSessions[ evt.data.downcastingSessionId ],\n\t\t\t\ttoBe, widget, widgetElement, retElement, editableElement, e;\n\n\t\t\twhile ( ( toBe = toBeDowncasted.shift() ) ) {\n\t\t\t\twidget = toBe.widget;\n\t\t\t\twidgetElement = toBe.element;\n\t\t\t\tretElement = widget._.downcastFn && widget._.downcastFn.call( widget, widgetElement );\n\n\t\t\t\t// Replace nested editables' content with their output data.\n\t\t\t\tfor ( e in toBe.editables ) {\n\t\t\t\t\teditableElement = toBe.editables[ e ];\n\n\t\t\t\t\tdelete editableElement.attributes.contenteditable;\n\t\t\t\t\teditableElement.setHtml( widget.editables[ e ].getData() );\n\t\t\t\t}\n\n\t\t\t\t// Returned element always defaults to widgetElement.\n\t\t\t\tif ( !retElement )\n\t\t\t\t\tretElement = widgetElement;\n\n\t\t\t\ttoBe.wrapper.replaceWith( retElement );\n\t\t\t}\n\t\t}, null, null, 13 );\n\n\n\t\teditor.on( 'contentDomUnload', function() {\n\t\t\twidgetsRepo.destroyAll( true );\n\t\t} );\n\t}\n\n\tfunction setupWidgetsLifecycleStart( widgetsRepo ) {\n\t\tvar editor = widgetsRepo.editor,\n\t\t\tprocessedWidgetOnly,\n\t\t\tsnapshotLoaded;\n\n\t\t// Listen after ACF (so data are filtered),\n\t\t// but before dataProcessor.dataFilter was applied (so we can secure widgets' internals).\n\t\teditor.on( 'toHtml', function( evt ) {\n\t\t\tvar upcastIterator = createUpcastIterator( widgetsRepo ),\n\t\t\t\ttoBeWrapped;\n\n\t\t\tevt.data.dataValue.forEach( upcastIterator.iterator, CKEDITOR.NODE_ELEMENT, true );\n\n\t\t\t// Clean up and wrap all queued elements.\n\t\t\twhile ( ( toBeWrapped = upcastIterator.toBeWrapped.pop() ) ) {\n\t\t\t\tcleanUpWidgetElement( toBeWrapped[ 0 ] );\n\t\t\t\twidgetsRepo.wrapElement( toBeWrapped[ 0 ], toBeWrapped[ 1 ] );\n\t\t\t}\n\n\t\t\t// Used to determine whether only widget was pasted.\n\t\t\tif ( evt.data.protectedWhitespaces ) {\n\t\t\t\t// Whitespaces are protected by wrapping content with spans. Take the middle node only.\n\t\t\t\tprocessedWidgetOnly = evt.data.dataValue.children.length == 3 &&\n\t\t\t\t\tWidget.isParserWidgetWrapper( evt.data.dataValue.children[ 1 ] );\n\t\t\t} else {\n\t\t\t\tprocessedWidgetOnly = evt.data.dataValue.children.length == 1 &&\n\t\t\t\t\tWidget.isParserWidgetWrapper( evt.data.dataValue.children[ 0 ] );\n\t\t\t}\n\t\t}, null, null, 8 );\n\n\t\teditor.on( 'dataReady', function() {\n\t\t\t// Clean up all widgets loaded from snapshot.\n\t\t\tif ( snapshotLoaded )\n\t\t\t\tcleanUpAllWidgetElements( widgetsRepo, editor.editable() );\n\t\t\tsnapshotLoaded = 0;\n\n\t\t\t// Some widgets were destroyed on contentDomUnload,\n\t\t\t// some on loadSnapshot, but that does not include\n\t\t\t// e.g. setHtml on inline editor or widgets removed just\n\t\t\t// before setting data.\n\t\t\twidgetsRepo.destroyAll( true );\n\t\t\twidgetsRepo.initOnAll();\n\t\t} );\n\n\t\t// Set flag so dataReady will know that additional\n\t\t// cleanup is needed, because snapshot containing widgets was loaded.\n\t\teditor.on( 'loadSnapshot', function( evt ) {\n\t\t\t// Primitive but sufficient check which will prevent from executing\n\t\t\t// heavier cleanUpAllWidgetElements if not needed.\n\t\t\tif ( ( /data-cke-widget/ ).test( evt.data ) )\n\t\t\t\tsnapshotLoaded = 1;\n\n\t\t\twidgetsRepo.destroyAll( true );\n\t\t}, null, null, 9 );\n\n\t\t// Handle pasted single widget.\n\t\teditor.on( 'paste', function( evt ) {\n\t\t\tvar data = evt.data;\n\n\t\t\tdata.dataValue = data.dataValue.replace( pasteReplaceRegex, pasteReplaceFn );\n\n\t\t\t// If drag'n'drop kind of paste into nested editable (data.range), selection is set AFTER\n\t\t\t// data is pasted, which means editor has no chance to change activeFilter's context.\n\t\t\t// As a result, pasted data is filtered with default editor's filter instead of NE's and\n\t\t\t// funny things get inserted. Changing the filter by analysis of the paste range below (#13186).\n\t\t\tif ( data.range ) {\n\t\t\t\t// Check if pasting into nested editable.\n\t\t\t\tvar nestedEditable = Widget.getNestedEditable( editor.editable(), data.range.startContainer );\n\n\t\t\t\tif ( nestedEditable ) {\n\t\t\t\t\t// Retrieve the filter from NE's data and set it active before editor.insertHtml is done\n\t\t\t\t\t// in clipboard plugin.\n\t\t\t\t\tvar filter = CKEDITOR.filter.instances[ nestedEditable.data( 'cke-filter' ) ];\n\n\t\t\t\t\tif ( filter ) {\n\t\t\t\t\t\teditor.setActiveFilter( filter );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t\t// Listen with high priority to check widgets after data was inserted.\n\t\teditor.on( 'afterInsertHtml', function( evt ) {\n\t\t\tif ( evt.data.intoRange ) {\n\t\t\t\twidgetsRepo.checkWidgets( { initOnlyNew: true } );\n\t\t\t} else {\n\t\t\t\teditor.fire( 'lockSnapshot' );\n\t\t\t\t// Init only new for performance reason.\n\t\t\t\t// Focus inited if only widget was processed.\n\t\t\t\twidgetsRepo.checkWidgets( { initOnlyNew: true, focusInited: processedWidgetOnly } );\n\n\t\t\t\teditor.fire( 'unlockSnapshot' );\n\t\t\t}\n\t\t} );\n\t}\n\n\t// Helper for coordinating which widgets should be\n\t// selected/deselected and which one should be focused/blurred.\n\tfunction stateUpdater( widgetsRepo ) {\n\t\tvar currentlySelected = widgetsRepo.selected,\n\t\t\ttoBeSelected = [],\n\t\t\ttoBeDeselected = currentlySelected.slice( 0 ),\n\t\t\tfocused = null;\n\n\t\treturn {\n\t\t\tselect: function( widget ) {\n\t\t\t\tif ( CKEDITOR.tools.indexOf( currentlySelected, widget ) < 0 )\n\t\t\t\t\ttoBeSelected.push( widget );\n\n\t\t\t\tvar index = CKEDITOR.tools.indexOf( toBeDeselected, widget );\n\t\t\t\tif ( index >= 0 )\n\t\t\t\t\ttoBeDeselected.splice( index, 1 );\n\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\tfocus: function( widget ) {\n\t\t\t\tfocused = widget;\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\tcommit: function() {\n\t\t\t\tvar focusedChanged = widgetsRepo.focused !== focused,\n\t\t\t\t\twidget, isDirty;\n\n\t\t\t\twidgetsRepo.editor.fire( 'lockSnapshot' );\n\n\t\t\t\tif ( focusedChanged && ( widget = widgetsRepo.focused ) )\n\t\t\t\t\tblurWidget( widgetsRepo, widget );\n\n\t\t\t\twhile ( ( widget = toBeDeselected.pop() ) ) {\n\t\t\t\t\tcurrentlySelected.splice( CKEDITOR.tools.indexOf( currentlySelected, widget ), 1 );\n\t\t\t\t\t// Widget could be destroyed in the meantime - e.g. data could be set.\n\t\t\t\t\tif ( widget.isInited() ) {\n\t\t\t\t\t\tisDirty = widget.editor.checkDirty();\n\n\t\t\t\t\t\twidget.setSelected( false );\n\n\t\t\t\t\t\t!isDirty && widget.editor.resetDirty();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( focusedChanged && focused ) {\n\t\t\t\t\tisDirty = widgetsRepo.editor.checkDirty();\n\n\t\t\t\t\twidgetsRepo.focused = focused;\n\t\t\t\t\twidgetsRepo.fire( 'widgetFocused', { widget: focused } );\n\t\t\t\t\tfocused.setFocused( true );\n\n\t\t\t\t\t!isDirty && widgetsRepo.editor.resetDirty();\n\t\t\t\t}\n\n\t\t\t\twhile ( ( widget = toBeSelected.pop() ) ) {\n\t\t\t\t\tcurrentlySelected.push( widget );\n\t\t\t\t\twidget.setSelected( true );\n\t\t\t\t}\n\n\t\t\t\twidgetsRepo.editor.fire( 'unlockSnapshot' );\n\t\t\t}\n\t\t};\n\t}\n\n\n\t//\n\t// WIDGET helpers ---------------------------------------------------------\n\t//\n\n\t// LEFT, RIGHT, UP, DOWN, DEL, BACKSPACE - unblock default fake sel handlers.\n\tvar keystrokesNotBlockedByWidget = { 37: 1, 38: 1, 39: 1, 40: 1, 8: 1, 46: 1 };\n\n\t// Applies or removes style's classes from widget.\n\t// @param {CKEDITOR.style} style Custom widget style.\n\t// @param {Boolean} apply Whether to apply or remove style.\n\tfunction applyRemoveStyle( widget, style, apply ) {\n\t\tvar changed = 0,\n\t\t\tclasses = getStyleClasses( style ),\n\t\t\tupdatedClasses = widget.data.classes || {},\n\t\t\tcl;\n\n\t\t// Ee... Something is wrong with this style.\n\t\tif ( !classes )\n\t\t\treturn;\n\n\t\t// Clone, because we need to break reference.\n\t\tupdatedClasses = CKEDITOR.tools.clone( updatedClasses );\n\n\t\twhile ( ( cl = classes.pop() ) ) {\n\t\t\tif ( apply ) {\n\t\t\t\tif ( !updatedClasses[ cl ] )\n\t\t\t\t\tchanged = updatedClasses[ cl ] = 1;\n\t\t\t} else {\n\t\t\t\tif ( updatedClasses[ cl ] ) {\n\t\t\t\t\tdelete updatedClasses[ cl ];\n\t\t\t\t\tchanged = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif ( changed )\n\t\t\twidget.setData( 'classes', updatedClasses );\n\t}\n\n\tfunction cancel( evt ) {\n\t\tevt.cancel();\n\t}\n\n\tfunction copySingleWidget( widget, isCut ) {\n\t\tvar editor = widget.editor,\n\t\t\tdoc = editor.document;\n\n\t\t// We're still handling previous copy/cut.\n\t\t// When keystroke is used to copy/cut this will also prevent\n\t\t// conflict with copySingleWidget called again for native copy/cut event.\n\t\tif ( doc.getById( 'cke_copybin' ) )\n\t\t\treturn;\n\n\t\t\t// [IE] Use span for copybin and its container to avoid bug with expanding editable height by\n\t\t\t// absolutely positioned element.\n\t\tvar copybinName = ( editor.blockless || CKEDITOR.env.ie ) ? 'span' : 'div',\n\t\t\tcopybin = doc.createElement( copybinName ),\n\t\t\tcopybinContainer = doc.createElement( copybinName ),\n\t\t\t// IE8 always jumps to the end of document.\n\t\t\tneedsScrollHack = CKEDITOR.env.ie && CKEDITOR.env.version < 9;\n\n\t\tcopybinContainer.setAttributes( {\n\t\t\tid: 'cke_copybin',\n\t\t\t'data-cke-temp': '1'\n\t\t} );\n\n\t\t// Position copybin element outside current viewport.\n\t\tcopybin.setStyles( {\n\t\t\tposition: 'absolute',\n\t\t\twidth: '1px',\n\t\t\theight: '1px',\n\t\t\toverflow: 'hidden'\n\t\t} );\n\n\t\tcopybin.setStyle( editor.config.contentsLangDirection == 'ltr' ? 'left' : 'right', '-5000px' );\n\n\t\tvar range = editor.createRange();\n\t\trange.setStartBefore( widget.wrapper );\n\t\trange.setEndAfter( widget.wrapper );\n\n\t\tcopybin.setHtml(\n\t\t\t'<span data-cke-copybin-start=\"1\">\\u200b</span>' +\n\t\t\teditor.editable().getHtmlFromRange( range ).getHtml() +\n\t\t\t'<span data-cke-copybin-end=\"1\">\\u200b</span>' );\n\n\t\t// Save snapshot with the current state.\n\t\teditor.fire( 'saveSnapshot' );\n\n\t\t// Ignore copybin.\n\t\teditor.fire( 'lockSnapshot' );\n\n\t\tcopybinContainer.append( copybin );\n\t\teditor.editable().append( copybinContainer );\n\n\t\tvar listener1 = editor.on( 'selectionChange', cancel, null, null, 0 ),\n\t\t\tlistener2 = widget.repository.on( 'checkSelection', cancel, null, null, 0 );\n\n\t\tif ( needsScrollHack ) {\n\t\t\tvar docElement = doc.getDocumentElement().$,\n\t\t\t\tscrollTop = docElement.scrollTop;\n\t\t}\n\n\t\t// Once the clone of the widget is inside of copybin, select\n\t\t// the entire contents. This selection will be copied by the\n\t\t// native browser's clipboard system.\n\t\trange = editor.createRange();\n\t\trange.selectNodeContents( copybin );\n\t\trange.select();\n\n\t\tif ( needsScrollHack )\n\t\t\tdocElement.scrollTop = scrollTop;\n\n\t\tsetTimeout( function() {\n\t\t\t// [IE] Focus widget before removing copybin to avoid scroll jump.\n\t\t\tif ( !isCut )\n\t\t\t\twidget.focus();\n\n\t\t\tcopybinContainer.remove();\n\n\t\t\tlistener1.removeListener();\n\t\t\tlistener2.removeListener();\n\n\t\t\teditor.fire( 'unlockSnapshot' );\n\n\t\t\tif ( isCut ) {\n\t\t\t\twidget.repository.del( widget );\n\t\t\t\teditor.fire( 'saveSnapshot' );\n\t\t\t}\n\t\t}, 100 ); // Use 100ms, so Chrome (@Mac) will be able to grab the content.\n\t}\n\n\t// Extracts classes array from style instance.\n\tfunction getStyleClasses( style ) {\n\t\tvar attrs = style.getDefinition().attributes,\n\t\t\tclasses = attrs && attrs[ 'class' ];\n\n\t\treturn classes ? classes.split( /\\s+/ ) : null;\n\t}\n\n\t// [IE] Force keeping focus because IE sometimes forgets to fire focus on main editable\n\t// when blurring nested editable.\n\t// @context widget\n\tfunction onEditableBlur() {\n\t\tvar active = CKEDITOR.document.getActive(),\n\t\t\teditor = this.editor,\n\t\t\teditable = editor.editable();\n\n\t\t// If focus stays within editor override blur and set currentActive because it should be\n\t\t// automatically changed to editable on editable#focus but it is not fired.\n\t\tif ( ( editable.isInline() ? editable : editor.document.getWindow().getFrame() ).equals( active ) )\n\t\t\teditor.focusManager.focus( editable );\n\t}\n\n\t// Force selectionChange when editable was focused.\n\t// Similar to hack in selection.js#~620.\n\t// @context widget\n\tfunction onEditableFocus() {\n\t\t// Gecko does not support 'DOMFocusIn' event on which we unlock selection\n\t\t// in selection.js to prevent selection locking when entering nested editables.\n\t\tif ( CKEDITOR.env.gecko )\n\t\t\tthis.editor.unlockSelection();\n\n\t\t// We don't need to force selectionCheck on Webkit, because on Webkit\n\t\t// we do that on DOMFocusIn in selection.js.\n\t\tif ( !CKEDITOR.env.webkit ) {\n\t\t\tthis.editor.forceNextSelectionCheck();\n\t\t\tthis.editor.selectionChange( 1 );\n\t\t}\n\t}\n\n\t// Setup listener on widget#data which will update (remove/add) classes\n\t// by comparing newly set classes with the old ones.\n\tfunction setupDataClassesListener( widget ) {\n\t\t// Note: previousClasses and newClasses may be null!\n\t\t// Tip: for ( cl in null ) is correct.\n\t\tvar previousClasses = null;\n\n\t\twidget.on( 'data', function() {\n\t\t\tvar newClasses = this.data.classes,\n\t\t\t\tcl;\n\n\t\t\t// When setting new classes one need to remember\n\t\t\t// that he must break reference.\n\t\t\tif ( previousClasses == newClasses )\n\t\t\t\treturn;\n\n\t\t\tfor ( cl in previousClasses ) {\n\t\t\t\t// Avoid removing and adding classes again.\n\t\t\t\tif ( !( newClasses && newClasses[ cl ] ) )\n\t\t\t\t\tthis.removeClass( cl );\n\t\t\t}\n\t\t\tfor ( cl in newClasses )\n\t\t\t\tthis.addClass( cl );\n\n\t\t\tpreviousClasses = newClasses;\n\t\t} );\n\t}\n\n\tfunction setupDragHandler( widget ) {\n\t\tif ( !widget.draggable )\n\t\t\treturn;\n\n\t\tvar editor = widget.editor,\n\t\t\t// Use getLast to find wrapper's direct descendant (#12022).\n\t\t\tcontainer = widget.wrapper.getLast( Widget.isDomDragHandlerContainer ),\n\t\t\timg;\n\n\t\t// Reuse drag handler if already exists (#11281).\n\t\tif ( container )\n\t\t\timg = container.findOne( 'img' );\n\t\telse {\n\t\t\tcontainer = new CKEDITOR.dom.element( 'span', editor.document );\n\t\t\tcontainer.setAttributes( {\n\t\t\t\t'class': 'cke_reset cke_widget_drag_handler_container',\n\t\t\t\t// Split background and background-image for IE8 which will break on rgba().\n\t\t\t\tstyle: 'background:rgba(220,220,220,0.5);background-image:url(' + editor.plugins.widget.path + 'images/handle.png)'\n\t\t\t} );\n\n\t\t\timg = new CKEDITOR.dom.element( 'img', editor.document );\n\t\t\timg.setAttributes( {\n\t\t\t\t'class': 'cke_reset cke_widget_drag_handler',\n\t\t\t\t'data-cke-widget-drag-handler': '1',\n\t\t\t\tsrc: CKEDITOR.tools.transparentImageData,\n\t\t\t\twidth: DRAG_HANDLER_SIZE,\n\t\t\t\ttitle: editor.lang.widget.move,\n\t\t\t\theight: DRAG_HANDLER_SIZE\n\t\t\t} );\n\t\t\twidget.inline && img.setAttribute( 'draggable', 'true' );\n\n\t\t\tcontainer.append( img );\n\t\t\twidget.wrapper.append( container );\n\t\t}\n\n\t\t// Preventing page reload when dropped content on widget wrapper (#13015).\n\t\t// Widget is not editable so by default drop on it isn't allowed what means that\n\t\t// browser handles it (there's no editable#drop event). If there's no drop event we cannot block\n\t\t// the drop, so page is reloaded. This listener enables drop on widget wrappers.\n\t\twidget.wrapper.on( 'dragover', function( evt ) {\n\t\t\tevt.data.preventDefault();\n\t\t} );\n\n\t\twidget.wrapper.on( 'mouseenter', widget.updateDragHandlerPosition, widget );\n\t\tsetTimeout( function() {\n\t\t\twidget.on( 'data', widget.updateDragHandlerPosition, widget );\n\t\t}, 50 );\n\n\t\tif ( !widget.inline ) {\n\t\t\timg.on( 'mousedown', onBlockWidgetDrag, widget );\n\n\t\t\t// On IE8 'dragstart' is propagated to editable, so editor#dragstart is fired twice on block widgets.\n\t\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 ) {\n\t\t\t\timg.on( 'dragstart', function( evt ) {\n\t\t\t\t\tevt.data.preventDefault( true );\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\twidget.dragHandlerContainer = container;\n\t}\n\n\tfunction onBlockWidgetDrag( evt ) {\n\t\tvar finder = this.repository.finder,\n\t\t\tlocator = this.repository.locator,\n\t\t\tliner = this.repository.liner,\n\t\t\teditor = this.editor,\n\t\t\teditable = editor.editable(),\n\t\t\tlisteners = [],\n\t\t\tsorted = [];\n\n\t\t// Mark dragged widget for repository#finder.\n\t\tthis.repository._.draggedWidget = this;\n\n\t\t// Harvest all possible relations and display some closest.\n\t\tvar relations = finder.greedySearch(),\n\n\t\t\tbuffer = CKEDITOR.tools.eventsBuffer( 50, function() {\n\t\t\t\tlocations = locator.locate( relations );\n\n\t\t\t\t// There's only a single line displayed for D&D.\n\t\t\t\tsorted = locator.sort( y, 1 );\n\n\t\t\t\tif ( sorted.length ) {\n\t\t\t\t\tliner.prepare( relations, locations );\n\t\t\t\t\tliner.placeLine( sorted[ 0 ] );\n\t\t\t\t\tliner.cleanup();\n\t\t\t\t}\n\t\t\t} ),\n\n\t\t\tlocations, y;\n\n\t\t// Let's have the \"dragging cursor\" over entire editable.\n\t\teditable.addClass( 'cke_widget_dragging' );\n\n\t\t// Cache mouse position so it is re-used in events buffer.\n\t\tlisteners.push( editable.on( 'mousemove', function( evt ) {\n\t\t\ty = evt.data.$.clientY;\n\t\t\tbuffer.input();\n\t\t} ) );\n\n\t\t// Fire drag start as it happens during the native D&D.\n\t\teditor.fire( 'dragstart', { target: evt.sender } );\n\n\t\tfunction onMouseUp() {\n\t\t\tvar l;\n\n\t\t\tbuffer.reset();\n\n\t\t\t// Stop observing events.\n\t\t\twhile ( ( l = listeners.pop() ) )\n\t\t\t\tl.removeListener();\n\n\t\t\tonBlockWidgetDrop.call( this, sorted, evt.sender );\n\t\t}\n\n\t\t// Mouseup means \"drop\". This is when the widget is being detached\n\t\t// from DOM and placed at range determined by the line (location).\n\t\tlisteners.push( editor.document.once( 'mouseup', onMouseUp, this ) );\n\n\t\t// Prevent calling 'onBlockWidgetDrop' twice in the inline editor.\n\t\t// `removeListener` does not work if it is called at the same time event is fired.\n\t\tif ( !editable.isInline() ) {\n\t\t\t// Mouseup may occur when user hovers the line, which belongs to\n\t\t\t// the outer document. This is, of course, a valid listener too.\n\t\t\tlisteners.push( CKEDITOR.document.once( 'mouseup', onMouseUp, this ) );\n\t\t}\n\t}\n\n\tfunction onBlockWidgetDrop( sorted, dragTarget ) {\n\t\tvar finder = this.repository.finder,\n\t\t\tliner = this.repository.liner,\n\t\t\teditor = this.editor,\n\t\t\teditable = this.editor.editable();\n\n\t\tif ( !CKEDITOR.tools.isEmpty( liner.visible ) ) {\n\t\t\t// Retrieve range for the closest location.\n\t\t\tvar dropRange = finder.getRange( sorted[ 0 ] );\n\n\t\t\t// Focus widget (it could lost focus after mousedown+mouseup)\n\t\t\t// and save this state as the one where we want to be taken back when undoing.\n\t\t\tthis.focus();\n\n\t\t\t// Drag range will be set in the drop listener.\n\t\t\teditor.fire( 'drop', {\n\t\t\t\tdropRange: dropRange,\n\t\t\t\ttarget: dropRange.startContainer\n\t\t\t} );\n\t\t}\n\n\t\t// Clean-up custom cursor for editable.\n\t\teditable.removeClass( 'cke_widget_dragging' );\n\n\t\t// Clean-up all remaining lines.\n\t\tliner.hideVisible();\n\n\t\t// Clean-up drag & drop.\n\t\teditor.fire( 'dragend', { target: dragTarget } );\n\t}\n\n\tfunction setupEditables( widget ) {\n\t\tvar editableName,\n\t\t\teditableDef,\n\t\t\tdefinedEditables = widget.editables;\n\n\t\twidget.editables = {};\n\n\t\tif ( !widget.editables )\n\t\t\treturn;\n\n\t\tfor ( editableName in definedEditables ) {\n\t\t\teditableDef = definedEditables[ editableName ];\n\t\t\twidget.initEditable( editableName, typeof editableDef == 'string' ? { selector: editableDef } : editableDef );\n\t\t}\n\t}\n\n\tfunction setupMask( widget ) {\n\t\tif ( !widget.mask )\n\t\t\treturn;\n\n\t\t// Reuse mask if already exists (#11281).\n\t\tvar img = widget.wrapper.findOne( '.cke_widget_mask' );\n\n\t\tif ( !img ) {\n\t\t\timg = new CKEDITOR.dom.element( 'img', widget.editor.document );\n\t\t\timg.setAttributes( {\n\t\t\t\tsrc: CKEDITOR.tools.transparentImageData,\n\t\t\t\t'class': 'cke_reset cke_widget_mask'\n\t\t\t} );\n\t\t\twidget.wrapper.append( img );\n\t\t}\n\n\t\twidget.mask = img;\n\t}\n\n\t// Replace parts object containing:\n\t// partName => selector pairs\n\t// with:\n\t// partName => element pairs\n\tfunction setupParts( widget ) {\n\t\tif ( widget.parts ) {\n\t\t\tvar parts = {},\n\t\t\t\tel, partName;\n\n\t\t\tfor ( partName in widget.parts ) {\n\t\t\t\tel = widget.wrapper.findOne( widget.parts[ partName ] );\n\t\t\t\tparts[ partName ] = el;\n\t\t\t}\n\t\t\twidget.parts = parts;\n\t\t}\n\t}\n\n\tfunction setupWidget( widget, widgetDef ) {\n\t\tsetupWrapper( widget );\n\t\tsetupParts( widget );\n\t\tsetupEditables( widget );\n\t\tsetupMask( widget );\n\t\tsetupDragHandler( widget );\n\t\tsetupDataClassesListener( widget );\n\n\t\t// #11145: [IE8] Non-editable content of widget is draggable.\n\t\tif ( CKEDITOR.env.ie && CKEDITOR.env.version < 9 ) {\n\t\t\twidget.wrapper.on( 'dragstart', function( evt ) {\n\t\t\t\tvar target = evt.data.getTarget();\n\n\t\t\t\t// Allow text dragging inside nested editables or dragging inline widget's drag handler.\n\t\t\t\tif ( !Widget.getNestedEditable( widget, target ) && !( widget.inline && Widget.isDomDragHandler( target ) ) )\n\t\t\t\t\tevt.data.preventDefault();\n\t\t\t} );\n\t\t}\n\n\t\twidget.wrapper.removeClass( 'cke_widget_new' );\n\t\twidget.element.addClass( 'cke_widget_element' );\n\n\t\twidget.on( 'key', function( evt ) {\n\t\t\tvar keyCode = evt.data.keyCode;\n\n\t\t\t// ENTER.\n\t\t\tif ( keyCode == 13 ) {\n\t\t\t\twidget.edit();\n\t\t\t\t// CTRL+C or CTRL+X.\n\t\t\t} else if ( keyCode == CKEDITOR.CTRL + 67 || keyCode == CKEDITOR.CTRL + 88 ) {\n\t\t\t\tcopySingleWidget( widget, keyCode == CKEDITOR.CTRL + 88 );\n\t\t\t\treturn; // Do not preventDefault.\n\t\t\t} else if ( keyCode in keystrokesNotBlockedByWidget || ( CKEDITOR.CTRL & keyCode ) || ( CKEDITOR.ALT & keyCode ) ) {\n\t\t\t\t// Pass chosen keystrokes to other plugins or default fake sel handlers.\n\t\t\t\t// Pass all CTRL/ALT keystrokes.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}, null, null, 999 );\n\t\t// Listen with high priority so it's possible\n\t\t// to overwrite this callback.\n\n\t\twidget.on( 'doubleclick', function( evt ) {\n\t\t\tif ( widget.edit() ) {\n\t\t\t\t// We have to cancel event if edit method opens a dialog, otherwise\n\t\t\t\t// link plugin may open extra dialog (#12140).\n\t\t\t\tevt.cancel();\n\t\t\t}\n\t\t} );\n\n\t\tif ( widgetDef.data )\n\t\t\twidget.on( 'data', widgetDef.data );\n\n\t\tif ( widgetDef.edit )\n\t\t\twidget.on( 'edit', widgetDef.edit );\n\t}\n\n\tfunction setupWidgetData( widget, startupData ) {\n\t\tvar widgetDataAttr = widget.element.data( 'cke-widget-data' );\n\n\t\tif ( widgetDataAttr )\n\t\t\twidget.setData( JSON.parse( decodeURIComponent( widgetDataAttr ) ) );\n\t\tif ( startupData )\n\t\t\twidget.setData( startupData );\n\n\t\t// Populate classes if they are not preset.\n\t\tif ( !widget.data.classes )\n\t\t\twidget.setData( 'classes', widget.getClasses() );\n\n\t\t// Unblock data and...\n\t\twidget.dataReady = true;\n\n\t\t// Write data to element because this was blocked when data wasn't ready.\n\t\twriteDataToElement( widget );\n\n\t\t// Fire data event first time, because this was blocked when data wasn't ready.\n\t\twidget.fire( 'data', widget.data );\n\t}\n\n\tfunction setupWrapper( widget ) {\n\t\t// Retrieve widget wrapper. Assign an id to it.\n\t\tvar wrapper = widget.wrapper = widget.element.getParent();\n\t\twrapper.setAttribute( 'data-cke-widget-id', widget.id );\n\t}\n\n\tfunction writeDataToElement( widget ) {\n\t\twidget.element.data( 'cke-widget-data', encodeURIComponent( JSON.stringify( widget.data ) ) );\n\t}\n\n\t//\n\t// WIDGET STYLE HANDLER ---------------------------------------------------\n\t//\n\n\t( function() {\n\n\t\t/**\n\t\t * The class representing a widget style. It is an {@link CKEDITOR#STYLE_OBJECT object} like\n\t\t * the styles handler for widgets.\n\t\t *\n\t\t * **Note:** This custom style handler does not support all methods of the {@link CKEDITOR.style} class.\n\t\t * Not supported methods: {@link #applyToRange}, {@link #removeFromRange}, {@link #applyToObject}.\n\t\t *\n\t\t * @since 4.4\n\t\t * @class CKEDITOR.style.customHandlers.widget\n\t\t * @extends CKEDITOR.style\n\t\t */\n\t\tCKEDITOR.style.addCustomHandler( {\n\t\t\ttype: 'widget',\n\n\t\t\tsetup: function( styleDefinition ) {\n\t\t\t\t/**\n\t\t\t\t * The name of widget to which this style can be applied.\n\t\t\t\t * It is extracted from style definition's `widget` property.\n\t\t\t\t *\n\t\t\t\t * @property {String} widget\n\t\t\t\t */\n\t\t\t\tthis.widget = styleDefinition.widget;\n\t\t\t},\n\n\t\t\tapply: function( editor ) {\n\t\t\t\t// Before CKEditor 4.4 wasn't a required argument, so we need to\n\t\t\t\t// handle a case when it wasn't provided.\n\t\t\t\tif ( !( editor instanceof CKEDITOR.editor ) )\n\t\t\t\t\treturn;\n\n\t\t\t\t// Theoretically we could bypass checkApplicable, get widget from\n\t\t\t\t// widgets.focused and check its name, what would be faster, but then\n\t\t\t\t// this custom style would work differently than the default style\n\t\t\t\t// which checks if it's applicable before applying or removeing itself.\n\t\t\t\tif ( this.checkApplicable( editor.elementPath(), editor ) )\n\t\t\t\t\teditor.widgets.focused.applyStyle( this );\n\t\t\t},\n\n\t\t\tremove: function( editor ) {\n\t\t\t\t// Before CKEditor 4.4 wasn't a required argument, so we need to\n\t\t\t\t// handle a case when it wasn't provided.\n\t\t\t\tif ( !( editor instanceof CKEDITOR.editor ) )\n\t\t\t\t\treturn;\n\n\t\t\t\tif ( this.checkApplicable( editor.elementPath(), editor ) )\n\t\t\t\t\teditor.widgets.focused.removeStyle( this );\n\t\t\t},\n\n\t\t\tcheckActive: function( elementPath, editor ) {\n\t\t\t\treturn this.checkElementMatch( elementPath.lastElement, 0, editor );\n\t\t\t},\n\n\t\t\tcheckApplicable: function( elementPath, editor ) {\n\t\t\t\t// Before CKEditor 4.4 wasn't a required argument, so we need to\n\t\t\t\t// handle a case when it wasn't provided.\n\t\t\t\tif ( !( editor instanceof CKEDITOR.editor ) )\n\t\t\t\t\treturn false;\n\n\t\t\t\treturn this.checkElement( elementPath.lastElement );\n\t\t\t},\n\n\t\t\tcheckElementMatch: checkElementMatch,\n\n\t\t\tcheckElementRemovable: checkElementMatch,\n\n\t\t\t/**\n\t\t\t * Checks if an element is a {@link CKEDITOR.plugins.widget#wrapper wrapper} of a\n\t\t\t * widget whose name matches the {@link #widget widget name} specified in the style definition.\n\t\t\t *\n\t\t\t * @param {CKEDITOR.dom.element} element\n\t\t\t * @returns {Boolean}\n\t\t\t */\n\t\t\tcheckElement: function( element ) {\n\t\t\t\tif ( !Widget.isDomWidgetWrapper( element ) )\n\t\t\t\t\treturn false;\n\n\t\t\t\tvar widgetElement = element.getFirst( Widget.isDomWidgetElement );\n\t\t\t\treturn widgetElement && widgetElement.data( 'widget' ) == this.widget;\n\t\t\t},\n\n\t\t\tbuildPreview: function( label ) {\n\t\t\t\treturn label || this._.definition.name;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns allowed content rules which should be registered for this style.\n\t\t\t * Uses widget's {@link CKEDITOR.plugins.widget.definition#styleableElements} to make a rule\n\t\t\t * allowing classes on specified elements or use widget's\n\t\t\t * {@link CKEDITOR.plugins.widget.definition#styleToAllowedContentRules} method to transform a style\n\t\t\t * into allowed content rules.\n\t\t\t *\n\t\t\t * @param {CKEDITOR.editor} The editor instance.\n\t\t\t * @returns {CKEDITOR.filter.allowedContentRules}\n\t\t\t */\n\t\t\ttoAllowedContentRules: function( editor ) {\n\t\t\t\tif ( !editor )\n\t\t\t\t\treturn null;\n\n\t\t\t\tvar widgetDef = editor.widgets.registered[ this.widget ],\n\t\t\t\t\tclasses,\n\t\t\t\t\trule = {};\n\n\t\t\t\tif ( !widgetDef )\n\t\t\t\t\treturn null;\n\n\t\t\t\tif ( widgetDef.styleableElements ) {\n\t\t\t\t\tclasses = this.getClassesArray();\n\t\t\t\t\tif ( !classes )\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\trule[ widgetDef.styleableElements ] = {\n\t\t\t\t\t\tclasses: classes,\n\t\t\t\t\t\tpropertiesOnly: true\n\t\t\t\t\t};\n\t\t\t\t\treturn rule;\n\t\t\t\t}\n\t\t\t\tif ( widgetDef.styleToAllowedContentRules )\n\t\t\t\t\treturn widgetDef.styleToAllowedContentRules( this );\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns classes defined in the style in form of an array.\n\t\t\t *\n\t\t\t * @returns {String[]}\n\t\t\t */\n\t\t\tgetClassesArray: function() {\n\t\t\t\tvar classes = this._.definition.attributes && this._.definition.attributes[ 'class' ];\n\n\t\t\t\treturn classes ? CKEDITOR.tools.trim( classes ).split( /\\s+/ ) : null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Not implemented.\n\t\t\t *\n\t\t\t * @method applyToRange\n\t\t\t */\n\t\t\tapplyToRange: notImplemented,\n\n\t\t\t/**\n\t\t\t * Not implemented.\n\t\t\t *\n\t\t\t * @method removeFromRange\n\t\t\t */\n\t\t\tremoveFromRange: notImplemented,\n\n\t\t\t/**\n\t\t\t * Not implemented.\n\t\t\t *\n\t\t\t * @method applyToObject\n\t\t\t */\n\t\t\tapplyToObject: notImplemented\n\t\t} );\n\n\t\tfunction notImplemented() {}\n\n\t\t// @context style\n\t\tfunction checkElementMatch( element, fullMatch, editor ) {\n\t\t\t// Before CKEditor 4.4 wasn't a required argument, so we need to\n\t\t\t// handle a case when it wasn't provided.\n\t\t\tif ( !editor )\n\t\t\t\treturn false;\n\n\t\t\tif ( !this.checkElement( element ) )\n\t\t\t\treturn false;\n\n\t\t\tvar widget = editor.widgets.getByElement( element, true );\n\t\t\treturn widget && widget.checkStyleActive( this );\n\t\t}\n\n\t} )();\n\n\t//\n\t// EXPOSE PUBLIC API ------------------------------------------------------\n\t//\n\n\tCKEDITOR.plugins.widget = Widget;\n\tWidget.repository = Repository;\n\tWidget.nestedEditable = NestedEditable;\n} )();\n\n/**\n * An event fired when a widget definition is registered by the {@link CKEDITOR.plugins.widget.repository#add} method.\n * It is possible to modify the definition being registered.\n *\n * @event widgetDefinition\n * @member CKEDITOR.editor\n * @param {CKEDITOR.plugins.widget.definition} data Widget definition.\n */\n\n/**\n * This is an abstract class that describes the definition of a widget.\n * It is a type of {@link CKEDITOR.plugins.widget.repository#add} method's second argument.\n *\n * Widget instances inherit from registered widget definitions, although not in a prototypal way.\n * They are simply extended with corresponding widget definitions. Note that not all properties of\n * the widget definition become properties of a widget. Some, like {@link #data} or {@link #edit}, become\n * widget's events listeners.\n *\n * @class CKEDITOR.plugins.widget.definition\n * @abstract\n * @mixins CKEDITOR.feature\n */\n\n/**\n * Widget definition name. It is automatically set when the definition is\n * {@link CKEDITOR.plugins.widget.repository#add registered}.\n *\n * @property {String} name\n */\n\n/**\n * The method executed while initializing a widget, after a widget instance\n * is created, but before it is ready. It is executed before the first\n * {@link CKEDITOR.plugins.widget#event-data} is fired so it is common to\n * use the `init` method to populate widget data with information loaded from\n * the DOM, like for exmaple:\n *\n *\t\tinit: function() {\n *\t\t\tthis.setData( 'width', this.element.getStyle( 'width' ) );\n *\n *\t\t\tif ( this.parts.caption.getStyle( 'display' ) != 'none' )\n *\t\t\t\tthis.setData( 'showCaption', true );\n *\t\t}\n *\n * @property {Function} init\n */\n\n/**\n * The function to be used to upcast an element to this widget or a\n * comma-separated list of upcast methods from the {@link #upcasts} object.\n *\n * The upcast function **is not** executed in the widget context (because the widget\n * does not exist yet) and two arguments are passed:\n *\n * * `element` ({@link CKEDITOR.htmlParser.element}) &ndash; The element to be checked.\n * * `data` (`Object`) &ndash; The object which can be extended with data which will then be passed to the widget.\n *\n * An element will be upcasted if a function returned `true` or an instance of\n * a {@link CKEDITOR.htmlParser.element} if upcasting meant DOM structure changes\n * (in this case the widget will be initialized on the returned element).\n *\n * @property {String/Function} upcast\n */\n\n/**\n * The object containing functions which can be used to upcast this widget.\n * Only those pointed by the {@link #upcast} property will be used.\n *\n * In most cases it is appropriate to use {@link #upcast} directly,\n * because majority of widgets need just one method.\n * However, in some cases the widget author may want to expose more than one variant\n * and then this property may be used.\n *\n *\t\tupcasts: {\n *\t\t\t// This function may upcast only figure elements.\n *\t\t\tfigure: function() {\n *\t\t\t\t// ...\n *\t\t\t},\n *\t\t\t// This function may upcast only image elements.\n *\t\t\timage: function() {\n *\t\t\t\t// ...\n *\t\t\t},\n *\t\t\t// More variants...\n *\t\t}\n *\n *\t\t// Then, widget user may choose which upcast methods will be enabled.\n *\t\teditor.on( 'widgetDefinition', function( evt ) {\n *\t\t\tif ( evt.data.name == 'image' )\n * \t\t\t\tevt.data.upcast = 'figure,image'; // Use both methods.\n *\t\t} );\n *\n * @property {Object} upcasts\n */\n\n/**\n * The {@link #upcast} method(s) priority. The upcast with a lower priority number will be called before\n * the one with a higher number. The default priority is `10`.\n *\n * @since 4.5\n * @property {Number} [upcastPriority=10]\n */\n\n/**\n * The function to be used to downcast this widget or\n * a name of the downcast option from the {@link #downcasts} object.\n *\n * The downcast funciton will be executed in the {@link CKEDITOR.plugins.widget} context\n * and with `widgetElement` ({@link CKEDITOR.htmlParser.element}) argument which is\n * the widget's main element.\n *\n * The function may return an instance of the {@link CKEDITOR.htmlParser.node} class if the widget\n * needs to be downcasted to a different node than the widget's main element.\n *\n * @property {String/Function} downcast\n */\n\n/**\n * The object containing functions which can be used to downcast this widget.\n * Only the one pointed by the {@link #downcast} property will be used.\n *\n * In most cases it is appropriate to use {@link #downcast} directly,\n * because majority of widgets have just one variant of downcasting (or none at all).\n * However, in some cases the widget author may want to expose more than one variant\n * and then this property may be used.\n *\n *\t\tdowncasts: {\n *\t\t\t// This downcast may transform the widget into the figure element.\n *\t\t\tfigure: function() {\n *\t\t\t\t// ...\n *\t\t\t},\n *\t\t\t// This downcast may transform the widget into the image element with data-* attributes.\n *\t\t\timage: function() {\n *\t\t\t\t// ...\n *\t\t\t}\n *\t\t}\n *\n *\t\t// Then, the widget user may choose one of the downcast options when setting up his editor.\n *\t\teditor.on( 'widgetDefinition', function( evt ) {\n *\t\t\tif ( evt.data.name == 'image' )\n * \t\t\t\tevt.data.downcast = 'figure';\n *\t\t} );\n *\n * @property downcasts\n */\n\n/**\n * If set, it will be added as the {@link CKEDITOR.plugins.widget#event-edit} event listener.\n * This means that it will be executed when a widget is being edited.\n * See the {@link CKEDITOR.plugins.widget#method-edit} method.\n *\n * @property {Function} edit\n */\n\n/**\n * If set, it will be added as the {@link CKEDITOR.plugins.widget#event-data} event listener.\n * This means that it will be executed every time the {@link CKEDITOR.plugins.widget#property-data widget data} changes.\n *\n * @property {Function} data\n */\n\n/**\n * The method to be executed when the widget's command is executed in order to insert a new widget\n * (widget of this type is not focused). If not defined, then the default action will be\n * performed which means that:\n *\n * * An instance of the widget will be created in a detached {@link CKEDITOR.dom.documentFragment document fragment},\n * * The {@link CKEDITOR.plugins.widget#method-edit} method will be called to trigger widget editing,\n * * The widget element will be inserted into DOM.\n *\n * @property {Function} insert\n */\n\n/**\n * The name of a dialog window which will be opened on {@link CKEDITOR.plugins.widget#method-edit}.\n * If not defined, then the {@link CKEDITOR.plugins.widget#method-edit} method will not perform any action and\n * widget's command will insert a new widget without opening a dialog window first.\n *\n * @property {String} dialog\n */\n\n/**\n * The template which will be used to create a new widget element (when the widget's command is executed).\n * This string is populated with {@link #defaults default values} by using the {@link CKEDITOR.template} format.\n * Therefore it has to be a valid {@link CKEDITOR.template} argument.\n *\n * @property {String} template\n */\n\n/**\n * The data object which will be used to populate the data of a newly created widget.\n * See {@link CKEDITOR.plugins.widget#property-data}.\n *\n *\t\tdefaults: {\n *\t\t\tshowCaption: true,\n *\t\t\talign: 'none'\n *\t\t}\n *\n * @property defaults\n */\n\n/**\n * An object containing definitions of widget components (part name => CSS selector).\n *\n *\t\tparts: {\n *\t\t\timage: 'img',\n *\t\t\tcaption: 'div.caption'\n *\t\t}\n *\n * @property parts\n */\n\n/**\n * An object containing definitions of nested editables (editable name => {@link CKEDITOR.plugins.widget.nestedEditable.definition}).\n * Note that editables *have to* be defined in the same order as they are in DOM / {@link CKEDITOR.plugins.widget.definition#template template}.\n * Otherwise errors will occur when nesting widgets inside each other.\n *\n *\t\teditables: {\n *\t\t\theader: 'h1',\n *\t\t\tcontent: {\n *\t\t\t\tselector: 'div.content',\n *\t\t\t\tallowedContent: 'p strong em; a[!href]'\n *\t\t\t}\n *\t\t}\n *\n * @property editables\n */\n\n/**\n * Widget name displayed in elements path.\n *\n * @property {String} pathName\n */\n\n/**\n * If set to `true`, the widget's element will be covered with a transparent mask.\n * This will prevent its content from being clickable, which matters in case\n * of special elements like embedded Flash or iframes that generate a separate \"context\".\n *\n * @property {Boolean} mask\n */\n\n/**\n * If set to `true/false`, it will force the widget to be either an inline or a block widget.\n * If not set, the widget type will be determined from the widget element.\n *\n * Widget type influences whether a block (`div`) or an inline (`span`) element is used\n * for the wrapper.\n *\n * @property {Boolean} inline\n */\n\n/**\n * The label for the widget toolbar button.\n *\n *\t\teditor.widgets.add( 'simplebox', {\n *\t\t\tbutton: 'Create a simple box'\n *\t\t} );\n *\n *\t\teditor.widgets.add( 'simplebox', {\n *\t\t\tbutton: editor.lang.simplebox.title\n *\t\t} );\n *\n * @property {String} button\n */\n\n/**\n * Whether widget should be draggable. Defaults to `true`.\n * If set to `false` drag handler will not be displayed when hovering widget.\n *\n * @property {Boolean} draggable\n */\n\n/**\n * Names of element(s) (separated by spaces) for which the {@link CKEDITOR.filter} should allow classes\n * defined in the widget styles. For example if your widget is upcasted from a simple `<div>`\n * element, then in order to make it styleable you can set:\n *\n *\t\teditor.widgets.add( 'customWidget', {\n *\t\t\tupcast: function( element ) {\n *\t\t\t\treturn element.name == 'div';\n *\t\t\t},\n *\n *\t\t\t// ...\n *\n *\t\t\tstyleableElements: 'div'\n *\t\t} );\n *\n * Then, when the following style is defined:\n *\n *\t\t{\n *\t\t\tname: 'Thick border', type: 'widget', widget: 'customWidget',\n *\t\t\tattributes: { 'class': 'thickBorder' }\n *\t\t}\n *\n * a rule allowing the `thickBorder` class for `div` elements will be registered in the {@link CKEDITOR.filter}.\n *\n * If you need to have more freedom when transforming widget style to allowed content rules,\n * you can use the {@link #styleToAllowedContentRules} callback.\n *\n * @since 4.4\n * @property {String} styleableElements\n */\n\n/**\n * Function transforming custom widget's {@link CKEDITOR.style} instance into\n * {@link CKEDITOR.filter.allowedContentRules}. It may be used when a static\n * {@link #styleableElements} property is not enough to inform the {@link CKEDITOR.filter}\n * what HTML features should be enabled when allowing the given style.\n *\n * In most cases, when style's classes just have to be added to element name(s) used by\n * the widget element, it is recommended to use simpler {@link #styleableElements} property.\n *\n * In order to get parsed classes from the style definition you can use\n * {@link CKEDITOR.style.customHandlers.widget#getClassesArray}.\n *\n * For example, if you want to use the [object format of allowed content rules](#!/guide/dev_allowed_content_rules-section-object-format),\n * to specify `match` validator, your implementation could look like this:\n *\n *\t\teditor.widgets.add( 'customWidget', {\n *\t\t\t// ...\n *\n *\t\t\tstyleToAllowedContentRules: funciton( style ) {\n *\t\t\t\t// Retrieve classes defined in the style.\n *\t\t\t\tvar classes = style.getClassesArray();\n *\n *\t\t\t\t// Do something crazy - for example return allowed content rules in object format,\n *\t\t\t\t// with custom match property and propertiesOnly flag.\n *\t\t\t\treturn {\n *\t\t\t\t\th1: {\n *\t\t\t\t\t\tmatch: isWidgetElement,\n *\t\t\t\t\t\tpropertiesOnly: true,\n *\t\t\t\t\t\tclasses: classes\n *\t\t\t\t\t}\n *\t\t\t\t};\n *\t\t\t}\n *\t\t} );\n *\n * @since 4.4\n * @property {Function} styleToAllowedContentRules\n * @param {CKEDITOR.style.customHandlers.widget} style The style to be transformed.\n * @returns {CKEDITOR.filter.allowedContentRules}\n */\n\n/**\n * This is an abstract class that describes the definition of a widget's nested editable.\n * It is a type of values in the {@link CKEDITOR.plugins.widget.definition#editables} object.\n *\n * In the simplest case the definition is a string which is a CSS selector used to\n * find an element that will become a nested editable inside the widget. Note that\n * the widget element can be a nested editable, too.\n *\n * In the more advanced case a definition is an object with a required `selector` property.\n *\n *\t\teditables: {\n *\t\t\theader: 'h1',\n *\t\t\tcontent: {\n *\t\t\t\tselector: 'div.content',\n *\t\t\t\tallowedContent: 'p strong em; a[!href]'\n *\t\t\t}\n *\t\t}\n *\n * @class CKEDITOR.plugins.widget.nestedEditable.definition\n * @abstract\n */\n\n/**\n * The CSS selector used to find an element which will become a nested editable.\n *\n * @property {String} selector\n */\n\n/**\n * The [Advanced Content Filter](#!/guide/dev_advanced_content_filter) rules\n * which will be used to limit the content allowed in this nested editable.\n * This option is similar to {@link CKEDITOR.config#allowedContent} and one can\n * use it to limit the editor features available in the nested editable.\n *\n * @property {CKEDITOR.filter.allowedContentRules} allowedContent\n */\n\n/**\n * Nested editable name displayed in elements path.\n *\n * @property {String} pathName\n */\n"]}