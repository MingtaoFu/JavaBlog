{"version":3,"sources":["base.js"],"names":[],"mappings":"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","file":"base-compiled.js","sourcesContent":["/**\n * AngularJS 思路\n * $rootScope 中应该记录登录状态\n *\n * 分不同的 router\n * main / article   login / personalCenter\n */\n\nangular.module(\"app\", [\"jQueryRequest\", \"ngRoute\", \"ngFileUpload\"])\n    .config(['$routeProvider', function($routeProvider) {\n        $routeProvider\n            .when('/', {\n                templateUrl: 'view/articleList.html',\n                controller: 'index'\n            })\n            .when('/article', {\n                templateUrl: 'view/article.html',\n                controller: 'article'\n            })\n            .when('/me', {\n                templateUrl: 'view/me.html',\n                controller: 'me'\n            })\n            .when('/admin', {\n                templateUrl: 'view/editor.html',\n                controller: 'admin'\n            })\n            .when('/test', {\n                templateUrl: 'jQuery-File-Upload-9.11.2/index.html'\n            });\n    }])\n    .filter('trustHtml', function ($sce) {\n        return function (input) {\n            return $sce.trustAsHtml(input);\n        }\n    })\n    .filter('delTag', function ($sce) {\n        return function (input) {\n            var reg = new RegExp(\"<[^<]*>\", \"gi\")\n            //return input.replace(reg, '');\n            return $sce.trustAsHtml(input.replace(reg, ''));\n        }\n    })\n    .controller('index', function($scope) {\n        $scope.articleList = [];\n\n        $.getJSON('api/article/articleList', function(resp) {\n            $scope.$apply(function() {\n                switch (resp.list.status) {\n                    case 1:\n                        $scope.articleList = resp.list.articles;\n                        break;\n                }\n            });\n\n        });\n    })\n    .controller('main', function($scope, $rootScope) {\n        $rootScope.rootdata = {\n            login: {\n                id: '',\n                pwd: ''\n            },\n            register: {\n                id: '',\n                name: '',\n                pwd: ''\n            },\n            info: {\n\n            },\n            blogInfo: {\n\n            }\n        };\n\n        $rootScope.status = {\n            isValidated: false,\n            loginPanel: false\n\n        };\n\n        $scope.loginSubmit = function() {\n            $.post('api/account/login', $rootScope.rootdata.login, function(resp) {\n                $scope.$apply(function() {\n                    if(resp.data.status) {\n                        document.cookie = \"id=\" + $rootScope.rootdata.login.id;\n                        document.cookie = \"token=\" + resp.data.token;\n                        $rootScope.status.isValidated = true;\n                        $scope.status.loginPanel = false;\n                    } else {\n\n                    }\n                });\n\n            });\n        };\n    })\n    .controller('me', ['$scope', '$rootScope', 'Upload', function($scope, $rootScope, Upload) {\n\n        $scope.status = {\n            //是否在编辑状态\n            editModel: false\n        };\n\n        //给文件input增加监听器，一旦选定了，自动上传\n        $scope.$watch(\"file\", function() {\n            if($scope.file) {\n                $scope.upload();\n            }\n        });\n\n        $scope.upload = function() {\n            Upload.upload({\n                url: 'api/file/uploadHead',\n                file: $scope.file\n            }).progress(function (evt) {\n                var progressPercentage = parseInt(100.0 * evt.loaded / evt.total);\n                console.log('progress: ' + progressPercentage + '% ' + evt.config.file.name);\n            }).success(function (data, status, headers, config) {\n                console.log('file ' + config.file.name + 'uploaded. Response: ' + data);\n                $rootScope.rootdata.info.logoUrl = 'img/head_' + $rootScope.rootdata.info.id;\n            });\n        };\n\n        $scope.pwdData = {\n            oldPwd: '',\n            newPwd: '',\n            rePwd: ''\n        };\n\n        $scope.getData = function () {\n            $.getJSON('api/account/personalInfo', function(resp) {\n                $scope.$apply(function() {\n                    $rootScope.rootdata.info = resp.data;\n                });\n            });\n        };\n\n\n        $scope.getData();\n\n        $scope.$watch(\"modifyForm.rePwd.$viewValue\", function() {\n            if($scope.modifyForm.rePwd.$viewValue == $scope.modifyForm.newPwd.$viewValue) {\n                $scope.modifyForm.rePwd.$error.same = false;\n            } else {\n                $scope.modifyForm.rePwd.$error.same = true;\n                $scope.modifyForm.$invalid = true;\n            }\n        });\n\n        $scope.$watch(\"modifyForm.newPwd.$viewValue\", function() {\n            if($scope.modifyForm.rePwd.$viewValue == $scope.modifyForm.newPwd.$viewValue) {\n                $scope.modifyForm.rePwd.$error.same = false;\n            } else {\n                $scope.modifyForm.rePwd.$error.same = true;\n                $scope.modifyForm.$invalid = true;\n            }\n        });\n\n        //修改个人信息\n        $scope.modifyPersonalInfo = function() {\n            $.post('api/account/modifyInfo', $rootScope.rootdata.info, function(resp) {\n                $scope.$apply(function() {\n                    switch (resp.data.status) {\n                        case 1:\n                            alert(\"操作成功\");\n                            break;\n                        case 0:\n                            alert(\"登录状态失效，请重新登录\");\n                            break;\n                        case 2:\n                            alert(\"服务器错误，请稍后再试\");\n                            break;\n                    }\n                });\n            });\n        };\n\n        //修改密码\n        $scope.modifyPwd = function() {\n            $.post('api/account/modifyPwd', $scope.pwdData, function(resp) {\n                $scope.$apply(function() {\n                    switch (resp.data.status) {\n                        case 1:\n                            alert(\"操作成功\");\n                            break;\n                        case 0:\n                            alert(\"登录状态失效，请重新登录\");\n                            break;\n                        case 3:\n                            alert(\"旧密码错误\");\n                            break;\n                        case 2:\n                            alert(\"服务器错误，请稍后再试\");\n                            break;\n                    }\n                });\n            });\n        }\n    }])\n    .controller('admin', function($scope) {\n        $scope.publishStatus = '';\n        $scope.data = {\n            article: {\n                title: '',\n                content: ''\n            }\n        };\n\n        //发表文章\n        $scope.publish = function() {\n            $scope.data.article.content = CKEDITOR.instances.editor.getData();\n            $.post('api/article/publish', $scope.data.article, function(resp) {\n                $scope.$apply(function() {\n                    console.log(resp.data.status);\n                    switch (resp.data.status) {\n                        case 0:\n                            $scope.publishStatus = \"身份认证失败，请重新登录\";\n                            break;\n                        case 1:\n                            $scope.publishStatus = \"发表成功，跳转中...\";\n                            break;\n                        case 2:\n                            $scope.publishStatus = \"服务器错误，请稍后再试\";\n                            break;\n                        case 3:\n                            $scope.publishStatus = \"您没有权限发表文章\";\n                            break;\n                    }\n                });\n            });\n        };\n\n    })\n    .controller('article', function($scope, $location, $anchorScroll) {\n        $scope.commentUserList = [];\n\n        //回复时变换对象\n        $scope.changeToUser = function(cId, rId) {\n            console.log(cId+\",\"+rId);\n            $scope.commentUserList[cId] = $scope.comments[cId].resps[rId].fromUser;\n        };\n\n        $scope.comments = [];\n\n        $scope.newComment = '';\n        $scope.newResponse = [];\n\n        //获取评论和回复\n        $scope.getData = function() {\n            $.getJSON('api/article/oneArticleContent', $location.search(), function(resp) {\n                $scope.$apply(function() {\n                    var data = resp.data;\n                    switch (data.status) {\n                        case 1:\n                            $scope.article = data.article;\n                            //非常不优雅，要改\n                            if(data.comments) {\n                                if(typeof data.comments.length == \"number\") {\n                                    $scope.comments = data.comments;\n                                } else {\n                                    $scope.comments = [data.comments];\n                                }\n                                //设置commentUserList\n                                for (var i in $scope.comments) {\n                                    $scope.commentUserList.push($scope.comments[i].user);\n                                }\n                                ///////\n                                var resps = data.responses;\n                                var comms = $scope.comments;\n                                if(resps) {\n                                    if(typeof resps.length != \"number\") {\n                                        resps = [resps];\n                                    }\n                                    for (var i = 0;i < resps.length;i++) {\n                                        for (var j = 0;j<comms.length;j++) {\n                                            if (!comms[j].resps) {\n                                                comms[j].resps = [];\n                                            }\n                                            if (comms[j].id == resps[i].commentId) {\n                                                comms[j].resps.push(resps[i]);\n                                            }\n                                        }\n                                    }\n                                }\n                            }\n                            break;\n                        case 2:\n                            break;\n                    }\n                });\n            });\n        };\n\n        $scope.getData();\n\n        //锚点定位\n        $scope.goto = function (id) {\n            $location.hash(id);\n            $anchorScroll();\n        };\n\n        //发表评论\n        $scope.postComment = function() {\n            $.post('api/article/comment/add',\n                {articleId: $location.search().articleId, content: $scope.newComment},\n                function(resp) {\n                    $scope.$apply(\n                        function() {\n                            switch (resp.data.status) {\n                               case 1:\n                                   $scope.getData();\n                                   break;\n                               case 0:\n                                   alert(\"登录状态失效，请重新登录\");\n                                   break;\n                               case 3:\n                                   alert(\"登录状态失效，请重新登录\");\n                                   break;\n                               case 2:\n                                   alert(\"服务器错误，请稍后再试\");\n                                   break;\n                               case 4:\n                                   alert(\"非法操作\");\n                                   break;\n                            }\n                        }\n                    );\n            });\n        };\n\n        //发表回复\n        $scope.postResponse = function(index) {\n            var toUser = $scope.commentUserList[index];\n            var commentId = $scope.comments[index].id;\n            $.post('api/article/comment/response/add',\n                {commentId: commentId, toUser: toUser, content: $scope.newResponse[index]},\n                function(resp) {\n                    $scope.$apply(function() {\n                        switch (resp.data.status) {\n                            case 1:\n                                $scope.getData();\n                                break;\n                            case 0:\n                                alert(\"登录状态失效，请重新登录\");\n                                break;\n                            case 3:\n                                alert(\"登录状态失效，请重新登录\");\n                                break;\n                            case 2:\n                                alert(\"服务器错误，请稍后再试\");\n                                break;\n                            case 4:\n                                alert(\"非法操作\");\n                                break;\n                        }\n                });\n            });\n        };\n    });\n"]}